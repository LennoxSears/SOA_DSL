////////////////////////////////////////
// veriloga aging model for smos10hv
// Developed by : circuit CAE
// Created on   : 02/10/2021 
// by           : nxa23194 
// Freescale Internal Use Only  
//
// Version update:
// version	time		comment
// v12.1:	02/10/2021	vdscutoff is changed to be vgscutoff.
//                              relimo_aging_hci1 model is updated, delta_damage is freshed in each loop.
// ams3.12:	04/20/2020	relimo_aging_nbti model is updated. When relimo_pbti_aging_open_flag=1, pbti dummy outputs will not be outputted.
//                              Then relimo_aging_pbti model can be added together in one device to output real pbti damage.
// ams3.8:	06/22/2018	Full HCI model added for nld45(b) and nld45(b)_he.
// ams3.7:	11/30/2017	HCI model updated. HCI3 model added for Ron model.
// ams2.0:	03/31/2014	First version.

`include "discipline.h"
`include "constants.h"

`define EM(T, VGS, VDS, VSubS) \
    b0_b0_b0_em = linear(b0_b0_b0_b0_em, a0_b0_b0_b0_em, (T)); \
    a0_b0_b0_em = linear(b0_a0_b0_b0_em, a0_a0_b0_b0_em, (T)); \
    b0_a0_b0_em = linear(b0_b0_a0_b0_em, a0_b0_a0_b0_em, (T)); \
    a0_a0_b0_em = linear(b0_a0_a0_b0_em, a0_a0_a0_b0_em, (T)); \
    b0_a1_b0_em = linear(b0_b0_a1_b0_em, a0_b0_a1_b0_em, (T)); \
    a0_a1_b0_em = linear(b0_a0_a1_b0_em, a0_a0_a1_b0_em, (T)); \
    b0_a2_b0_em = linear(b0_b0_a2_b0_em, a0_b0_a2_b0_em, (T)); \
    a0_a2_b0_em = linear(b0_a0_a2_b0_em, a0_a0_a2_b0_em, (T)); \
    b0_a3_b0_em = linear(b0_b0_a3_b0_em, a0_b0_a3_b0_em, (T)); \
    a0_a3_b0_em = linear(b0_a0_a3_b0_em, a0_a0_a3_b0_em, (T)); \
    b0_a4_b0_em = linear(b0_b0_a4_b0_em, a0_b0_a4_b0_em, (T)); \
    a0_a4_b0_em = linear(b0_a0_a4_b0_em, a0_a0_a4_b0_em, (T)); \
    b0_p1_b0_em = linear(b0_b0_p1_b0_em, a0_b0_p1_b0_em, (T)); \
    a0_p1_b0_em = linear(b0_a0_p1_b0_em, a0_a0_p1_b0_em, (T)); \
    b0_p2_b0_em = linear(b0_b0_p2_b0_em, a0_b0_p2_b0_em, (T)); \
    a0_p2_b0_em = linear(b0_a0_p2_b0_em, a0_a0_p2_b0_em, (T)); \
    b0_p3_b0_em = linear(b0_b0_p3_b0_em, a0_b0_p3_b0_em, (T)); \
    a0_p3_b0_em = linear(b0_a0_p3_b0_em, a0_a0_p3_b0_em, (T)); \
    b0_p4_b0_em = linear(b0_b0_p4_b0_em, a0_b0_p4_b0_em, (T)); \
    a0_p4_b0_em = linear(b0_a0_p4_b0_em, a0_a0_p4_b0_em, (T)); \
    b0_b0_a0_em = linear(b0_b0_b0_a0_em, a0_b0_b0_a0_em, (T)); \
    a0_b0_a0_em = linear(b0_a0_b0_a0_em, a0_a0_b0_a0_em, (T)); \
    b0_a0_a0_em = linear(b0_b0_a0_a0_em, a0_b0_a0_a0_em, (T)); \
    a0_a0_a0_em = linear(b0_a0_a0_a0_em, a0_a0_a0_a0_em, (T)); \
    b0_a1_a0_em = linear(b0_b0_a1_a0_em, a0_b0_a1_a0_em, (T)); \
    a0_a1_a0_em = linear(b0_a0_a1_a0_em, a0_a0_a1_a0_em, (T)); \
    b0_a2_a0_em = linear(b0_b0_a2_a0_em, a0_b0_a2_a0_em, (T)); \
    a0_a2_a0_em = linear(b0_a0_a2_a0_em, a0_a0_a2_a0_em, (T)); \
    b0_a3_a0_em = linear(b0_b0_a3_a0_em, a0_b0_a3_a0_em, (T)); \
    a0_a3_a0_em = linear(b0_a0_a3_a0_em, a0_a0_a3_a0_em, (T)); \
    b0_a4_a0_em = linear(b0_b0_a4_a0_em, a0_b0_a4_a0_em, (T)); \
    a0_a4_a0_em = linear(b0_a0_a4_a0_em, a0_a0_a4_a0_em, (T)); \
    b0_p1_a0_em = linear(b0_b0_p1_a0_em, a0_b0_p1_a0_em, (T)); \
    a0_p1_a0_em = linear(b0_a0_p1_a0_em, a0_a0_p1_a0_em, (T)); \
    b0_p2_a0_em = linear(b0_b0_p2_a0_em, a0_b0_p2_a0_em, (T)); \
    a0_p2_a0_em = linear(b0_a0_p2_a0_em, a0_a0_p2_a0_em, (T)); \
    b0_p3_a0_em = linear(b0_b0_p3_a0_em, a0_b0_p3_a0_em, (T)); \
    a0_p3_a0_em = linear(b0_a0_p3_a0_em, a0_a0_p3_a0_em, (T)); \
    b0_p4_a0_em = linear(b0_b0_p4_a0_em, a0_b0_p4_a0_em, (T)); \
    a0_p4_a0_em = linear(b0_a0_p4_a0_em, a0_a0_p4_a0_em, (T)); \
    b0_b0_a1_em = linear(b0_b0_b0_a1_em, a0_b0_b0_a1_em, (T)); \
    a0_b0_a1_em = linear(b0_a0_b0_a1_em, a0_a0_b0_a1_em, (T)); \
    b0_a0_a1_em = linear(b0_b0_a0_a1_em, a0_b0_a0_a1_em, (T)); \
    a0_a0_a1_em = linear(b0_a0_a0_a1_em, a0_a0_a0_a1_em, (T)); \
    b0_a1_a1_em = linear(b0_b0_a1_a1_em, a0_b0_a1_a1_em, (T)); \
    a0_a1_a1_em = linear(b0_a0_a1_a1_em, a0_a0_a1_a1_em, (T)); \
    b0_a2_a1_em = linear(b0_b0_a2_a1_em, a0_b0_a2_a1_em, (T)); \
    a0_a2_a1_em = linear(b0_a0_a2_a1_em, a0_a0_a2_a1_em, (T)); \
    b0_a3_a1_em = linear(b0_b0_a3_a1_em, a0_b0_a3_a1_em, (T)); \
    a0_a3_a1_em = linear(b0_a0_a3_a1_em, a0_a0_a3_a1_em, (T)); \
    b0_a4_a1_em = linear(b0_b0_a4_a1_em, a0_b0_a4_a1_em, (T)); \
    a0_a4_a1_em = linear(b0_a0_a4_a1_em, a0_a0_a4_a1_em, (T)); \
    b0_p1_a1_em = linear(b0_b0_p1_a1_em, a0_b0_p1_a1_em, (T)); \
    a0_p1_a1_em = linear(b0_a0_p1_a1_em, a0_a0_p1_a1_em, (T)); \
    b0_p2_a1_em = linear(b0_b0_p2_a1_em, a0_b0_p2_a1_em, (T)); \
    a0_p2_a1_em = linear(b0_a0_p2_a1_em, a0_a0_p2_a1_em, (T)); \
    b0_p3_a1_em = linear(b0_b0_p3_a1_em, a0_b0_p3_a1_em, (T)); \
    a0_p3_a1_em = linear(b0_a0_p3_a1_em, a0_a0_p3_a1_em, (T)); \
    b0_p4_a1_em = linear(b0_b0_p4_a1_em, a0_b0_p4_a1_em, (T)); \
    a0_p4_a1_em = linear(b0_a0_p4_a1_em, a0_a0_p4_a1_em, (T)); \
    b0_b0_a2_em = linear(b0_b0_b0_a2_em, a0_b0_b0_a2_em, (T)); \
    a0_b0_a2_em = linear(b0_a0_b0_a2_em, a0_a0_b0_a2_em, (T)); \
    b0_a0_a2_em = linear(b0_b0_a0_a2_em, a0_b0_a0_a2_em, (T)); \
    a0_a0_a2_em = linear(b0_a0_a0_a2_em, a0_a0_a0_a2_em, (T)); \
    b0_a1_a2_em = linear(b0_b0_a1_a2_em, a0_b0_a1_a2_em, (T)); \
    a0_a1_a2_em = linear(b0_a0_a1_a2_em, a0_a0_a1_a2_em, (T)); \
    b0_a2_a2_em = linear(b0_b0_a2_a2_em, a0_b0_a2_a2_em, (T)); \
    a0_a2_a2_em = linear(b0_a0_a2_a2_em, a0_a0_a2_a2_em, (T)); \
    b0_a3_a2_em = linear(b0_b0_a3_a2_em, a0_b0_a3_a2_em, (T)); \
    a0_a3_a2_em = linear(b0_a0_a3_a2_em, a0_a0_a3_a2_em, (T)); \
    b0_a4_a2_em = linear(b0_b0_a4_a2_em, a0_b0_a4_a2_em, (T)); \
    a0_a4_a2_em = linear(b0_a0_a4_a2_em, a0_a0_a4_a2_em, (T)); \
    b0_p1_a2_em = linear(b0_b0_p1_a2_em, a0_b0_p1_a2_em, (T)); \
    a0_p1_a2_em = linear(b0_a0_p1_a2_em, a0_a0_p1_a2_em, (T)); \
    b0_p2_a2_em = linear(b0_b0_p2_a2_em, a0_b0_p2_a2_em, (T)); \
    a0_p2_a2_em = linear(b0_a0_p2_a2_em, a0_a0_p2_a2_em, (T)); \
    b0_p3_a2_em = linear(b0_b0_p3_a2_em, a0_b0_p3_a2_em, (T)); \
    a0_p3_a2_em = linear(b0_a0_p3_a2_em, a0_a0_p3_a2_em, (T)); \
    b0_p4_a2_em = linear(b0_b0_p4_a2_em, a0_b0_p4_a2_em, (T)); \
    a0_p4_a2_em = linear(b0_a0_p4_a2_em, a0_a0_p4_a2_em, (T)); \
    b0_b0_a3_em = linear(b0_b0_b0_a3_em, a0_b0_b0_a3_em, (T)); \
    a0_b0_a3_em = linear(b0_a0_b0_a3_em, a0_a0_b0_a3_em, (T)); \
    b0_a0_a3_em = linear(b0_b0_a0_a3_em, a0_b0_a0_a3_em, (T)); \
    a0_a0_a3_em = linear(b0_a0_a0_a3_em, a0_a0_a0_a3_em, (T)); \
    b0_a1_a3_em = linear(b0_b0_a1_a3_em, a0_b0_a1_a3_em, (T)); \
    a0_a1_a3_em = linear(b0_a0_a1_a3_em, a0_a0_a1_a3_em, (T)); \
    b0_a2_a3_em = linear(b0_b0_a2_a3_em, a0_b0_a2_a3_em, (T)); \
    a0_a2_a3_em = linear(b0_a0_a2_a3_em, a0_a0_a2_a3_em, (T)); \
    b0_a3_a3_em = linear(b0_b0_a3_a3_em, a0_b0_a3_a3_em, (T)); \
    a0_a3_a3_em = linear(b0_a0_a3_a3_em, a0_a0_a3_a3_em, (T)); \
    b0_a4_a3_em = linear(b0_b0_a4_a3_em, a0_b0_a4_a3_em, (T)); \
    a0_a4_a3_em = linear(b0_a0_a4_a3_em, a0_a0_a4_a3_em, (T)); \
    b0_p1_a3_em = linear(b0_b0_p1_a3_em, a0_b0_p1_a3_em, (T)); \
    a0_p1_a3_em = linear(b0_a0_p1_a3_em, a0_a0_p1_a3_em, (T)); \
    b0_p2_a3_em = linear(b0_b0_p2_a3_em, a0_b0_p2_a3_em, (T)); \
    a0_p2_a3_em = linear(b0_a0_p2_a3_em, a0_a0_p2_a3_em, (T)); \
    b0_p3_a3_em = linear(b0_b0_p3_a3_em, a0_b0_p3_a3_em, (T)); \
    a0_p3_a3_em = linear(b0_a0_p3_a3_em, a0_a0_p3_a3_em, (T)); \
    b0_p4_a3_em = linear(b0_b0_p4_a3_em, a0_b0_p4_a3_em, (T)); \
    a0_p4_a3_em = linear(b0_a0_p4_a3_em, a0_a0_p4_a3_em, (T)); \
    b0_b0_a4_em = linear(b0_b0_b0_a4_em, a0_b0_b0_a4_em, (T)); \
    a0_b0_a4_em = linear(b0_a0_b0_a4_em, a0_a0_b0_a4_em, (T)); \
    b0_a0_a4_em = linear(b0_b0_a0_a4_em, a0_b0_a0_a4_em, (T)); \
    a0_a0_a4_em = linear(b0_a0_a0_a4_em, a0_a0_a0_a4_em, (T)); \
    b0_a1_a4_em = linear(b0_b0_a1_a4_em, a0_b0_a1_a4_em, (T)); \
    a0_a1_a4_em = linear(b0_a0_a1_a4_em, a0_a0_a1_a4_em, (T)); \
    b0_a2_a4_em = linear(b0_b0_a2_a4_em, a0_b0_a2_a4_em, (T)); \
    a0_a2_a4_em = linear(b0_a0_a2_a4_em, a0_a0_a2_a4_em, (T)); \
    b0_a3_a4_em = linear(b0_b0_a3_a4_em, a0_b0_a3_a4_em, (T)); \
    a0_a3_a4_em = linear(b0_a0_a3_a4_em, a0_a0_a3_a4_em, (T)); \
    b0_a4_a4_em = linear(b0_b0_a4_a4_em, a0_b0_a4_a4_em, (T)); \
    a0_a4_a4_em = linear(b0_a0_a4_a4_em, a0_a0_a4_a4_em, (T)); \
    b0_p1_a4_em = linear(b0_b0_p1_a4_em, a0_b0_p1_a4_em, (T)); \
    a0_p1_a4_em = linear(b0_a0_p1_a4_em, a0_a0_p1_a4_em, (T)); \
    b0_p2_a4_em = linear(b0_b0_p2_a4_em, a0_b0_p2_a4_em, (T)); \
    a0_p2_a4_em = linear(b0_a0_p2_a4_em, a0_a0_p2_a4_em, (T)); \
    b0_p3_a4_em = linear(b0_b0_p3_a4_em, a0_b0_p3_a4_em, (T)); \
    a0_p3_a4_em = linear(b0_a0_p3_a4_em, a0_a0_p3_a4_em, (T)); \
    b0_p4_a4_em = linear(b0_b0_p4_a4_em, a0_b0_p4_a4_em, (T)); \
    a0_p4_a4_em = linear(b0_a0_p4_a4_em, a0_a0_p4_a4_em, (T)); \
    b0_b0_p1_em = linear(b0_b0_b0_p1_em, a0_b0_b0_p1_em, (T)); \
    a0_b0_p1_em = linear(b0_a0_b0_p1_em, a0_a0_b0_p1_em, (T)); \
    b0_a0_p1_em = linear(b0_b0_a0_p1_em, a0_b0_a0_p1_em, (T)); \
    a0_a0_p1_em = linear(b0_a0_a0_p1_em, a0_a0_a0_p1_em, (T)); \
    b0_a1_p1_em = linear(b0_b0_a1_p1_em, a0_b0_a1_p1_em, (T)); \
    a0_a1_p1_em = linear(b0_a0_a1_p1_em, a0_a0_a1_p1_em, (T)); \
    b0_a2_p1_em = linear(b0_b0_a2_p1_em, a0_b0_a2_p1_em, (T)); \
    a0_a2_p1_em = linear(b0_a0_a2_p1_em, a0_a0_a2_p1_em, (T)); \
    b0_a3_p1_em = linear(b0_b0_a3_p1_em, a0_b0_a3_p1_em, (T)); \
    a0_a3_p1_em = linear(b0_a0_a3_p1_em, a0_a0_a3_p1_em, (T)); \
    b0_a4_p1_em = linear(b0_b0_a4_p1_em, a0_b0_a4_p1_em, (T)); \
    a0_a4_p1_em = linear(b0_a0_a4_p1_em, a0_a0_a4_p1_em, (T)); \
    b0_p1_p1_em = linear(b0_b0_p1_p1_em, a0_b0_p1_p1_em, (T)); \
    a0_p1_p1_em = linear(b0_a0_p1_p1_em, a0_a0_p1_p1_em, (T)); \
    b0_p2_p1_em = linear(b0_b0_p2_p1_em, a0_b0_p2_p1_em, (T)); \
    a0_p2_p1_em = linear(b0_a0_p2_p1_em, a0_a0_p2_p1_em, (T)); \
    b0_p3_p1_em = linear(b0_b0_p3_p1_em, a0_b0_p3_p1_em, (T)); \
    a0_p3_p1_em = linear(b0_a0_p3_p1_em, a0_a0_p3_p1_em, (T)); \
    b0_p4_p1_em = linear(b0_b0_p4_p1_em, a0_b0_p4_p1_em, (T)); \
    a0_p4_p1_em = linear(b0_a0_p4_p1_em, a0_a0_p4_p1_em, (T)); \
    b0_b0_p2_em = linear(b0_b0_b0_p2_em, a0_b0_b0_p2_em, (T)); \
    a0_b0_p2_em = linear(b0_a0_b0_p2_em, a0_a0_b0_p2_em, (T)); \
    b0_a0_p2_em = linear(b0_b0_a0_p2_em, a0_b0_a0_p2_em, (T)); \
    a0_a0_p2_em = linear(b0_a0_a0_p2_em, a0_a0_a0_p2_em, (T)); \
    b0_a1_p2_em = linear(b0_b0_a1_p2_em, a0_b0_a1_p2_em, (T)); \
    a0_a1_p2_em = linear(b0_a0_a1_p2_em, a0_a0_a1_p2_em, (T)); \
    b0_a2_p2_em = linear(b0_b0_a2_p2_em, a0_b0_a2_p2_em, (T)); \
    a0_a2_p2_em = linear(b0_a0_a2_p2_em, a0_a0_a2_p2_em, (T)); \
    b0_a3_p2_em = linear(b0_b0_a3_p2_em, a0_b0_a3_p2_em, (T)); \
    a0_a3_p2_em = linear(b0_a0_a3_p2_em, a0_a0_a3_p2_em, (T)); \
    b0_a4_p2_em = linear(b0_b0_a4_p2_em, a0_b0_a4_p2_em, (T)); \
    a0_a4_p2_em = linear(b0_a0_a4_p2_em, a0_a0_a4_p2_em, (T)); \
    b0_p1_p2_em = linear(b0_b0_p1_p2_em, a0_b0_p1_p2_em, (T)); \
    a0_p1_p2_em = linear(b0_a0_p1_p2_em, a0_a0_p1_p2_em, (T)); \
    b0_p2_p2_em = linear(b0_b0_p2_p2_em, a0_b0_p2_p2_em, (T)); \
    a0_p2_p2_em = linear(b0_a0_p2_p2_em, a0_a0_p2_p2_em, (T)); \
    b0_p3_p2_em = linear(b0_b0_p3_p2_em, a0_b0_p3_p2_em, (T)); \
    a0_p3_p2_em = linear(b0_a0_p3_p2_em, a0_a0_p3_p2_em, (T)); \
    b0_p4_p2_em = linear(b0_b0_p4_p2_em, a0_b0_p4_p2_em, (T)); \
    a0_p4_p2_em = linear(b0_a0_p4_p2_em, a0_a0_p4_p2_em, (T)); \
    b0_b0_p3_em = linear(b0_b0_b0_p3_em, a0_b0_b0_p3_em, (T)); \
    a0_b0_p3_em = linear(b0_a0_b0_p3_em, a0_a0_b0_p3_em, (T)); \
    b0_a0_p3_em = linear(b0_b0_a0_p3_em, a0_b0_a0_p3_em, (T)); \
    a0_a0_p3_em = linear(b0_a0_a0_p3_em, a0_a0_a0_p3_em, (T)); \
    b0_a1_p3_em = linear(b0_b0_a1_p3_em, a0_b0_a1_p3_em, (T)); \
    a0_a1_p3_em = linear(b0_a0_a1_p3_em, a0_a0_a1_p3_em, (T)); \
    b0_a2_p3_em = linear(b0_b0_a2_p3_em, a0_b0_a2_p3_em, (T)); \
    a0_a2_p3_em = linear(b0_a0_a2_p3_em, a0_a0_a2_p3_em, (T)); \
    b0_a3_p3_em = linear(b0_b0_a3_p3_em, a0_b0_a3_p3_em, (T)); \
    a0_a3_p3_em = linear(b0_a0_a3_p3_em, a0_a0_a3_p3_em, (T)); \
    b0_a4_p3_em = linear(b0_b0_a4_p3_em, a0_b0_a4_p3_em, (T)); \
    a0_a4_p3_em = linear(b0_a0_a4_p3_em, a0_a0_a4_p3_em, (T)); \
    b0_p1_p3_em = linear(b0_b0_p1_p3_em, a0_b0_p1_p3_em, (T)); \
    a0_p1_p3_em = linear(b0_a0_p1_p3_em, a0_a0_p1_p3_em, (T)); \
    b0_p2_p3_em = linear(b0_b0_p2_p3_em, a0_b0_p2_p3_em, (T)); \
    a0_p2_p3_em = linear(b0_a0_p2_p3_em, a0_a0_p2_p3_em, (T)); \
    b0_p3_p3_em = linear(b0_b0_p3_p3_em, a0_b0_p3_p3_em, (T)); \
    a0_p3_p3_em = linear(b0_a0_p3_p3_em, a0_a0_p3_p3_em, (T)); \
    b0_p4_p3_em = linear(b0_b0_p4_p3_em, a0_b0_p4_p3_em, (T)); \
    a0_p4_p3_em = linear(b0_a0_p4_p3_em, a0_a0_p4_p3_em, (T)); \
    b0_b0_p4_em = linear(b0_b0_b0_p4_em, a0_b0_b0_p4_em, (T)); \
    a0_b0_p4_em = linear(b0_a0_b0_p4_em, a0_a0_b0_p4_em, (T)); \
    b0_a0_p4_em = linear(b0_b0_a0_p4_em, a0_b0_a0_p4_em, (T)); \
    a0_a0_p4_em = linear(b0_a0_a0_p4_em, a0_a0_a0_p4_em, (T)); \
    b0_a1_p4_em = linear(b0_b0_a1_p4_em, a0_b0_a1_p4_em, (T)); \
    a0_a1_p4_em = linear(b0_a0_a1_p4_em, a0_a0_a1_p4_em, (T)); \
    b0_a2_p4_em = linear(b0_b0_a2_p4_em, a0_b0_a2_p4_em, (T)); \
    a0_a2_p4_em = linear(b0_a0_a2_p4_em, a0_a0_a2_p4_em, (T)); \
    b0_a3_p4_em = linear(b0_b0_a3_p4_em, a0_b0_a3_p4_em, (T)); \
    a0_a3_p4_em = linear(b0_a0_a3_p4_em, a0_a0_a3_p4_em, (T)); \
    b0_a4_p4_em = linear(b0_b0_a4_p4_em, a0_b0_a4_p4_em, (T)); \
    a0_a4_p4_em = linear(b0_a0_a4_p4_em, a0_a0_a4_p4_em, (T)); \
    b0_p1_p4_em = linear(b0_b0_p1_p4_em, a0_b0_p1_p4_em, (T)); \
    a0_p1_p4_em = linear(b0_a0_p1_p4_em, a0_a0_p1_p4_em, (T)); \
    b0_p2_p4_em = linear(b0_b0_p2_p4_em, a0_b0_p2_p4_em, (T)); \
    a0_p2_p4_em = linear(b0_a0_p2_p4_em, a0_a0_p2_p4_em, (T)); \
    b0_p3_p4_em = linear(b0_b0_p3_p4_em, a0_b0_p3_p4_em, (T)); \
    a0_p3_p4_em = linear(b0_a0_p3_p4_em, a0_a0_p3_p4_em, (T)); \
    b0_p4_p4_em = linear(b0_b0_p4_p4_em, a0_b0_p4_p4_em, (T)); \
    a0_p4_p4_em = linear(b0_a0_p4_p4_em, a0_a0_p4_p4_em, (T)); \
    b0_b0_em    = linear(b0_b0_b0_em,    a0_b0_b0_em,    (VSubS)); \
    a0_b0_em    = linear(b0_a0_b0_em,    a0_a0_b0_em,    (VSubS)); \
    a1_b0_em    = linear(b0_a1_b0_em,    a0_a1_b0_em,    (VSubS)); \
    a2_b0_em    = linear(b0_a2_b0_em,    a0_a2_b0_em,    (VSubS)); \
    a3_b0_em    = linear(b0_a3_b0_em,    a0_a3_b0_em,    (VSubS)); \
    a4_b0_em    = linear(b0_a4_b0_em,    a0_a4_b0_em,    (VSubS)); \
    p1_b0_em    = linear(b0_p1_b0_em,    a0_p1_b0_em,    (VSubS)); \
    p2_b0_em    = linear(b0_p2_b0_em,    a0_p2_b0_em,    (VSubS)); \
    p3_b0_em    = linear(b0_p3_b0_em,    a0_p3_b0_em,    (VSubS)); \
    p4_b0_em    = linear(b0_p4_b0_em,    a0_p4_b0_em,    (VSubS)); \
    b0_a0_em    = linear(b0_b0_a0_em,    a0_b0_a0_em,    (VSubS)); \
    a0_a0_em    = linear(b0_a0_a0_em,    a0_a0_a0_em,    (VSubS)); \
    a1_a0_em    = linear(b0_a1_a0_em,    a0_a1_a0_em,    (VSubS)); \
    a2_a0_em    = linear(b0_a2_a0_em,    a0_a2_a0_em,    (VSubS)); \
    a3_a0_em    = linear(b0_a3_a0_em,    a0_a3_a0_em,    (VSubS)); \
    a4_a0_em    = linear(b0_a4_a0_em,    a0_a4_a0_em,    (VSubS)); \
    p1_a0_em    = linear(b0_p1_a0_em,    a0_p1_a0_em,    (VSubS)); \
    p2_a0_em    = linear(b0_p2_a0_em,    a0_p2_a0_em,    (VSubS)); \
    p3_a0_em    = linear(b0_p3_a0_em,    a0_p3_a0_em,    (VSubS)); \
    p4_a0_em    = linear(b0_p4_a0_em,    a0_p4_a0_em,    (VSubS)); \
    b0_a1_em    = linear(b0_b0_a1_em,    a0_b0_a1_em,    (VSubS)); \
    a0_a1_em    = linear(b0_a0_a1_em,    a0_a0_a1_em,    (VSubS)); \
    a1_a1_em    = linear(b0_a1_a1_em,    a0_a1_a1_em,    (VSubS)); \
    a2_a1_em    = linear(b0_a2_a1_em,    a0_a2_a1_em,    (VSubS)); \
    a3_a1_em    = linear(b0_a3_a1_em,    a0_a3_a1_em,    (VSubS)); \
    a4_a1_em    = linear(b0_a4_a1_em,    a0_a4_a1_em,    (VSubS)); \
    p1_a1_em    = linear(b0_p1_a1_em,    a0_p1_a1_em,    (VSubS)); \
    p2_a1_em    = linear(b0_p2_a1_em,    a0_p2_a1_em,    (VSubS)); \
    p3_a1_em    = linear(b0_p3_a1_em,    a0_p3_a1_em,    (VSubS)); \
    p4_a1_em    = linear(b0_p4_a1_em,    a0_p4_a1_em,    (VSubS)); \
    b0_a2_em    = linear(b0_b0_a2_em,    a0_b0_a2_em,    (VSubS)); \
    a0_a2_em    = linear(b0_a0_a2_em,    a0_a0_a2_em,    (VSubS)); \
    a1_a2_em    = linear(b0_a1_a2_em,    a0_a1_a2_em,    (VSubS)); \
    a2_a2_em    = linear(b0_a2_a2_em,    a0_a2_a2_em,    (VSubS)); \
    a3_a2_em    = linear(b0_a3_a2_em,    a0_a3_a2_em,    (VSubS)); \
    a4_a2_em    = linear(b0_a4_a2_em,    a0_a4_a2_em,    (VSubS)); \
    p1_a2_em    = linear(b0_p1_a2_em,    a0_p1_a2_em,    (VSubS)); \
    p2_a2_em    = linear(b0_p2_a2_em,    a0_p2_a2_em,    (VSubS)); \
    p3_a2_em    = linear(b0_p3_a2_em,    a0_p3_a2_em,    (VSubS)); \
    p4_a2_em    = linear(b0_p4_a2_em,    a0_p4_a2_em,    (VSubS)); \
    b0_a3_em    = linear(b0_b0_a3_em,    a0_b0_a3_em,    (VSubS)); \
    a0_a3_em    = linear(b0_a0_a3_em,    a0_a0_a3_em,    (VSubS)); \
    a1_a3_em    = linear(b0_a1_a3_em,    a0_a1_a3_em,    (VSubS)); \
    a2_a3_em    = linear(b0_a2_a3_em,    a0_a2_a3_em,    (VSubS)); \
    a3_a3_em    = linear(b0_a3_a3_em,    a0_a3_a3_em,    (VSubS)); \
    a4_a3_em    = linear(b0_a4_a3_em,    a0_a4_a3_em,    (VSubS)); \
    p1_a3_em    = linear(b0_p1_a3_em,    a0_p1_a3_em,    (VSubS)); \
    p2_a3_em    = linear(b0_p2_a3_em,    a0_p2_a3_em,    (VSubS)); \
    p3_a3_em    = linear(b0_p3_a3_em,    a0_p3_a3_em,    (VSubS)); \
    p4_a3_em    = linear(b0_p4_a3_em,    a0_p4_a3_em,    (VSubS)); \
    b0_a4_em    = linear(b0_b0_a4_em,    a0_b0_a4_em,    (VSubS)); \
    a0_a4_em    = linear(b0_a0_a4_em,    a0_a0_a4_em,    (VSubS)); \
    a1_a4_em    = linear(b0_a1_a4_em,    a0_a1_a4_em,    (VSubS)); \
    a2_a4_em    = linear(b0_a2_a4_em,    a0_a2_a4_em,    (VSubS)); \
    a3_a4_em    = linear(b0_a3_a4_em,    a0_a3_a4_em,    (VSubS)); \
    a4_a4_em    = linear(b0_a4_a4_em,    a0_a4_a4_em,    (VSubS)); \
    p1_a4_em    = linear(b0_p1_a4_em,    a0_p1_a4_em,    (VSubS)); \
    p2_a4_em    = linear(b0_p2_a4_em,    a0_p2_a4_em,    (VSubS)); \
    p3_a4_em    = linear(b0_p3_a4_em,    a0_p3_a4_em,    (VSubS)); \
    p4_a4_em    = linear(b0_p4_a4_em,    a0_p4_a4_em,    (VSubS)); \
    b0_p1_em    = linear(b0_b0_p1_em,    a0_b0_p1_em,    (VSubS)); \
    a0_p1_em    = linear(b0_a0_p1_em,    a0_a0_p1_em,    (VSubS)); \
    a1_p1_em    = linear(b0_a1_p1_em,    a0_a1_p1_em,    (VSubS)); \
    a2_p1_em    = linear(b0_a2_p1_em,    a0_a2_p1_em,    (VSubS)); \
    a3_p1_em    = linear(b0_a3_p1_em,    a0_a3_p1_em,    (VSubS)); \
    a4_p1_em    = linear(b0_a4_p1_em,    a0_a4_p1_em,    (VSubS)); \
    p1_p1_em    = linear(b0_p1_p1_em,    a0_p1_p1_em,    (VSubS)); \
    p2_p1_em    = linear(b0_p2_p1_em,    a0_p2_p1_em,    (VSubS)); \
    p3_p1_em    = linear(b0_p3_p1_em,    a0_p3_p1_em,    (VSubS)); \
    p4_p1_em    = linear(b0_p4_p1_em,    a0_p4_p1_em,    (VSubS)); \
    b0_p2_em    = linear(b0_b0_p2_em,    a0_b0_p2_em,    (VSubS)); \
    a0_p2_em    = linear(b0_a0_p2_em,    a0_a0_p2_em,    (VSubS)); \
    a1_p2_em    = linear(b0_a1_p2_em,    a0_a1_p2_em,    (VSubS)); \
    a2_p2_em    = linear(b0_a2_p2_em,    a0_a2_p2_em,    (VSubS)); \
    a3_p2_em    = linear(b0_a3_p2_em,    a0_a3_p2_em,    (VSubS)); \
    a4_p2_em    = linear(b0_a4_p2_em,    a0_a4_p2_em,    (VSubS)); \
    p1_p2_em    = linear(b0_p1_p2_em,    a0_p1_p2_em,    (VSubS)); \
    p2_p2_em    = linear(b0_p2_p2_em,    a0_p2_p2_em,    (VSubS)); \
    p3_p2_em    = linear(b0_p3_p2_em,    a0_p3_p2_em,    (VSubS)); \
    p4_p2_em    = linear(b0_p4_p2_em,    a0_p4_p2_em,    (VSubS)); \
    b0_p3_em    = linear(b0_b0_p3_em,    a0_b0_p3_em,    (VSubS)); \
    a0_p3_em    = linear(b0_a0_p3_em,    a0_a0_p3_em,    (VSubS)); \
    a1_p3_em    = linear(b0_a1_p3_em,    a0_a1_p3_em,    (VSubS)); \
    a2_p3_em    = linear(b0_a2_p3_em,    a0_a2_p3_em,    (VSubS)); \
    a3_p3_em    = linear(b0_a3_p3_em,    a0_a3_p3_em,    (VSubS)); \
    a4_p3_em    = linear(b0_a4_p3_em,    a0_a4_p3_em,    (VSubS)); \
    p1_p3_em    = linear(b0_p1_p3_em,    a0_p1_p3_em,    (VSubS)); \
    p2_p3_em    = linear(b0_p2_p3_em,    a0_p2_p3_em,    (VSubS)); \
    p3_p3_em    = linear(b0_p3_p3_em,    a0_p3_p3_em,    (VSubS)); \
    p4_p3_em    = linear(b0_p4_p3_em,    a0_p4_p3_em,    (VSubS)); \
    b0_p4_em    = linear(b0_b0_p4_em,    a0_b0_p4_em,    (VSubS)); \
    a0_p4_em    = linear(b0_a0_p4_em,    a0_a0_p4_em,    (VSubS)); \
    a1_p4_em    = linear(b0_a1_p4_em,    a0_a1_p4_em,    (VSubS)); \
    a2_p4_em    = linear(b0_a2_p4_em,    a0_a2_p4_em,    (VSubS)); \
    a3_p4_em    = linear(b0_a3_p4_em,    a0_a3_p4_em,    (VSubS)); \
    a4_p4_em    = linear(b0_a4_p4_em,    a0_a4_p4_em,    (VSubS)); \
    p1_p4_em    = linear(b0_p1_p4_em,    a0_p1_p4_em,    (VSubS)); \
    p2_p4_em    = linear(b0_p2_p4_em,    a0_p2_p4_em,    (VSubS)); \
    p3_p4_em    = linear(b0_p3_p4_em,    a0_p3_p4_em,    (VSubS)); \
    p4_p4_em    = linear(b0_p4_p4_em,    a0_p4_p4_em,    (VSubS)); \
    b0_em = linear_5reg(b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em, p2_b0_em, p3_b0_em, p4_b0_em, (VGS)); \
    a0_em = linear_5reg(b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em, a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, (VGS)); \
    a1_em = linear_5reg(b0_a1_em, a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em, p3_a1_em, p4_a1_em, (VGS)); \
    a2_em = linear_5reg(b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em, a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, (VGS)); \
    a3_em = linear_5reg(b0_a3_em, a0_a3_em, a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em, p4_a3_em, (VGS)); \
    a4_em = linear_5reg(b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em, p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, (VGS)); \
    p1_em = linear_5reg(b0_p1_em, a0_p1_em, a1_p1_em, a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em, (VGS)); \
    p2_em = linear_5reg(b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em, p2_p2_em, p3_p2_em, p4_p2_em, (VGS)); \
    p3_em = linear_5reg(b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em, a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, (VGS)); \
    p4_em = linear_5reg(b0_p4_em, a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em, p3_p4_em, p4_p4_em, (VGS)); \
    em    = linear_5reg(b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, (VDS));

`define EM2(T, VGS, VDS, VSubS) \
    b0_b0_b0_em2 = linear(b0_b0_b0_b0_em2, a0_b0_b0_b0_em2, (T)); \
    a0_b0_b0_em2 = linear(b0_a0_b0_b0_em2, a0_a0_b0_b0_em2, (T)); \
    b0_a0_b0_em2 = linear(b0_b0_a0_b0_em2, a0_b0_a0_b0_em2, (T)); \
    a0_a0_b0_em2 = linear(b0_a0_a0_b0_em2, a0_a0_a0_b0_em2, (T)); \
    b0_a1_b0_em2 = linear(b0_b0_a1_b0_em2, a0_b0_a1_b0_em2, (T)); \
    a0_a1_b0_em2 = linear(b0_a0_a1_b0_em2, a0_a0_a1_b0_em2, (T)); \
    b0_a2_b0_em2 = linear(b0_b0_a2_b0_em2, a0_b0_a2_b0_em2, (T)); \
    a0_a2_b0_em2 = linear(b0_a0_a2_b0_em2, a0_a0_a2_b0_em2, (T)); \
    b0_a3_b0_em2 = linear(b0_b0_a3_b0_em2, a0_b0_a3_b0_em2, (T)); \
    a0_a3_b0_em2 = linear(b0_a0_a3_b0_em2, a0_a0_a3_b0_em2, (T)); \
    b0_a4_b0_em2 = linear(b0_b0_a4_b0_em2, a0_b0_a4_b0_em2, (T)); \
    a0_a4_b0_em2 = linear(b0_a0_a4_b0_em2, a0_a0_a4_b0_em2, (T)); \
    b0_p1_b0_em2 = linear(b0_b0_p1_b0_em2, a0_b0_p1_b0_em2, (T)); \
    a0_p1_b0_em2 = linear(b0_a0_p1_b0_em2, a0_a0_p1_b0_em2, (T)); \
    b0_p2_b0_em2 = linear(b0_b0_p2_b0_em2, a0_b0_p2_b0_em2, (T)); \
    a0_p2_b0_em2 = linear(b0_a0_p2_b0_em2, a0_a0_p2_b0_em2, (T)); \
    b0_p3_b0_em2 = linear(b0_b0_p3_b0_em2, a0_b0_p3_b0_em2, (T)); \
    a0_p3_b0_em2 = linear(b0_a0_p3_b0_em2, a0_a0_p3_b0_em2, (T)); \
    b0_p4_b0_em2 = linear(b0_b0_p4_b0_em2, a0_b0_p4_b0_em2, (T)); \
    a0_p4_b0_em2 = linear(b0_a0_p4_b0_em2, a0_a0_p4_b0_em2, (T)); \
    b0_b0_a0_em2 = linear(b0_b0_b0_a0_em2, a0_b0_b0_a0_em2, (T)); \
    a0_b0_a0_em2 = linear(b0_a0_b0_a0_em2, a0_a0_b0_a0_em2, (T)); \
    b0_a0_a0_em2 = linear(b0_b0_a0_a0_em2, a0_b0_a0_a0_em2, (T)); \
    a0_a0_a0_em2 = linear(b0_a0_a0_a0_em2, a0_a0_a0_a0_em2, (T)); \
    b0_a1_a0_em2 = linear(b0_b0_a1_a0_em2, a0_b0_a1_a0_em2, (T)); \
    a0_a1_a0_em2 = linear(b0_a0_a1_a0_em2, a0_a0_a1_a0_em2, (T)); \
    b0_a2_a0_em2 = linear(b0_b0_a2_a0_em2, a0_b0_a2_a0_em2, (T)); \
    a0_a2_a0_em2 = linear(b0_a0_a2_a0_em2, a0_a0_a2_a0_em2, (T)); \
    b0_a3_a0_em2 = linear(b0_b0_a3_a0_em2, a0_b0_a3_a0_em2, (T)); \
    a0_a3_a0_em2 = linear(b0_a0_a3_a0_em2, a0_a0_a3_a0_em2, (T)); \
    b0_a4_a0_em2 = linear(b0_b0_a4_a0_em2, a0_b0_a4_a0_em2, (T)); \
    a0_a4_a0_em2 = linear(b0_a0_a4_a0_em2, a0_a0_a4_a0_em2, (T)); \
    b0_p1_a0_em2 = linear(b0_b0_p1_a0_em2, a0_b0_p1_a0_em2, (T)); \
    a0_p1_a0_em2 = linear(b0_a0_p1_a0_em2, a0_a0_p1_a0_em2, (T)); \
    b0_p2_a0_em2 = linear(b0_b0_p2_a0_em2, a0_b0_p2_a0_em2, (T)); \
    a0_p2_a0_em2 = linear(b0_a0_p2_a0_em2, a0_a0_p2_a0_em2, (T)); \
    b0_p3_a0_em2 = linear(b0_b0_p3_a0_em2, a0_b0_p3_a0_em2, (T)); \
    a0_p3_a0_em2 = linear(b0_a0_p3_a0_em2, a0_a0_p3_a0_em2, (T)); \
    b0_p4_a0_em2 = linear(b0_b0_p4_a0_em2, a0_b0_p4_a0_em2, (T)); \
    a0_p4_a0_em2 = linear(b0_a0_p4_a0_em2, a0_a0_p4_a0_em2, (T)); \
    b0_b0_a1_em2 = linear(b0_b0_b0_a1_em2, a0_b0_b0_a1_em2, (T)); \
    a0_b0_a1_em2 = linear(b0_a0_b0_a1_em2, a0_a0_b0_a1_em2, (T)); \
    b0_a0_a1_em2 = linear(b0_b0_a0_a1_em2, a0_b0_a0_a1_em2, (T)); \
    a0_a0_a1_em2 = linear(b0_a0_a0_a1_em2, a0_a0_a0_a1_em2, (T)); \
    b0_a1_a1_em2 = linear(b0_b0_a1_a1_em2, a0_b0_a1_a1_em2, (T)); \
    a0_a1_a1_em2 = linear(b0_a0_a1_a1_em2, a0_a0_a1_a1_em2, (T)); \
    b0_a2_a1_em2 = linear(b0_b0_a2_a1_em2, a0_b0_a2_a1_em2, (T)); \
    a0_a2_a1_em2 = linear(b0_a0_a2_a1_em2, a0_a0_a2_a1_em2, (T)); \
    b0_a3_a1_em2 = linear(b0_b0_a3_a1_em2, a0_b0_a3_a1_em2, (T)); \
    a0_a3_a1_em2 = linear(b0_a0_a3_a1_em2, a0_a0_a3_a1_em2, (T)); \
    b0_a4_a1_em2 = linear(b0_b0_a4_a1_em2, a0_b0_a4_a1_em2, (T)); \
    a0_a4_a1_em2 = linear(b0_a0_a4_a1_em2, a0_a0_a4_a1_em2, (T)); \
    b0_p1_a1_em2 = linear(b0_b0_p1_a1_em2, a0_b0_p1_a1_em2, (T)); \
    a0_p1_a1_em2 = linear(b0_a0_p1_a1_em2, a0_a0_p1_a1_em2, (T)); \
    b0_p2_a1_em2 = linear(b0_b0_p2_a1_em2, a0_b0_p2_a1_em2, (T)); \
    a0_p2_a1_em2 = linear(b0_a0_p2_a1_em2, a0_a0_p2_a1_em2, (T)); \
    b0_p3_a1_em2 = linear(b0_b0_p3_a1_em2, a0_b0_p3_a1_em2, (T)); \
    a0_p3_a1_em2 = linear(b0_a0_p3_a1_em2, a0_a0_p3_a1_em2, (T)); \
    b0_p4_a1_em2 = linear(b0_b0_p4_a1_em2, a0_b0_p4_a1_em2, (T)); \
    a0_p4_a1_em2 = linear(b0_a0_p4_a1_em2, a0_a0_p4_a1_em2, (T)); \
    b0_b0_a2_em2 = linear(b0_b0_b0_a2_em2, a0_b0_b0_a2_em2, (T)); \
    a0_b0_a2_em2 = linear(b0_a0_b0_a2_em2, a0_a0_b0_a2_em2, (T)); \
    b0_a0_a2_em2 = linear(b0_b0_a0_a2_em2, a0_b0_a0_a2_em2, (T)); \
    a0_a0_a2_em2 = linear(b0_a0_a0_a2_em2, a0_a0_a0_a2_em2, (T)); \
    b0_a1_a2_em2 = linear(b0_b0_a1_a2_em2, a0_b0_a1_a2_em2, (T)); \
    a0_a1_a2_em2 = linear(b0_a0_a1_a2_em2, a0_a0_a1_a2_em2, (T)); \
    b0_a2_a2_em2 = linear(b0_b0_a2_a2_em2, a0_b0_a2_a2_em2, (T)); \
    a0_a2_a2_em2 = linear(b0_a0_a2_a2_em2, a0_a0_a2_a2_em2, (T)); \
    b0_a3_a2_em2 = linear(b0_b0_a3_a2_em2, a0_b0_a3_a2_em2, (T)); \
    a0_a3_a2_em2 = linear(b0_a0_a3_a2_em2, a0_a0_a3_a2_em2, (T)); \
    b0_a4_a2_em2 = linear(b0_b0_a4_a2_em2, a0_b0_a4_a2_em2, (T)); \
    a0_a4_a2_em2 = linear(b0_a0_a4_a2_em2, a0_a0_a4_a2_em2, (T)); \
    b0_p1_a2_em2 = linear(b0_b0_p1_a2_em2, a0_b0_p1_a2_em2, (T)); \
    a0_p1_a2_em2 = linear(b0_a0_p1_a2_em2, a0_a0_p1_a2_em2, (T)); \
    b0_p2_a2_em2 = linear(b0_b0_p2_a2_em2, a0_b0_p2_a2_em2, (T)); \
    a0_p2_a2_em2 = linear(b0_a0_p2_a2_em2, a0_a0_p2_a2_em2, (T)); \
    b0_p3_a2_em2 = linear(b0_b0_p3_a2_em2, a0_b0_p3_a2_em2, (T)); \
    a0_p3_a2_em2 = linear(b0_a0_p3_a2_em2, a0_a0_p3_a2_em2, (T)); \
    b0_p4_a2_em2 = linear(b0_b0_p4_a2_em2, a0_b0_p4_a2_em2, (T)); \
    a0_p4_a2_em2 = linear(b0_a0_p4_a2_em2, a0_a0_p4_a2_em2, (T)); \
    b0_b0_a3_em2 = linear(b0_b0_b0_a3_em2, a0_b0_b0_a3_em2, (T)); \
    a0_b0_a3_em2 = linear(b0_a0_b0_a3_em2, a0_a0_b0_a3_em2, (T)); \
    b0_a0_a3_em2 = linear(b0_b0_a0_a3_em2, a0_b0_a0_a3_em2, (T)); \
    a0_a0_a3_em2 = linear(b0_a0_a0_a3_em2, a0_a0_a0_a3_em2, (T)); \
    b0_a1_a3_em2 = linear(b0_b0_a1_a3_em2, a0_b0_a1_a3_em2, (T)); \
    a0_a1_a3_em2 = linear(b0_a0_a1_a3_em2, a0_a0_a1_a3_em2, (T)); \
    b0_a2_a3_em2 = linear(b0_b0_a2_a3_em2, a0_b0_a2_a3_em2, (T)); \
    a0_a2_a3_em2 = linear(b0_a0_a2_a3_em2, a0_a0_a2_a3_em2, (T)); \
    b0_a3_a3_em2 = linear(b0_b0_a3_a3_em2, a0_b0_a3_a3_em2, (T)); \
    a0_a3_a3_em2 = linear(b0_a0_a3_a3_em2, a0_a0_a3_a3_em2, (T)); \
    b0_a4_a3_em2 = linear(b0_b0_a4_a3_em2, a0_b0_a4_a3_em2, (T)); \
    a0_a4_a3_em2 = linear(b0_a0_a4_a3_em2, a0_a0_a4_a3_em2, (T)); \
    b0_p1_a3_em2 = linear(b0_b0_p1_a3_em2, a0_b0_p1_a3_em2, (T)); \
    a0_p1_a3_em2 = linear(b0_a0_p1_a3_em2, a0_a0_p1_a3_em2, (T)); \
    b0_p2_a3_em2 = linear(b0_b0_p2_a3_em2, a0_b0_p2_a3_em2, (T)); \
    a0_p2_a3_em2 = linear(b0_a0_p2_a3_em2, a0_a0_p2_a3_em2, (T)); \
    b0_p3_a3_em2 = linear(b0_b0_p3_a3_em2, a0_b0_p3_a3_em2, (T)); \
    a0_p3_a3_em2 = linear(b0_a0_p3_a3_em2, a0_a0_p3_a3_em2, (T)); \
    b0_p4_a3_em2 = linear(b0_b0_p4_a3_em2, a0_b0_p4_a3_em2, (T)); \
    a0_p4_a3_em2 = linear(b0_a0_p4_a3_em2, a0_a0_p4_a3_em2, (T)); \
    b0_b0_a4_em2 = linear(b0_b0_b0_a4_em2, a0_b0_b0_a4_em2, (T)); \
    a0_b0_a4_em2 = linear(b0_a0_b0_a4_em2, a0_a0_b0_a4_em2, (T)); \
    b0_a0_a4_em2 = linear(b0_b0_a0_a4_em2, a0_b0_a0_a4_em2, (T)); \
    a0_a0_a4_em2 = linear(b0_a0_a0_a4_em2, a0_a0_a0_a4_em2, (T)); \
    b0_a1_a4_em2 = linear(b0_b0_a1_a4_em2, a0_b0_a1_a4_em2, (T)); \
    a0_a1_a4_em2 = linear(b0_a0_a1_a4_em2, a0_a0_a1_a4_em2, (T)); \
    b0_a2_a4_em2 = linear(b0_b0_a2_a4_em2, a0_b0_a2_a4_em2, (T)); \
    a0_a2_a4_em2 = linear(b0_a0_a2_a4_em2, a0_a0_a2_a4_em2, (T)); \
    b0_a3_a4_em2 = linear(b0_b0_a3_a4_em2, a0_b0_a3_a4_em2, (T)); \
    a0_a3_a4_em2 = linear(b0_a0_a3_a4_em2, a0_a0_a3_a4_em2, (T)); \
    b0_a4_a4_em2 = linear(b0_b0_a4_a4_em2, a0_b0_a4_a4_em2, (T)); \
    a0_a4_a4_em2 = linear(b0_a0_a4_a4_em2, a0_a0_a4_a4_em2, (T)); \
    b0_p1_a4_em2 = linear(b0_b0_p1_a4_em2, a0_b0_p1_a4_em2, (T)); \
    a0_p1_a4_em2 = linear(b0_a0_p1_a4_em2, a0_a0_p1_a4_em2, (T)); \
    b0_p2_a4_em2 = linear(b0_b0_p2_a4_em2, a0_b0_p2_a4_em2, (T)); \
    a0_p2_a4_em2 = linear(b0_a0_p2_a4_em2, a0_a0_p2_a4_em2, (T)); \
    b0_p3_a4_em2 = linear(b0_b0_p3_a4_em2, a0_b0_p3_a4_em2, (T)); \
    a0_p3_a4_em2 = linear(b0_a0_p3_a4_em2, a0_a0_p3_a4_em2, (T)); \
    b0_p4_a4_em2 = linear(b0_b0_p4_a4_em2, a0_b0_p4_a4_em2, (T)); \
    a0_p4_a4_em2 = linear(b0_a0_p4_a4_em2, a0_a0_p4_a4_em2, (T)); \
    b0_b0_p1_em2 = linear(b0_b0_b0_p1_em2, a0_b0_b0_p1_em2, (T)); \
    a0_b0_p1_em2 = linear(b0_a0_b0_p1_em2, a0_a0_b0_p1_em2, (T)); \
    b0_a0_p1_em2 = linear(b0_b0_a0_p1_em2, a0_b0_a0_p1_em2, (T)); \
    a0_a0_p1_em2 = linear(b0_a0_a0_p1_em2, a0_a0_a0_p1_em2, (T)); \
    b0_a1_p1_em2 = linear(b0_b0_a1_p1_em2, a0_b0_a1_p1_em2, (T)); \
    a0_a1_p1_em2 = linear(b0_a0_a1_p1_em2, a0_a0_a1_p1_em2, (T)); \
    b0_a2_p1_em2 = linear(b0_b0_a2_p1_em2, a0_b0_a2_p1_em2, (T)); \
    a0_a2_p1_em2 = linear(b0_a0_a2_p1_em2, a0_a0_a2_p1_em2, (T)); \
    b0_a3_p1_em2 = linear(b0_b0_a3_p1_em2, a0_b0_a3_p1_em2, (T)); \
    a0_a3_p1_em2 = linear(b0_a0_a3_p1_em2, a0_a0_a3_p1_em2, (T)); \
    b0_a4_p1_em2 = linear(b0_b0_a4_p1_em2, a0_b0_a4_p1_em2, (T)); \
    a0_a4_p1_em2 = linear(b0_a0_a4_p1_em2, a0_a0_a4_p1_em2, (T)); \
    b0_p1_p1_em2 = linear(b0_b0_p1_p1_em2, a0_b0_p1_p1_em2, (T)); \
    a0_p1_p1_em2 = linear(b0_a0_p1_p1_em2, a0_a0_p1_p1_em2, (T)); \
    b0_p2_p1_em2 = linear(b0_b0_p2_p1_em2, a0_b0_p2_p1_em2, (T)); \
    a0_p2_p1_em2 = linear(b0_a0_p2_p1_em2, a0_a0_p2_p1_em2, (T)); \
    b0_p3_p1_em2 = linear(b0_b0_p3_p1_em2, a0_b0_p3_p1_em2, (T)); \
    a0_p3_p1_em2 = linear(b0_a0_p3_p1_em2, a0_a0_p3_p1_em2, (T)); \
    b0_p4_p1_em2 = linear(b0_b0_p4_p1_em2, a0_b0_p4_p1_em2, (T)); \
    a0_p4_p1_em2 = linear(b0_a0_p4_p1_em2, a0_a0_p4_p1_em2, (T)); \
    b0_b0_p2_em2 = linear(b0_b0_b0_p2_em2, a0_b0_b0_p2_em2, (T)); \
    a0_b0_p2_em2 = linear(b0_a0_b0_p2_em2, a0_a0_b0_p2_em2, (T)); \
    b0_a0_p2_em2 = linear(b0_b0_a0_p2_em2, a0_b0_a0_p2_em2, (T)); \
    a0_a0_p2_em2 = linear(b0_a0_a0_p2_em2, a0_a0_a0_p2_em2, (T)); \
    b0_a1_p2_em2 = linear(b0_b0_a1_p2_em2, a0_b0_a1_p2_em2, (T)); \
    a0_a1_p2_em2 = linear(b0_a0_a1_p2_em2, a0_a0_a1_p2_em2, (T)); \
    b0_a2_p2_em2 = linear(b0_b0_a2_p2_em2, a0_b0_a2_p2_em2, (T)); \
    a0_a2_p2_em2 = linear(b0_a0_a2_p2_em2, a0_a0_a2_p2_em2, (T)); \
    b0_a3_p2_em2 = linear(b0_b0_a3_p2_em2, a0_b0_a3_p2_em2, (T)); \
    a0_a3_p2_em2 = linear(b0_a0_a3_p2_em2, a0_a0_a3_p2_em2, (T)); \
    b0_a4_p2_em2 = linear(b0_b0_a4_p2_em2, a0_b0_a4_p2_em2, (T)); \
    a0_a4_p2_em2 = linear(b0_a0_a4_p2_em2, a0_a0_a4_p2_em2, (T)); \
    b0_p1_p2_em2 = linear(b0_b0_p1_p2_em2, a0_b0_p1_p2_em2, (T)); \
    a0_p1_p2_em2 = linear(b0_a0_p1_p2_em2, a0_a0_p1_p2_em2, (T)); \
    b0_p2_p2_em2 = linear(b0_b0_p2_p2_em2, a0_b0_p2_p2_em2, (T)); \
    a0_p2_p2_em2 = linear(b0_a0_p2_p2_em2, a0_a0_p2_p2_em2, (T)); \
    b0_p3_p2_em2 = linear(b0_b0_p3_p2_em2, a0_b0_p3_p2_em2, (T)); \
    a0_p3_p2_em2 = linear(b0_a0_p3_p2_em2, a0_a0_p3_p2_em2, (T)); \
    b0_p4_p2_em2 = linear(b0_b0_p4_p2_em2, a0_b0_p4_p2_em2, (T)); \
    a0_p4_p2_em2 = linear(b0_a0_p4_p2_em2, a0_a0_p4_p2_em2, (T)); \
    b0_b0_p3_em2 = linear(b0_b0_b0_p3_em2, a0_b0_b0_p3_em2, (T)); \
    a0_b0_p3_em2 = linear(b0_a0_b0_p3_em2, a0_a0_b0_p3_em2, (T)); \
    b0_a0_p3_em2 = linear(b0_b0_a0_p3_em2, a0_b0_a0_p3_em2, (T)); \
    a0_a0_p3_em2 = linear(b0_a0_a0_p3_em2, a0_a0_a0_p3_em2, (T)); \
    b0_a1_p3_em2 = linear(b0_b0_a1_p3_em2, a0_b0_a1_p3_em2, (T)); \
    a0_a1_p3_em2 = linear(b0_a0_a1_p3_em2, a0_a0_a1_p3_em2, (T)); \
    b0_a2_p3_em2 = linear(b0_b0_a2_p3_em2, a0_b0_a2_p3_em2, (T)); \
    a0_a2_p3_em2 = linear(b0_a0_a2_p3_em2, a0_a0_a2_p3_em2, (T)); \
    b0_a3_p3_em2 = linear(b0_b0_a3_p3_em2, a0_b0_a3_p3_em2, (T)); \
    a0_a3_p3_em2 = linear(b0_a0_a3_p3_em2, a0_a0_a3_p3_em2, (T)); \
    b0_a4_p3_em2 = linear(b0_b0_a4_p3_em2, a0_b0_a4_p3_em2, (T)); \
    a0_a4_p3_em2 = linear(b0_a0_a4_p3_em2, a0_a0_a4_p3_em2, (T)); \
    b0_p1_p3_em2 = linear(b0_b0_p1_p3_em2, a0_b0_p1_p3_em2, (T)); \
    a0_p1_p3_em2 = linear(b0_a0_p1_p3_em2, a0_a0_p1_p3_em2, (T)); \
    b0_p2_p3_em2 = linear(b0_b0_p2_p3_em2, a0_b0_p2_p3_em2, (T)); \
    a0_p2_p3_em2 = linear(b0_a0_p2_p3_em2, a0_a0_p2_p3_em2, (T)); \
    b0_p3_p3_em2 = linear(b0_b0_p3_p3_em2, a0_b0_p3_p3_em2, (T)); \
    a0_p3_p3_em2 = linear(b0_a0_p3_p3_em2, a0_a0_p3_p3_em2, (T)); \
    b0_p4_p3_em2 = linear(b0_b0_p4_p3_em2, a0_b0_p4_p3_em2, (T)); \
    a0_p4_p3_em2 = linear(b0_a0_p4_p3_em2, a0_a0_p4_p3_em2, (T)); \
    b0_b0_p4_em2 = linear(b0_b0_b0_p4_em2, a0_b0_b0_p4_em2, (T)); \
    a0_b0_p4_em2 = linear(b0_a0_b0_p4_em2, a0_a0_b0_p4_em2, (T)); \
    b0_a0_p4_em2 = linear(b0_b0_a0_p4_em2, a0_b0_a0_p4_em2, (T)); \
    a0_a0_p4_em2 = linear(b0_a0_a0_p4_em2, a0_a0_a0_p4_em2, (T)); \
    b0_a1_p4_em2 = linear(b0_b0_a1_p4_em2, a0_b0_a1_p4_em2, (T)); \
    a0_a1_p4_em2 = linear(b0_a0_a1_p4_em2, a0_a0_a1_p4_em2, (T)); \
    b0_a2_p4_em2 = linear(b0_b0_a2_p4_em2, a0_b0_a2_p4_em2, (T)); \
    a0_a2_p4_em2 = linear(b0_a0_a2_p4_em2, a0_a0_a2_p4_em2, (T)); \
    b0_a3_p4_em2 = linear(b0_b0_a3_p4_em2, a0_b0_a3_p4_em2, (T)); \
    a0_a3_p4_em2 = linear(b0_a0_a3_p4_em2, a0_a0_a3_p4_em2, (T)); \
    b0_a4_p4_em2 = linear(b0_b0_a4_p4_em2, a0_b0_a4_p4_em2, (T)); \
    a0_a4_p4_em2 = linear(b0_a0_a4_p4_em2, a0_a0_a4_p4_em2, (T)); \
    b0_p1_p4_em2 = linear(b0_b0_p1_p4_em2, a0_b0_p1_p4_em2, (T)); \
    a0_p1_p4_em2 = linear(b0_a0_p1_p4_em2, a0_a0_p1_p4_em2, (T)); \
    b0_p2_p4_em2 = linear(b0_b0_p2_p4_em2, a0_b0_p2_p4_em2, (T)); \
    a0_p2_p4_em2 = linear(b0_a0_p2_p4_em2, a0_a0_p2_p4_em2, (T)); \
    b0_p3_p4_em2 = linear(b0_b0_p3_p4_em2, a0_b0_p3_p4_em2, (T)); \
    a0_p3_p4_em2 = linear(b0_a0_p3_p4_em2, a0_a0_p3_p4_em2, (T)); \
    b0_p4_p4_em2 = linear(b0_b0_p4_p4_em2, a0_b0_p4_p4_em2, (T)); \
    a0_p4_p4_em2 = linear(b0_a0_p4_p4_em2, a0_a0_p4_p4_em2, (T)); \
    b0_b0_em2    = linear(b0_b0_b0_em2,    a0_b0_b0_em2,    (VSubS)); \
    a0_b0_em2    = linear(b0_a0_b0_em2,    a0_a0_b0_em2,    (VSubS)); \
    a1_b0_em2    = linear(b0_a1_b0_em2,    a0_a1_b0_em2,    (VSubS)); \
    a2_b0_em2    = linear(b0_a2_b0_em2,    a0_a2_b0_em2,    (VSubS)); \
    a3_b0_em2    = linear(b0_a3_b0_em2,    a0_a3_b0_em2,    (VSubS)); \
    a4_b0_em2    = linear(b0_a4_b0_em2,    a0_a4_b0_em2,    (VSubS)); \
    p1_b0_em2    = linear(b0_p1_b0_em2,    a0_p1_b0_em2,    (VSubS)); \
    p2_b0_em2    = linear(b0_p2_b0_em2,    a0_p2_b0_em2,    (VSubS)); \
    p3_b0_em2    = linear(b0_p3_b0_em2,    a0_p3_b0_em2,    (VSubS)); \
    p4_b0_em2    = linear(b0_p4_b0_em2,    a0_p4_b0_em2,    (VSubS)); \
    b0_a0_em2    = linear(b0_b0_a0_em2,    a0_b0_a0_em2,    (VSubS)); \
    a0_a0_em2    = linear(b0_a0_a0_em2,    a0_a0_a0_em2,    (VSubS)); \
    a1_a0_em2    = linear(b0_a1_a0_em2,    a0_a1_a0_em2,    (VSubS)); \
    a2_a0_em2    = linear(b0_a2_a0_em2,    a0_a2_a0_em2,    (VSubS)); \
    a3_a0_em2    = linear(b0_a3_a0_em2,    a0_a3_a0_em2,    (VSubS)); \
    a4_a0_em2    = linear(b0_a4_a0_em2,    a0_a4_a0_em2,    (VSubS)); \
    p1_a0_em2    = linear(b0_p1_a0_em2,    a0_p1_a0_em2,    (VSubS)); \
    p2_a0_em2    = linear(b0_p2_a0_em2,    a0_p2_a0_em2,    (VSubS)); \
    p3_a0_em2    = linear(b0_p3_a0_em2,    a0_p3_a0_em2,    (VSubS)); \
    p4_a0_em2    = linear(b0_p4_a0_em2,    a0_p4_a0_em2,    (VSubS)); \
    b0_a1_em2    = linear(b0_b0_a1_em2,    a0_b0_a1_em2,    (VSubS)); \
    a0_a1_em2    = linear(b0_a0_a1_em2,    a0_a0_a1_em2,    (VSubS)); \
    a1_a1_em2    = linear(b0_a1_a1_em2,    a0_a1_a1_em2,    (VSubS)); \
    a2_a1_em2    = linear(b0_a2_a1_em2,    a0_a2_a1_em2,    (VSubS)); \
    a3_a1_em2    = linear(b0_a3_a1_em2,    a0_a3_a1_em2,    (VSubS)); \
    a4_a1_em2    = linear(b0_a4_a1_em2,    a0_a4_a1_em2,    (VSubS)); \
    p1_a1_em2    = linear(b0_p1_a1_em2,    a0_p1_a1_em2,    (VSubS)); \
    p2_a1_em2    = linear(b0_p2_a1_em2,    a0_p2_a1_em2,    (VSubS)); \
    p3_a1_em2    = linear(b0_p3_a1_em2,    a0_p3_a1_em2,    (VSubS)); \
    p4_a1_em2    = linear(b0_p4_a1_em2,    a0_p4_a1_em2,    (VSubS)); \
    b0_a2_em2    = linear(b0_b0_a2_em2,    a0_b0_a2_em2,    (VSubS)); \
    a0_a2_em2    = linear(b0_a0_a2_em2,    a0_a0_a2_em2,    (VSubS)); \
    a1_a2_em2    = linear(b0_a1_a2_em2,    a0_a1_a2_em2,    (VSubS)); \
    a2_a2_em2    = linear(b0_a2_a2_em2,    a0_a2_a2_em2,    (VSubS)); \
    a3_a2_em2    = linear(b0_a3_a2_em2,    a0_a3_a2_em2,    (VSubS)); \
    a4_a2_em2    = linear(b0_a4_a2_em2,    a0_a4_a2_em2,    (VSubS)); \
    p1_a2_em2    = linear(b0_p1_a2_em2,    a0_p1_a2_em2,    (VSubS)); \
    p2_a2_em2    = linear(b0_p2_a2_em2,    a0_p2_a2_em2,    (VSubS)); \
    p3_a2_em2    = linear(b0_p3_a2_em2,    a0_p3_a2_em2,    (VSubS)); \
    p4_a2_em2    = linear(b0_p4_a2_em2,    a0_p4_a2_em2,    (VSubS)); \
    b0_a3_em2    = linear(b0_b0_a3_em2,    a0_b0_a3_em2,    (VSubS)); \
    a0_a3_em2    = linear(b0_a0_a3_em2,    a0_a0_a3_em2,    (VSubS)); \
    a1_a3_em2    = linear(b0_a1_a3_em2,    a0_a1_a3_em2,    (VSubS)); \
    a2_a3_em2    = linear(b0_a2_a3_em2,    a0_a2_a3_em2,    (VSubS)); \
    a3_a3_em2    = linear(b0_a3_a3_em2,    a0_a3_a3_em2,    (VSubS)); \
    a4_a3_em2    = linear(b0_a4_a3_em2,    a0_a4_a3_em2,    (VSubS)); \
    p1_a3_em2    = linear(b0_p1_a3_em2,    a0_p1_a3_em2,    (VSubS)); \
    p2_a3_em2    = linear(b0_p2_a3_em2,    a0_p2_a3_em2,    (VSubS)); \
    p3_a3_em2    = linear(b0_p3_a3_em2,    a0_p3_a3_em2,    (VSubS)); \
    p4_a3_em2    = linear(b0_p4_a3_em2,    a0_p4_a3_em2,    (VSubS)); \
    b0_a4_em2    = linear(b0_b0_a4_em2,    a0_b0_a4_em2,    (VSubS)); \
    a0_a4_em2    = linear(b0_a0_a4_em2,    a0_a0_a4_em2,    (VSubS)); \
    a1_a4_em2    = linear(b0_a1_a4_em2,    a0_a1_a4_em2,    (VSubS)); \
    a2_a4_em2    = linear(b0_a2_a4_em2,    a0_a2_a4_em2,    (VSubS)); \
    a3_a4_em2    = linear(b0_a3_a4_em2,    a0_a3_a4_em2,    (VSubS)); \
    a4_a4_em2    = linear(b0_a4_a4_em2,    a0_a4_a4_em2,    (VSubS)); \
    p1_a4_em2    = linear(b0_p1_a4_em2,    a0_p1_a4_em2,    (VSubS)); \
    p2_a4_em2    = linear(b0_p2_a4_em2,    a0_p2_a4_em2,    (VSubS)); \
    p3_a4_em2    = linear(b0_p3_a4_em2,    a0_p3_a4_em2,    (VSubS)); \
    p4_a4_em2    = linear(b0_p4_a4_em2,    a0_p4_a4_em2,    (VSubS)); \
    b0_p1_em2    = linear(b0_b0_p1_em2,    a0_b0_p1_em2,    (VSubS)); \
    a0_p1_em2    = linear(b0_a0_p1_em2,    a0_a0_p1_em2,    (VSubS)); \
    a1_p1_em2    = linear(b0_a1_p1_em2,    a0_a1_p1_em2,    (VSubS)); \
    a2_p1_em2    = linear(b0_a2_p1_em2,    a0_a2_p1_em2,    (VSubS)); \
    a3_p1_em2    = linear(b0_a3_p1_em2,    a0_a3_p1_em2,    (VSubS)); \
    a4_p1_em2    = linear(b0_a4_p1_em2,    a0_a4_p1_em2,    (VSubS)); \
    p1_p1_em2    = linear(b0_p1_p1_em2,    a0_p1_p1_em2,    (VSubS)); \
    p2_p1_em2    = linear(b0_p2_p1_em2,    a0_p2_p1_em2,    (VSubS)); \
    p3_p1_em2    = linear(b0_p3_p1_em2,    a0_p3_p1_em2,    (VSubS)); \
    p4_p1_em2    = linear(b0_p4_p1_em2,    a0_p4_p1_em2,    (VSubS)); \
    b0_p2_em2    = linear(b0_b0_p2_em2,    a0_b0_p2_em2,    (VSubS)); \
    a0_p2_em2    = linear(b0_a0_p2_em2,    a0_a0_p2_em2,    (VSubS)); \
    a1_p2_em2    = linear(b0_a1_p2_em2,    a0_a1_p2_em2,    (VSubS)); \
    a2_p2_em2    = linear(b0_a2_p2_em2,    a0_a2_p2_em2,    (VSubS)); \
    a3_p2_em2    = linear(b0_a3_p2_em2,    a0_a3_p2_em2,    (VSubS)); \
    a4_p2_em2    = linear(b0_a4_p2_em2,    a0_a4_p2_em2,    (VSubS)); \
    p1_p2_em2    = linear(b0_p1_p2_em2,    a0_p1_p2_em2,    (VSubS)); \
    p2_p2_em2    = linear(b0_p2_p2_em2,    a0_p2_p2_em2,    (VSubS)); \
    p3_p2_em2    = linear(b0_p3_p2_em2,    a0_p3_p2_em2,    (VSubS)); \
    p4_p2_em2    = linear(b0_p4_p2_em2,    a0_p4_p2_em2,    (VSubS)); \
    b0_p3_em2    = linear(b0_b0_p3_em2,    a0_b0_p3_em2,    (VSubS)); \
    a0_p3_em2    = linear(b0_a0_p3_em2,    a0_a0_p3_em2,    (VSubS)); \
    a1_p3_em2    = linear(b0_a1_p3_em2,    a0_a1_p3_em2,    (VSubS)); \
    a2_p3_em2    = linear(b0_a2_p3_em2,    a0_a2_p3_em2,    (VSubS)); \
    a3_p3_em2    = linear(b0_a3_p3_em2,    a0_a3_p3_em2,    (VSubS)); \
    a4_p3_em2    = linear(b0_a4_p3_em2,    a0_a4_p3_em2,    (VSubS)); \
    p1_p3_em2    = linear(b0_p1_p3_em2,    a0_p1_p3_em2,    (VSubS)); \
    p2_p3_em2    = linear(b0_p2_p3_em2,    a0_p2_p3_em2,    (VSubS)); \
    p3_p3_em2    = linear(b0_p3_p3_em2,    a0_p3_p3_em2,    (VSubS)); \
    p4_p3_em2    = linear(b0_p4_p3_em2,    a0_p4_p3_em2,    (VSubS)); \
    b0_p4_em2    = linear(b0_b0_p4_em2,    a0_b0_p4_em2,    (VSubS)); \
    a0_p4_em2    = linear(b0_a0_p4_em2,    a0_a0_p4_em2,    (VSubS)); \
    a1_p4_em2    = linear(b0_a1_p4_em2,    a0_a1_p4_em2,    (VSubS)); \
    a2_p4_em2    = linear(b0_a2_p4_em2,    a0_a2_p4_em2,    (VSubS)); \
    a3_p4_em2    = linear(b0_a3_p4_em2,    a0_a3_p4_em2,    (VSubS)); \
    a4_p4_em2    = linear(b0_a4_p4_em2,    a0_a4_p4_em2,    (VSubS)); \
    p1_p4_em2    = linear(b0_p1_p4_em2,    a0_p1_p4_em2,    (VSubS)); \
    p2_p4_em2    = linear(b0_p2_p4_em2,    a0_p2_p4_em2,    (VSubS)); \
    p3_p4_em2    = linear(b0_p3_p4_em2,    a0_p3_p4_em2,    (VSubS)); \
    p4_p4_em2    = linear(b0_p4_p4_em2,    a0_p4_p4_em2,    (VSubS)); \
    b0_em2 = linear_5reg(b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2, p2_b0_em2, p3_b0_em2, p4_b0_em2, (VGS)); \
    a0_em2 = linear_5reg(b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2, a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, (VGS)); \
    a1_em2 = linear_5reg(b0_a1_em2, a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2, p3_a1_em2, p4_a1_em2, (VGS)); \
    a2_em2 = linear_5reg(b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2, a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, (VGS)); \
    a3_em2 = linear_5reg(b0_a3_em2, a0_a3_em2, a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2, p4_a3_em2, (VGS)); \
    a4_em2 = linear_5reg(b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2, p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, (VGS)); \
    p1_em2 = linear_5reg(b0_p1_em2, a0_p1_em2, a1_p1_em2, a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2, (VGS)); \
    p2_em2 = linear_5reg(b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2, p2_p2_em2, p3_p2_em2, p4_p2_em2, (VGS)); \
    p3_em2 = linear_5reg(b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2, a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, (VGS)); \
    p4_em2 = linear_5reg(b0_p4_em2, a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2, p3_p4_em2, p4_p4_em2, (VGS)); \
    em2    = linear_5reg(b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, (VDS));


module relimo_aging_nbti(d,g,s);
input d,g,s;
electrical d,g,s;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_nbti_aging_open_flag  = 0;
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
//parameter real        relimo_nh                    = 0.332;
//parameter real        relimo_vdd                   = 0.0;

parameter real        relimo_n                     = 1;
parameter real        relimo_intercept             = 1;
parameter real        relimo_c                     = 1;


// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage, delta_damage, last_delta_damage, delta_vth; 
   
// Start simulatoin
analog begin
	if(relimo_nbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vgs = -max(-vgs, -(vgs-vds));
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			vddtransistor = abs(vgs);
//			if(vgs <= 0 && abs(vgs) >= abs(vds) && abs(vds) <= relimo_nh*relimo_vdd) begin 
			if(vgs <= 0 && abs(vds) >= 0) begin 
                                if(vddtransistor==0) begin
					delta_damage = 0;
				end else begin
					delta_damage = relimo_intercept*pow(vddtransistor, relimo_c);
				end
			end else begin
				delta_damage = 0;
			end
//			$display ("%M, %e, %e, %e, %e", vddtransistor, delta_damage, vgs, vds);
			if($abstime>=relimo_aging_tstart) begin
				dt                = ($abstime - last_abstime);	
				last_abstime      = $abstime;			
				damage            = damage+dt/2*(delta_damage+last_delta_damage);
				last_delta_damage = delta_damage;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime   = $abstime;
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					//damage = damage*relimo_aging_time/(24*365.24)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature)); 
					damage = (damage)*relimo_aging_time/($abstime-relimo_aging_tstart);    
				end else begin
					damage = 0;
				end
			end else begin
				damage = delta_damage*relimo_aging_time;      
      			end
			//delta_vth = relimo_a_vth*pow(damage, relimo_n);
			delta_vth = damage;
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", delta_vth);
			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", relimo_n);
			
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);

			if(relimo_pbti_aging_open_flag == 0) begin
				$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", 0.0);
				$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0);
				$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);

				$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
				$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
				$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
			end
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage = (damage)*(relimo_aging_time)*(24*365.24)/($abstime-relimo_aging_tstart);     
			end else begin
				damage = 0;
      			end
			delta_vth = damage;
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", delta_vth);
			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", relimo_n);
			
			$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);

			if(relimo_pbti_aging_open_flag == 0) begin
				$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", 0.0);
				$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0);
				$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);

				$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
				$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
				$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
			end
		end
	end	
end
endmodule

module relimo_aging_pbti;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_technology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_nh                    = 0.332;
parameter real        relimo_vdd                   = 0.0;
parameter real        relimo_e                     = 1;
parameter real        relimo_n                     = 1;
parameter real        relimo_intercept             = 1;
parameter real        relimo_c                     = 1;
parameter real        relimo_kb                    = 1;
parameter real        relimo_a_vth                 = 1;
//parameter real        relimo_a_u0                  = 1;
//parameter real        relimo_a_rdsw                = 1;
//parameter real        relimo_a_vsat                = 1;

// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage, delta_damage, last_delta_damage, delta_vth; 
   
// Start simulatoin
analog begin
	if(relimo_pbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = $simprobe(relimo_probe_name, "vgs");
			vds = $simprobe(relimo_probe_name, "vds");
			vgs = max(vgs, vgs-vds);
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			vddtransistor = max(abs(vds), abs(vgs));
			
//			if(vgs >= 0 && abs(vgs) >= abs(vds) && abs(vds) <= relimo_nh*relimo_vdd) begin 
			if(vgs >= 0 && abs(vds) <= relimo_nh*relimo_vdd) begin 
                                if(vddtransistor==0) begin
					delta_damage = 0;
				end else begin
					delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
				end
			end else begin
				delta_damage = 0;
			end
			if($abstime>=relimo_aging_tstart) begin
				dt                = ($abstime - last_abstime);	
				last_abstime      = $abstime;			
				damage            = damage+dt/2*(delta_damage+last_delta_damage);
				last_delta_damage = delta_damage;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime   = $abstime;
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					damage = damage*relimo_aging_time/(24*365.24)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));     
				end else begin
					damage = 0;
				end
			end else begin
				damage = delta_damage*relimo_aging_time/(24*365.24)*exp(-1*relimo_e/relimo_kb/$temperature);      
      			end
			delta_vth = relimo_a_vth*pow(damage, relimo_n);
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);

			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", 0.0);

			$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);

			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", delta_vth);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);

			$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage = damage*relimo_aging_time/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));     
			end else begin
				damage = 0;
      			end
			delta_vth = relimo_a_vth*pow(damage, relimo_n);
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);

			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", 0.0);

			$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);

			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", delta_vth);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);

			$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
		end
	end	
end
endmodule

module relimo_aging_hci1(d,g,s);
input d,g,s;
electrical d,g,s;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
//parameter real        relimo_e                     = 0;
//parameter real        relimo_kb                    = 0;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;
parameter real        relimo_vgsCutoff             = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, vdsmax, vgsmax;
real delta_damage, last_delta_damage, damage;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real work;
   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_m + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage = 0;
			if (vddtransistor == 0) begin
				delta_damage = 0;
			end else begin
				if(relimo_vth > 0) begin
					if(vgs > relimo_vgsCutoff) begin
						work = 1;
					end else begin
						work = 0;
					end
					if(work == 1) begin 
						delta_damage = exp(relimo_intercept-relimo_c/relimo_n/vddtransistor);
					end
				end else begin
					if(vgs < relimo_vgsCutoff) begin
						work = 1;
					end else begin
						work = 0;
					end
					if(work == 1) begin 
						delta_damage = exp(relimo_intercept-relimo_c/relimo_n/vddtransistor);
						//delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
					end
				end
				
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage = damage + dt/2*(delta_damage + last_delta_damage);
				last_delta_damage = delta_damage;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					//damage = (damage_s+damage_d)*(relimo_aging_time/(24*365.24))/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
					damage = damage*relimo_aging_time/($abstime-relimo_aging_tstart);
				end else begin
					damage = 0;
				end
			end else begin
				//damage = delta_damage*relimo_aging_time/(24*365.24)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage = delta_damage*relimo_aging_time;
      			end
			delta_idsat = damage*pow(relimo_a_idsat,1/relimo_n);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
		
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage = damage*(relimo_aging_time)*(24*365.24)/($abstime-relimo_aging_tstart);
			end else begin
				damage = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = damage*pow(relimo_a_idsat,1/relimo_n);
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci2;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
//parameter real        relimo_nh                    = 0.332;
//parameter real        relimo_vdd                   = 1.0;
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
//parameter real        relimo_e                     = 0;
//parameter real        relimo_kb                    = 0;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 2;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage, delta_damage_d, delta_damage_s, damage_d, damage_s, last_delta_damage, damage;
real dt, last_abstime;  
real temp, temp1;
real delta_idsat;
real work;
   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = $simprobe(relimo_probe_name, "vgs");
			vds = $simprobe(relimo_probe_name, "vds");
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.

			id = abs($simprobe(relimo_probe_name, "id"));
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			if (vddtransistor == 0) begin
				delta_damage = 0;
			end else begin
				if(relimo_vth > 0) begin
					if(vgs >= 0 && abs(vds) >= 0.0) begin
						work = 1;
					end else begin
						work = 0;
					end
					if(work == 1 && relimo_function == 1 && abs(vds) > abs(vgs)) begin 
						delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
					end
					if(work == 1 && relimo_function == 2 && abs(vds) <= abs(vgs)) begin 
						delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
					end
				end else begin
					if(vgs <= 0 && abs(vds) >= 0.0) begin
						work = 1;
					end else begin
						work = 0;
					end
					if(work == 1 && relimo_function == 1 && abs(vds) > abs(vgs)) begin 
						delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
					end
					if(work == 1 && relimo_function == 2 && abs(vds) <= abs(vgs)) begin 
						delta_damage = exp(relimo_intercept-relimo_c/vddtransistor);
					end
				end
				
			end
			delta_damage = delta_damage;
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				if (id > 0) begin
					delta_damage_d = delta_damage;
					damage_d = damage_d + dt/2*(delta_damage + last_delta_damage);
				end else begin
					delta_damage_s = delta_damage;
					damage_s = damage_s + dt/2*(delta_damage + last_delta_damage);
				end
				last_delta_damage = delta_damage;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_vth < 0) begin
			temp = delta_damage_s;
			delta_damage_s = delta_damage_d;
			delta_damage_d = temp;
			temp = damage_s;
			damage_s = damage_d;
			damage_d = temp;
		end
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					//damage = (damage_s+damage_d)*(relimo_aging_time/(24*365.24))/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
					damage = (damage_s+damage_d)*relimo_aging_time/($abstime-relimo_aging_tstart);
				end else begin
					damage = 0;
				end
			end else begin
				//damage = delta_damage*relimo_aging_time/(24*365.24)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage = delta_damage*relimo_aging_time;
      			end
			//delta_idsat = 10*pow((damage*(1/relimo_a_idsat)*pow(r,-m)), (1/relimo_n));
			delta_idsat = damage*(1/relimo_a_idsat)*pow(relimo_r,-relimo_m);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage = (damage_s+damage_d)*(relimo_aging_time)*(24*365.24)/($abstime-relimo_aging_tstart);
			end else begin
				damage = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = damage*(1/relimo_a_idsat)*pow(relimo_r,-relimo_m);
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 24300 ;
parameter real a0_b0_b0_a1_em = -9.46 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -51400 ;
parameter real a0_b0_a1_a1_em = 51.3 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3760 ;
parameter real a0_b0_a2_a1_em = 16.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -9450 ;
parameter real a0_b0_a3_a1_em = 3.73 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.447 ;
parameter real a0_b0_p1_a1_em = -0.000712 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 0.531 ;
parameter real a0_b0_p2_a1_em = -8.20E-07 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 2.3 ;
parameter real a0_b0_p3_a1_em = -0.00126 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 2.95 ;
parameter real a0_b0_p4_a1_em = -7.95E-05 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 11300 ;
parameter real a0_b0_b0_a2_em = -2.26 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -12900 ;
parameter real a0_b0_a1_a2_em = 10.6 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 2300 ;
parameter real a0_b0_a2_a2_em = -4.02 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5210 ;
parameter real a0_b0_a3_a2_em = 2.19 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.709 ;
parameter real a0_b0_p1_a2_em = -0.000898 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 0.416 ;
parameter real a0_b0_p2_a2_em = 0.000245 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 0.788 ;
parameter real a0_b0_p3_a2_em = 0.00232 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.69 ;
parameter real a0_b0_p4_a2_em = 0.000118 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 4030 ;
parameter real a0_b0_b0_a3_em = 0.967 ;
parameter real b0_a0_b0_a3_em = 23.9 ;
parameter real a0_a0_b0_a3_em = -0.0269 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1610 ;
parameter real a0_b0_a1_a3_em = 21.2 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1220 ;
parameter real a0_b0_a2_a3_em = -8.18 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -6040 ;
parameter real a0_b0_a3_a3_em = 5.4 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0.778 ;
parameter real a0_b0_p2_a3_em = -0.00101 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.36 ;
parameter real a0_b0_p3_a3_em = -0.00189 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 4010 ;
parameter real a0_b0_b0_a4_em = 0.0686 ;
parameter real b0_a0_b0_a4_em = -5.13 ;
parameter real a0_a0_b0_a4_em = 0.0232 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -6620 ;
parameter real a0_b0_a1_a4_em = 28.3 ;
parameter real b0_a0_a1_a4_em = 0 ;
parameter real a0_a0_a1_a4_em = 0 ;
parameter real b0_b0_a2_a4_em = -17600 ;
parameter real a0_b0_a2_a4_em = 22 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0 ;
parameter real b0_b0_a3_a4_em = 1500 ;
parameter real a0_b0_a3_a4_em = -2.56 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0 ;
parameter real a0_b0_p1_a4_em = 0 ;
parameter real b0_a0_p1_a4_em = 0 ;
parameter real a0_a0_p1_a4_em = 0 ;
parameter real b0_b0_p2_a4_em = 2.15 ;
parameter real a0_b0_p2_a4_em = -0.00289 ;
parameter real b0_a0_p2_a4_em = 0 ;
parameter real a0_a0_p2_a4_em = 0 ;
parameter real b0_b0_p3_a4_em = 1.54 ;
parameter real a0_b0_p3_a4_em = 0.000389 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 4.09 ;
parameter real a0_b0_p4_a4_em = -0.000378 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -2.91 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.858 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -1.96 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -7.53 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -9.72 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.45 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.25 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.93 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 9.25 ;
parameter real a0_b0_b0_p2_em = 0.0062 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0 ;
parameter real a0_b0_a1_p2_em = 0 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0 ;
parameter real a0_b0_a2_p2_em = 0 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 0 ;
parameter real a0_b0_a3_p2_em = 0 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 0 ;
parameter real a0_b0_p2_p2_em = 0 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 0 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 0 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 22 ;
parameter real a0_b0_b0_p3_em = 0 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 0 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 40.5 ;
parameter real a0_b0_b0_p4_em = -0.0089 ;
parameter real b0_a0_b0_p4_em = -0.0405 ;
parameter real a0_a0_b0_p4_em = 3.28E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 3.49 ;
parameter real a0_b0_a1_p4_em = -0.00724 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = -1.75 ;
parameter real a0_b0_a2_p4_em = 0.00419 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 1.39 ;
parameter real a0_b0_a3_p4_em = 0.000782 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.1 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 1.47 ;
parameter real a0_b0_p2_p4_em = -0.000691 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 6.09 ;
parameter real a0_b0_p3_p4_em = -0.0116 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 4 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;



parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_lamda0 = 8.06e-7;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_fstat1 = 0.00347;
parameter real        relimo_alpha1 = 1.35e-8;
parameter real        relimo_m1 = 1.77;
parameter real        relimo_Feb = 3.2;
parameter real        relimo_a1 = 0.773;
parameter real        relimo_a2 = 1.27;
parameter real        relimo_c1 = 3.71e5;
parameter real        relimo_fstat2 = 0.0133;
parameter real        relimo_alpha2 = 2.91E+11;
parameter real        relimo_beta2 = 3.44E-08;
parameter real        relimo_gama2 = 17.773;
parameter real        relimo_eps2 = 5.6824;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 1.4629;
parameter real        relimo_rth = 0.019243;
parameter real        relimo_n_hci3 = 0.389;
parameter real        relimo_a_hci3 = 283;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "id"));
			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, relimo_alpha2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*abs(V(sub)-V(s))), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 24300 ;
parameter real a0_b0_b0_a1_em = -9.46 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -51400 ;
parameter real a0_b0_a1_a1_em = 51.3 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3760 ;
parameter real a0_b0_a2_a1_em = 16.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -9450 ;
parameter real a0_b0_a3_a1_em = 3.73 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.447 ;
parameter real a0_b0_p1_a1_em = -0.000712 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 0.531 ;
parameter real a0_b0_p2_a1_em = -8.20E-07 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 2.3 ;
parameter real a0_b0_p3_a1_em = -0.00126 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 2.95 ;
parameter real a0_b0_p4_a1_em = -7.95E-05 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 11300 ;
parameter real a0_b0_b0_a2_em = -2.26 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -12900 ;
parameter real a0_b0_a1_a2_em = 10.6 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 2300 ;
parameter real a0_b0_a2_a2_em = -4.02 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5210 ;
parameter real a0_b0_a3_a2_em = 2.19 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.709 ;
parameter real a0_b0_p1_a2_em = -0.000898 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 0.416 ;
parameter real a0_b0_p2_a2_em = 0.000245 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 0.788 ;
parameter real a0_b0_p3_a2_em = 0.00232 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.69 ;
parameter real a0_b0_p4_a2_em = 0.000118 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 4030 ;
parameter real a0_b0_b0_a3_em = 0.967 ;
parameter real b0_a0_b0_a3_em = 23.9 ;
parameter real a0_a0_b0_a3_em = -0.0269 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1610 ;
parameter real a0_b0_a1_a3_em = 21.2 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1220 ;
parameter real a0_b0_a2_a3_em = -8.18 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -6040 ;
parameter real a0_b0_a3_a3_em = 5.4 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0.778 ;
parameter real a0_b0_p2_a3_em = -0.00101 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.36 ;
parameter real a0_b0_p3_a3_em = -0.00189 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 4010 ;
parameter real a0_b0_b0_a4_em = 0.0686 ;
parameter real b0_a0_b0_a4_em = -5.13 ;
parameter real a0_a0_b0_a4_em = 0.0232 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -6620 ;
parameter real a0_b0_a1_a4_em = 28.3 ;
parameter real b0_a0_a1_a4_em = 0 ;
parameter real a0_a0_a1_a4_em = 0 ;
parameter real b0_b0_a2_a4_em = -17600 ;
parameter real a0_b0_a2_a4_em = 22 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0 ;
parameter real b0_b0_a3_a4_em = 1500 ;
parameter real a0_b0_a3_a4_em = -2.56 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0 ;
parameter real a0_b0_p1_a4_em = 0 ;
parameter real b0_a0_p1_a4_em = 0 ;
parameter real a0_a0_p1_a4_em = 0 ;
parameter real b0_b0_p2_a4_em = 2.15 ;
parameter real a0_b0_p2_a4_em = -0.00289 ;
parameter real b0_a0_p2_a4_em = 0 ;
parameter real a0_a0_p2_a4_em = 0 ;
parameter real b0_b0_p3_a4_em = 1.54 ;
parameter real a0_b0_p3_a4_em = 0.000389 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 4.09 ;
parameter real a0_b0_p4_a4_em = -0.000378 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -2.91 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.858 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -1.96 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -7.53 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -9.72 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.45 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.25 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.93 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 9.25 ;
parameter real a0_b0_b0_p2_em = 0.0062 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0 ;
parameter real a0_b0_a1_p2_em = 0 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0 ;
parameter real a0_b0_a2_p2_em = 0 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 0 ;
parameter real a0_b0_a3_p2_em = 0 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 0 ;
parameter real a0_b0_p2_p2_em = 0 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 0 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 0 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 22 ;
parameter real a0_b0_b0_p3_em = 0 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 0 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 40.5 ;
parameter real a0_b0_b0_p4_em = -0.0089 ;
parameter real b0_a0_b0_p4_em = -0.0405 ;
parameter real a0_a0_b0_p4_em = 3.28E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 3.49 ;
parameter real a0_b0_a1_p4_em = -0.00724 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = -1.75 ;
parameter real a0_b0_a2_p4_em = 0.00419 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 1.39 ;
parameter real a0_b0_a3_p4_em = 0.000782 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.1 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 1.47 ;
parameter real a0_b0_p2_p4_em = -0.000691 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 6.09 ;
parameter real a0_b0_p3_p4_em = -0.0116 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 4 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;



parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_lamda0 = 8.06e-7;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_fstat1 = 0.00347;
parameter real        relimo_alpha1 = 1.35e-8;
parameter real        relimo_m1 = 1.77;
parameter real        relimo_Feb = 3.2;
parameter real        relimo_a1 = 0.773;
parameter real        relimo_a2 = 1.27;
parameter real        relimo_c1 = 3.71e5;
parameter real        relimo_fstat2 = 0.0133;
parameter real        relimo_alpha2 = 2.91E+11;
parameter real        relimo_beta2 = 3.44E-08;
parameter real        relimo_gama2 = 17.773;
parameter real        relimo_eps2 = 5.6824;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 1.4629;
parameter real        relimo_rth = 0.019243;
parameter real        relimo_n_hci3 = 0.389;
parameter real        relimo_a_hci3 = 283;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = $simprobe("mpowermosb", "ide");
			id = abs(id1+id2*0);

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, relimo_alpha2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*abs(V(sub)-V(s))), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule



module relimo_aging_hci_nld45_he(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 44100 ;
parameter real a0_b0_b0_a1_em = -8.26 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -24200 ;
parameter real a0_b0_a1_a1_em = 12.7 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 44600 ;
parameter real a0_b0_a2_a1_em = -51.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 15600 ;
parameter real a0_b0_a3_a1_em = -114 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 1.83 ;
parameter real a0_b0_p1_a1_em = -0.00143 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 3.15 ;
parameter real a0_b0_p2_a1_em = -0.00119 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.41 ;
parameter real a0_b0_p3_a1_em = -0.000995 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.5 ;
parameter real a0_b0_p4_a1_em = -0.00265 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 12100 ;
parameter real a0_b0_b0_a2_em = 1.94 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 1300 ;
parameter real a0_b0_a1_a2_em = -1.82 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 1020 ;
parameter real a0_b0_a2_a2_em = 0.177 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5410 ;
parameter real a0_b0_a3_a2_em = 0.922 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -0.715 ;
parameter real a0_b0_p1_a2_em = -0.000869 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = -0.512 ;
parameter real a0_b0_p2_a2_em = 0.00359 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 1.15 ;
parameter real a0_b0_p3_a2_em = -3.68E-05 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 6230 ;
parameter real a0_b0_b0_a3_em = 2.16 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1640 ;
parameter real a0_b0_a1_a3_em = -13 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1.21 ;
parameter real a0_b0_a2_a3_em = 0.996 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -1530 ;
parameter real a0_b0_a3_a3_em = 2.84 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 1.35 ;
parameter real a0_b0_p1_a3_em = 0.000208 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2.56 ;
parameter real a0_b0_p2_a3_em = -0.000218 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = -0.81 ;
parameter real a0_b0_p3_a3_em = 0.00252 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2.56 ;
parameter real a0_b0_p4_a3_em = 0.00359 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2780 ;
parameter real a0_b0_b0_a4_em = 2.16 ;
parameter real b0_a0_b0_a4_em = 0.277 ;
parameter real a0_a0_b0_a4_em = 0.0148 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 25700 ;
parameter real a0_b0_a1_a4_em = -30 ;
parameter real b0_a0_a1_a4_em = -0.177 ;
parameter real a0_a0_a1_a4_em = -0.024 ;
parameter real b0_b0_a2_a4_em = -346 ;
parameter real a0_b0_a2_a4_em = -10.4 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0601 ;
parameter real b0_b0_a3_a4_em = -7.79 ;
parameter real a0_b0_a3_a4_em = -0.00113 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 2.48 ;
parameter real a0_b0_p1_a4_em = -0.000237 ;
parameter real b0_a0_p1_a4_em = 0.000614 ;
parameter real a0_a0_p1_a4_em = -2.39E-06 ;
parameter real b0_b0_p2_a4_em = 4.04 ;
parameter real a0_b0_p2_a4_em = 0.000126 ;
parameter real b0_a0_p2_a4_em = -0.00024 ;
parameter real a0_a0_p2_a4_em = 1.52E-06 ;
parameter real b0_b0_p3_a4_em = -39.8 ;
parameter real a0_b0_p3_a4_em = 0.197 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 5.65 ;
parameter real a0_b0_p4_a4_em = -0.000628 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -3.5 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 1.16 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 0 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 12.2 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.6 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.89 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 5.12 ;
parameter real a0_b0_b0_p2_em = 0.00286 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.798 ;
parameter real a0_b0_a1_p2_em = -0.000226 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 4.48 ;
parameter real a0_b0_a2_p2_em = 0.00529 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 37.1 ;
parameter real a0_b0_a3_p2_em = -0.0747 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.79 ;
parameter real a0_b0_p2_p2_em = -0.00123 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.51 ;
parameter real a0_b0_p3_p2_em = -0.000964 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2.38 ;
parameter real a0_b0_p4_p2_em = -0.000171 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 17.1 ;
parameter real a0_b0_b0_p3_em = -0.00513 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0.443 ;
parameter real a0_b0_a1_p3_em = -0.000315 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 14.3 ;
parameter real a0_b0_a2_p3_em = -0.0142 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -9.19 ;
parameter real a0_b0_a3_p3_em = 0.0304 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 4.05 ;
parameter real a0_b0_p1_p3_em = -0.0118 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 1.18 ;
parameter real a0_b0_p2_p3_em = 0.00021 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 1.59 ;
parameter real a0_b0_p3_p3_em = -9.01E-05 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 2 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 32 ;
parameter real a0_b0_b0_p4_em = -0.0084 ;
parameter real b0_a0_b0_p4_em = 0.0545 ;
parameter real a0_a0_b0_p4_em = -7.63E-06 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 1.66 ;
parameter real a0_b0_a1_p4_em = -0.00388 ;
parameter real b0_a0_a1_p4_em = -0.0109 ;
parameter real a0_a0_a1_p4_em = 2.14E-05 ;
parameter real b0_b0_a2_p4_em = -25.6 ;
parameter real a0_b0_a2_p4_em = 0.0363 ;
parameter real b0_a0_a2_p4_em = 0.0775 ;
parameter real a0_a0_a2_p4_em = -0.000109 ;
parameter real b0_b0_a3_p4_em = 3.55 ;
parameter real a0_b0_a3_p4_em = 0.111 ;
parameter real b0_a0_a3_p4_em = 0.224 ;
parameter real a0_a0_a3_p4_em = -0.000755 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = -0.069 ;
parameter real a0_b0_p1_p4_em = -0.00169 ;
parameter real b0_a0_p1_p4_em = -0.0915 ;
parameter real a0_a0_p1_p4_em = 8.09E-05 ;
parameter real b0_b0_p2_p4_em = 2.55 ;
parameter real a0_b0_p2_p4_em = -0.000145 ;
parameter real b0_a0_p2_p4_em = -0.0127 ;
parameter real a0_a0_p2_p4_em = 2.64E-05 ;
parameter real b0_b0_p3_p4_em = 2.74 ;
parameter real a0_b0_p3_p4_em = -0.000499 ;
parameter real b0_a0_p3_p4_em = -6.82E-06 ;
parameter real a0_a0_p3_p4_em = -1.23E-06 ;
parameter real b0_b0_p4_p4_em = 3.25 ;
parameter real a0_b0_p4_p4_em = -0.00084 ;
parameter real b0_a0_p4_p4_em = 0.000639 ;
parameter real a0_a0_p4_p4_em = -9.65E-07 ;
   

parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_Feb = 3.2;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.637;
parameter real        relimo_a2 = 1.16;
parameter real        relimo_c1 = 1.21e5;
parameter real        relimo_alpha1 = 7.01e-15;
parameter real        relimo_m1 = 1.43;
parameter real        relimo_lamda0 = 2.10e-7;
parameter real        relimo_fstat1 = 0.00443;

parameter real        relimo_a_hci3 = 330;
parameter real        relimo_n_hci3 = 0.501;
parameter real        relimo_alpha2 = 1.41E+24;
parameter real        relimo_beta2 = 2.76E-14;
parameter real        relimo_gama2 = 17.4;
parameter real        relimo_eps2 = 9.53;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.61;
parameter real        relimo_rth = 2.25E-14;
parameter real        relimo_fstat2 = 0.0223;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter MULT in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b_he(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 44100 ;
parameter real a0_b0_b0_a1_em = -8.26 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -24200 ;
parameter real a0_b0_a1_a1_em = 12.7 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 44600 ;
parameter real a0_b0_a2_a1_em = -51.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 15600 ;
parameter real a0_b0_a3_a1_em = -114 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 1.83 ;
parameter real a0_b0_p1_a1_em = -0.00143 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 3.15 ;
parameter real a0_b0_p2_a1_em = -0.00119 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.41 ;
parameter real a0_b0_p3_a1_em = -0.000995 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.5 ;
parameter real a0_b0_p4_a1_em = -0.00265 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 12100 ;
parameter real a0_b0_b0_a2_em = 1.94 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 1300 ;
parameter real a0_b0_a1_a2_em = -1.82 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 1020 ;
parameter real a0_b0_a2_a2_em = 0.177 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5410 ;
parameter real a0_b0_a3_a2_em = 0.922 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -0.715 ;
parameter real a0_b0_p1_a2_em = -0.000869 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = -0.512 ;
parameter real a0_b0_p2_a2_em = 0.00359 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 1.15 ;
parameter real a0_b0_p3_a2_em = -3.68E-05 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 6230 ;
parameter real a0_b0_b0_a3_em = 2.16 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1640 ;
parameter real a0_b0_a1_a3_em = -13 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1.21 ;
parameter real a0_b0_a2_a3_em = 0.996 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -1530 ;
parameter real a0_b0_a3_a3_em = 2.84 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 1.35 ;
parameter real a0_b0_p1_a3_em = 0.000208 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2.56 ;
parameter real a0_b0_p2_a3_em = -0.000218 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = -0.81 ;
parameter real a0_b0_p3_a3_em = 0.00252 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2.56 ;
parameter real a0_b0_p4_a3_em = 0.00359 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2780 ;
parameter real a0_b0_b0_a4_em = 2.16 ;
parameter real b0_a0_b0_a4_em = 0.277 ;
parameter real a0_a0_b0_a4_em = 0.0148 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 25700 ;
parameter real a0_b0_a1_a4_em = -30 ;
parameter real b0_a0_a1_a4_em = -0.177 ;
parameter real a0_a0_a1_a4_em = -0.024 ;
parameter real b0_b0_a2_a4_em = -346 ;
parameter real a0_b0_a2_a4_em = -10.4 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0601 ;
parameter real b0_b0_a3_a4_em = -7.79 ;
parameter real a0_b0_a3_a4_em = -0.00113 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 2.48 ;
parameter real a0_b0_p1_a4_em = -0.000237 ;
parameter real b0_a0_p1_a4_em = 0.000614 ;
parameter real a0_a0_p1_a4_em = -2.39E-06 ;
parameter real b0_b0_p2_a4_em = 4.04 ;
parameter real a0_b0_p2_a4_em = 0.000126 ;
parameter real b0_a0_p2_a4_em = -0.00024 ;
parameter real a0_a0_p2_a4_em = 1.52E-06 ;
parameter real b0_b0_p3_a4_em = -39.8 ;
parameter real a0_b0_p3_a4_em = 0.197 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 5.65 ;
parameter real a0_b0_p4_a4_em = -0.000628 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -3.5 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 1.16 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 0 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 12.2 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.6 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.89 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 5.12 ;
parameter real a0_b0_b0_p2_em = 0.00286 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.798 ;
parameter real a0_b0_a1_p2_em = -0.000226 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 4.48 ;
parameter real a0_b0_a2_p2_em = 0.00529 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 37.1 ;
parameter real a0_b0_a3_p2_em = -0.0747 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.79 ;
parameter real a0_b0_p2_p2_em = -0.00123 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.51 ;
parameter real a0_b0_p3_p2_em = -0.000964 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2.38 ;
parameter real a0_b0_p4_p2_em = -0.000171 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 17.1 ;
parameter real a0_b0_b0_p3_em = -0.00513 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0.443 ;
parameter real a0_b0_a1_p3_em = -0.000315 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 14.3 ;
parameter real a0_b0_a2_p3_em = -0.0142 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -9.19 ;
parameter real a0_b0_a3_p3_em = 0.0304 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 4.05 ;
parameter real a0_b0_p1_p3_em = -0.0118 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 1.18 ;
parameter real a0_b0_p2_p3_em = 0.00021 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 1.59 ;
parameter real a0_b0_p3_p3_em = -9.01E-05 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 2 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 32 ;
parameter real a0_b0_b0_p4_em = -0.0084 ;
parameter real b0_a0_b0_p4_em = 0.0545 ;
parameter real a0_a0_b0_p4_em = -7.63E-06 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 1.66 ;
parameter real a0_b0_a1_p4_em = -0.00388 ;
parameter real b0_a0_a1_p4_em = -0.0109 ;
parameter real a0_a0_a1_p4_em = 2.14E-05 ;
parameter real b0_b0_a2_p4_em = -25.6 ;
parameter real a0_b0_a2_p4_em = 0.0363 ;
parameter real b0_a0_a2_p4_em = 0.0775 ;
parameter real a0_a0_a2_p4_em = -0.000109 ;
parameter real b0_b0_a3_p4_em = 3.55 ;
parameter real a0_b0_a3_p4_em = 0.111 ;
parameter real b0_a0_a3_p4_em = 0.224 ;
parameter real a0_a0_a3_p4_em = -0.000755 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = -0.069 ;
parameter real a0_b0_p1_p4_em = -0.00169 ;
parameter real b0_a0_p1_p4_em = -0.0915 ;
parameter real a0_a0_p1_p4_em = 8.09E-05 ;
parameter real b0_b0_p2_p4_em = 2.55 ;
parameter real a0_b0_p2_p4_em = -0.000145 ;
parameter real b0_a0_p2_p4_em = -0.0127 ;
parameter real a0_a0_p2_p4_em = 2.64E-05 ;
parameter real b0_b0_p3_p4_em = 2.74 ;
parameter real a0_b0_p3_p4_em = -0.000499 ;
parameter real b0_a0_p3_p4_em = -6.82E-06 ;
parameter real a0_a0_p3_p4_em = -1.23E-06 ;
parameter real b0_b0_p4_p4_em = 3.25 ;
parameter real a0_b0_p4_p4_em = -0.00084 ;
parameter real b0_a0_p4_p4_em = 0.000639 ;
parameter real a0_a0_p4_p4_em = -9.65E-07 ;
   

parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_Feb = 3.2;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.637;
parameter real        relimo_a2 = 1.16;
parameter real        relimo_c1 = 1.21e5;
parameter real        relimo_alpha1 = 7.01e-15;
parameter real        relimo_m1 = 1.43;
parameter real        relimo_lamda0 = 2.10e-7;
parameter real        relimo_fstat1 = 0.00443;

parameter real        relimo_a_hci3 = 330;
parameter real        relimo_n_hci3 = 0.501;
parameter real        relimo_alpha2 = 1.41E+24;
parameter real        relimo_beta2 = 2.76E-14;
parameter real        relimo_gama2 = 17.4;
parameter real        relimo_eps2 = 9.53;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.61;
parameter real        relimo_rth = 2.25E-14;
parameter real        relimo_fstat2 = 0.0223;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = $simprobe("mpowermosb", "ide");
			id = abs(id1+id2*0);

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter MULT in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule


module relimo_aging_hci_nld45_tlp(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 17400 ;
parameter real a0_b0_b0_a1_em = -3.27 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -1400 ;
parameter real a0_b0_a1_a1_em = 0.27 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 12000 ;
parameter real a0_b0_a2_a1_em = 26.4 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -2320 ;
parameter real a0_b0_a3_a1_em = -7.53 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -2.71 ;
parameter real a0_b0_p1_a1_em = -7.37E-06 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.03 ;
parameter real a0_b0_p2_a1_em = 0.000163 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 1.36 ;
parameter real a0_b0_p3_a1_em = 0.000102 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 5200 ;
parameter real a0_b0_b0_a2_em = 0 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 0 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 0 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 0 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 1 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 2 ;
parameter real a0_b0_p2_a2_em = 0 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 2480 ;
parameter real a0_b0_b0_a3_em = 0.502 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 634 ;
parameter real a0_b0_a1_a3_em = -17.6 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 25500 ;
parameter real a0_b0_a2_a3_em = -33.6 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -672 ;
parameter real a0_b0_a3_a3_em = -0.973 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.598 ;
parameter real a0_b0_p1_a3_em = 0.000857 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.28 ;
parameter real a0_b0_p2_a3_em = 8.13E-05 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.26 ;
parameter real a0_b0_p3_a3_em = 0.000714 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 5.83 ;
parameter real a0_b0_p4_a3_em = -0.00405 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 1040 ;
parameter real a0_b0_b0_a4_em = -0.0325 ;
parameter real b0_a0_b0_a4_em = 12.7 ;
parameter real a0_a0_b0_a4_em = -0.0121 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 5270 ;
parameter real a0_b0_a1_a4_em = -12.4 ;
parameter real b0_a0_a1_a4_em = 0.556 ;
parameter real a0_a0_a1_a4_em = 0.286 ;
parameter real b0_b0_a2_a4_em = -303 ;
parameter real a0_b0_a2_a4_em = 1.36 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00683 ;
parameter real b0_b0_a3_a4_em = 6350 ;
parameter real a0_b0_a3_a4_em = -6.57 ;
parameter real b0_a0_a3_a4_em = 17.6 ;
parameter real a0_a0_a3_a4_em = -0.0552 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0.545 ;
parameter real a0_b0_p1_a4_em = 1.09E-03 ;
parameter real b0_a0_p1_a4_em = 0.00483 ;
parameter real a0_a0_p1_a4_em = -2.32E-05 ;
parameter real b0_b0_p2_a4_em = 0.994 ;
parameter real a0_b0_p2_a4_em = 0.000526 ;
parameter real b0_a0_p2_a4_em = 6.02E-05 ;
parameter real a0_a0_p2_a4_em = -1.86E-05 ;
parameter real b0_b0_p3_a4_em = 3.16 ;
parameter real a0_b0_p3_a4_em = 1.19E-05 ;
parameter real b0_a0_p3_a4_em = 0.000843 ;
parameter real a0_a0_p3_a4_em = 3.55E-06 ;
parameter real b0_b0_p4_a4_em = 4.7 ;
parameter real a0_b0_p4_a4_em = -0.000241 ;
parameter real b0_a0_p4_a4_em = -0.00231 ;
parameter real a0_a0_p4_a4_em = 1.02E-05 ;
parameter real b0_b0_b0_p1_em = -4.68 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 17.2 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.159 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 1.41 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.08 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.43 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.01 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.3 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 6.78 ;
parameter real a0_b0_b0_p2_em = 0.00226 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 1.27 ;
parameter real a0_b0_a1_p2_em = -0.000307 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0.285 ;
parameter real a0_b0_a2_p2_em = -0.13 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 6.22 ;
parameter real a0_b0_a3_p2_em = -0.0235 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.36 ;
parameter real a0_b0_p2_p2_em = 5.54E-05 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 1.4 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 15.9 ;
parameter real a0_b0_b0_p3_em = 0.00466 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 3.95 ;
parameter real a0_b0_a1_p3_em = 0.0218 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = -9.77 ;
parameter real a0_b0_a2_p3_em = -0.0391 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -4.21 ;
parameter real a0_b0_a3_p3_em = -0.00335 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0.761 ;
parameter real a0_b0_p1_p3_em = 0.00122 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.1 ;
parameter real a0_b0_p2_p3_em = 1.16E-05 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 2.82 ;
parameter real a0_b0_p3_p3_em = -0.000961 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 3.16 ;
parameter real a0_b0_p4_p3_em = 0.00349 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 28.4 ;
parameter real a0_b0_b0_p4_em = 0.0078 ;
parameter real b0_a0_b0_p4_em = 0.27 ;
parameter real a0_a0_b0_p4_em = -0.000461 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 4.74 ;
parameter real a0_b0_a1_p4_em = -0.0104 ;
parameter real b0_a0_a1_p4_em = -0.0955 ;
parameter real a0_a0_a1_p4_em = 0.000172 ;
parameter real b0_b0_a2_p4_em = -30.8 ;
parameter real a0_b0_a2_p4_em = 0.0767 ;
parameter real b0_a0_a2_p4_em = 0.452 ;
parameter real a0_a0_a2_p4_em = -0.00128 ;
parameter real b0_b0_a3_p4_em = 91.8 ;
parameter real a0_b0_a3_p4_em = 0.0253 ;
parameter real b0_a0_a3_p4_em = 1.83 ;
parameter real a0_a0_a3_p4_em = -0.00492 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.867 ;
parameter real a0_b0_p1_p4_em = -0.00466 ;
parameter real b0_a0_p1_p4_em = -0.196 ;
parameter real a0_a0_p1_p4_em = 0.000438 ;
parameter real b0_b0_p2_p4_em = 1.71 ;
parameter real a0_b0_p2_p4_em = -0.000729 ;
parameter real b0_a0_p2_p4_em = -0.0515 ;
parameter real a0_a0_p2_p4_em = 0.000102 ;
parameter real b0_b0_p3_p4_em = 2.95 ;
parameter real a0_b0_p3_p4_em = -9.66E-05 ;
parameter real b0_a0_p3_p4_em = 0.00906 ;
parameter real a0_a0_p3_p4_em = -2.63E-05 ;
parameter real b0_b0_p4_p4_em = 3.49 ;
parameter real a0_b0_p4_p4_em = -0.00113 ;
parameter real b0_a0_p4_p4_em = 0.00189 ;
parameter real a0_a0_p4_p4_em = -4.62E-06 ;
     
   


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.698;
parameter real        relimo_a2 = 1.38;
parameter real        relimo_c1 = 8.38e5;
parameter real        relimo_alpha1 = 5.27e-13;
parameter real        relimo_m1 = 1.07;
parameter real        relimo_lamda0 = 6.14e-7;
parameter real        relimo_fstat1 = 0.00254;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 351;
parameter real        relimo_n_hci3 = 0.419;
parameter real        relimo_alpha2 = 7.44E+19;
parameter real        relimo_beta2 = 4.68E-08;
parameter real        relimo_gama2 = 17.9;
parameter real        relimo_eps2 = 7.62;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.81;
parameter real        relimo_rth = 0.00571;
parameter real        relimo_fstat2 = 0.0146;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b_tlp(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 17400 ;
parameter real a0_b0_b0_a1_em = -3.27 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -1400 ;
parameter real a0_b0_a1_a1_em = 0.27 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 12000 ;
parameter real a0_b0_a2_a1_em = 26.4 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -2320 ;
parameter real a0_b0_a3_a1_em = -7.53 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -2.71 ;
parameter real a0_b0_p1_a1_em = -7.37E-06 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.03 ;
parameter real a0_b0_p2_a1_em = 0.000163 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 1.36 ;
parameter real a0_b0_p3_a1_em = 0.000102 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 5200 ;
parameter real a0_b0_b0_a2_em = 0 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 0 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 0 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 0 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 1 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 2 ;
parameter real a0_b0_p2_a2_em = 0 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 2480 ;
parameter real a0_b0_b0_a3_em = 0.502 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 634 ;
parameter real a0_b0_a1_a3_em = -17.6 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 25500 ;
parameter real a0_b0_a2_a3_em = -33.6 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -672 ;
parameter real a0_b0_a3_a3_em = -0.973 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.598 ;
parameter real a0_b0_p1_a3_em = 0.000857 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.28 ;
parameter real a0_b0_p2_a3_em = 8.13E-05 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.26 ;
parameter real a0_b0_p3_a3_em = 0.000714 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 5.83 ;
parameter real a0_b0_p4_a3_em = -0.00405 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 1040 ;
parameter real a0_b0_b0_a4_em = -0.0325 ;
parameter real b0_a0_b0_a4_em = 12.7 ;
parameter real a0_a0_b0_a4_em = -0.0121 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 5270 ;
parameter real a0_b0_a1_a4_em = -12.4 ;
parameter real b0_a0_a1_a4_em = 0.556 ;
parameter real a0_a0_a1_a4_em = 0.286 ;
parameter real b0_b0_a2_a4_em = -303 ;
parameter real a0_b0_a2_a4_em = 1.36 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00683 ;
parameter real b0_b0_a3_a4_em = 6350 ;
parameter real a0_b0_a3_a4_em = -6.57 ;
parameter real b0_a0_a3_a4_em = 17.6 ;
parameter real a0_a0_a3_a4_em = -0.0552 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0.545 ;
parameter real a0_b0_p1_a4_em = 1.09E-03 ;
parameter real b0_a0_p1_a4_em = 0.00483 ;
parameter real a0_a0_p1_a4_em = -2.32E-05 ;
parameter real b0_b0_p2_a4_em = 0.994 ;
parameter real a0_b0_p2_a4_em = 0.000526 ;
parameter real b0_a0_p2_a4_em = 6.02E-05 ;
parameter real a0_a0_p2_a4_em = -1.86E-05 ;
parameter real b0_b0_p3_a4_em = 3.16 ;
parameter real a0_b0_p3_a4_em = 1.19E-05 ;
parameter real b0_a0_p3_a4_em = 0.000843 ;
parameter real a0_a0_p3_a4_em = 3.55E-06 ;
parameter real b0_b0_p4_a4_em = 4.7 ;
parameter real a0_b0_p4_a4_em = -0.000241 ;
parameter real b0_a0_p4_a4_em = -0.00231 ;
parameter real a0_a0_p4_a4_em = 1.02E-05 ;
parameter real b0_b0_b0_p1_em = -4.68 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 17.2 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.159 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 1.41 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.08 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.43 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.01 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.3 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 6.78 ;
parameter real a0_b0_b0_p2_em = 0.00226 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 1.27 ;
parameter real a0_b0_a1_p2_em = -0.000307 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0.285 ;
parameter real a0_b0_a2_p2_em = -0.13 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 6.22 ;
parameter real a0_b0_a3_p2_em = -0.0235 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.36 ;
parameter real a0_b0_p2_p2_em = 5.54E-05 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 1.4 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 15.9 ;
parameter real a0_b0_b0_p3_em = 0.00466 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 3.95 ;
parameter real a0_b0_a1_p3_em = 0.0218 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = -9.77 ;
parameter real a0_b0_a2_p3_em = -0.0391 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -4.21 ;
parameter real a0_b0_a3_p3_em = -0.00335 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0.761 ;
parameter real a0_b0_p1_p3_em = 0.00122 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.1 ;
parameter real a0_b0_p2_p3_em = 1.16E-05 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 2.82 ;
parameter real a0_b0_p3_p3_em = -0.000961 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 3.16 ;
parameter real a0_b0_p4_p3_em = 0.00349 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 28.4 ;
parameter real a0_b0_b0_p4_em = 0.0078 ;
parameter real b0_a0_b0_p4_em = 0.27 ;
parameter real a0_a0_b0_p4_em = -0.000461 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 4.74 ;
parameter real a0_b0_a1_p4_em = -0.0104 ;
parameter real b0_a0_a1_p4_em = -0.0955 ;
parameter real a0_a0_a1_p4_em = 0.000172 ;
parameter real b0_b0_a2_p4_em = -30.8 ;
parameter real a0_b0_a2_p4_em = 0.0767 ;
parameter real b0_a0_a2_p4_em = 0.452 ;
parameter real a0_a0_a2_p4_em = -0.00128 ;
parameter real b0_b0_a3_p4_em = 91.8 ;
parameter real a0_b0_a3_p4_em = 0.0253 ;
parameter real b0_a0_a3_p4_em = 1.83 ;
parameter real a0_a0_a3_p4_em = -0.00492 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.867 ;
parameter real a0_b0_p1_p4_em = -0.00466 ;
parameter real b0_a0_p1_p4_em = -0.196 ;
parameter real a0_a0_p1_p4_em = 0.000438 ;
parameter real b0_b0_p2_p4_em = 1.71 ;
parameter real a0_b0_p2_p4_em = -0.000729 ;
parameter real b0_a0_p2_p4_em = -0.0515 ;
parameter real a0_a0_p2_p4_em = 0.000102 ;
parameter real b0_b0_p3_p4_em = 2.95 ;
parameter real a0_b0_p3_p4_em = -9.66E-05 ;
parameter real b0_a0_p3_p4_em = 0.00906 ;
parameter real a0_a0_p3_p4_em = -2.63E-05 ;
parameter real b0_b0_p4_p4_em = 3.49 ;
parameter real a0_b0_p4_p4_em = -0.00113 ;
parameter real b0_a0_p4_p4_em = 0.00189 ;
parameter real a0_a0_p4_p4_em = -4.62E-06 ;
     
   


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.698;
parameter real        relimo_a2 = 1.38;
parameter real        relimo_c1 = 8.38e5;
parameter real        relimo_alpha1 = 5.27e-13;
parameter real        relimo_m1 = 1.07;
parameter real        relimo_lamda0 = 6.14e-7;
parameter real        relimo_fstat1 = 0.00254;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 351;
parameter real        relimo_n_hci3 = 0.419;
parameter real        relimo_alpha2 = 7.44E+19;
parameter real        relimo_beta2 = 4.68E-08;
parameter real        relimo_gama2 = 17.9;
parameter real        relimo_eps2 = 7.62;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.81;
parameter real        relimo_rth = 0.00571;
parameter real        relimo_fstat2 = 0.0146;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = $simprobe("mpowermosb", "ide");
			id = abs(id1+id2*0);

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
			
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule


module relimo_aging_hci_nld30b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 14100 ;
parameter real a0_b0_b0_a1_em = -2.74 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = -0.004 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -2930 ;
parameter real a0_b0_a1_a1_em = -1.28 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3670 ;
parameter real a0_b0_a2_a1_em = -4.21 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -4750 ;
parameter real a0_b0_a3_a1_em = 2.8 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.815 ;
parameter real a0_b0_p1_a1_em = 6.05E-04 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 2.05 ;
parameter real a0_b0_p2_a1_em = 0.000903 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 2.92 ;
parameter real a0_b0_p3_a1_em = -0.000182 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 3.7 ;
parameter real a0_b0_p4_a1_em = 0 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 8500 ;
parameter real a0_b0_b0_a2_em = 0.5 ;
parameter real b0_a0_b0_a2_em = 3.55 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0.0005 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 933 ;
parameter real a0_b0_a1_a2_em = 0.0005 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = -3000 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -2000 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -1 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 0.3 ;
parameter real a0_b0_p2_a2_em = 0.0005 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 1.7 ;
parameter real a0_b0_p3_a2_em = 5.00E-04 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 6000 ;
parameter real a0_b0_b0_a3_em = 4 ;
parameter real b0_a0_b0_a3_em = 3.55 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 0 ;
parameter real a0_b0_a1_a3_em = 0 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -6000 ;
parameter real a0_b0_a2_a3_em = 0 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = 0 ;
parameter real a0_b0_a3_a3_em = 0 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = -1 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.8 ;
parameter real a0_b0_p2_a3_em = 0.00E+00 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 2.5 ;
parameter real a0_b0_p3_a3_em = 0 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3.1 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 6000 ;
parameter real a0_b0_b0_a4_em = 10.7 ;
parameter real b0_a0_b0_a4_em = -0.0357 ;
parameter real a0_a0_b0_a4_em = -0.0155 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 0.51 ;
parameter real a0_b0_a1_a4_em = -0.354 ;
parameter real b0_a0_a1_a4_em = -0.594 ;
parameter real a0_a0_a1_a4_em = 0.00315 ;
parameter real b0_b0_a2_a4_em = -3 ;
parameter real a0_b0_a2_a4_em = -1.56 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.000627 ;
parameter real b0_b0_a3_a4_em = 9.16 ;
parameter real a0_b0_a3_a4_em = 2.71 ;
parameter real b0_a0_a3_a4_em = 0.408 ;
parameter real a0_a0_a3_a4_em = -0.0433 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = -15.8 ;
parameter real a0_b0_p1_a4_em = -2.82E-02 ;
parameter real b0_a0_p1_a4_em = -0.265 ;
parameter real a0_a0_p1_a4_em = 1.43E-03 ;
parameter real b0_b0_p2_a4_em = 1.37 ;
parameter real a0_b0_p2_a4_em = -0.00684 ;
parameter real b0_a0_p2_a4_em = 0.0618 ;
parameter real a0_a0_p2_a4_em = -2.31E-04 ;
parameter real b0_b0_p3_a4_em = 2.46 ;
parameter real a0_b0_p3_a4_em = 0.000591 ;
parameter real b0_a0_p3_a4_em = -0.046 ;
parameter real a0_a0_p3_a4_em = 1.80E-04 ;
parameter real b0_b0_p4_a4_em = 3.5 ;
parameter real a0_b0_p4_a4_em = 0.0073 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0.00E+00 ;
parameter real b0_b0_b0_p1_em = 3.63 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 1.5 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -2.94 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -9.23 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -0.6 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.47 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 3.7 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 20.5 ;
parameter real a0_b0_b0_p2_em = 0 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0 ;
parameter real a0_b0_a1_p2_em = 0 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0 ;
parameter real a0_b0_a2_p2_em = 0 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 0 ;
parameter real a0_b0_a3_p2_em = 0 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 0 ;
parameter real a0_b0_p2_p2_em = 0 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 0 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 0 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 25.4 ;
parameter real a0_b0_b0_p3_em = 0.0072 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 0 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 25.8 ;
parameter real a0_b0_b0_p4_em = 0.0172 ;
parameter real b0_a0_b0_p4_em = 0.0279 ;
parameter real a0_a0_b0_p4_em = -2.33E-04 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 0 ;
parameter real a0_b0_a1_p4_em = 0 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = 0 ;
parameter real a0_b0_a2_p4_em = 0 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 0 ;
parameter real a0_b0_a3_p4_em = 0 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 0 ;
parameter real a0_b0_p2_p4_em = 0 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 0 ;
parameter real a0_b0_p3_p4_em = 0 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 0 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;     
   


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.835;
parameter real        relimo_a2 = 0.982;
parameter real        relimo_c1 = 7.63e3;
parameter real        relimo_alpha1 = 9.36e-11;
parameter real        relimo_m1 = 2.03;
parameter real        relimo_lamda0 = 5.96e-7;
parameter real        relimo_fstat1 = 0.00308;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 428.10;
parameter real        relimo_n_hci3 = 0.42;
parameter real        relimo_alpha2 = 6.8726632e20;
parameter real        relimo_beta2 = 5.4e-5;
parameter real        relimo_gama2 = 18.13;
parameter real        relimo_eps2 = 9.97;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.82;
parameter real        relimo_rth = 0.00952;
parameter real        relimo_fstat2 = 0.033855;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
        				//$display("Zhichen Debug 111 in device %e, %e, %e, %e,  %e, %e, %e, %e", relimo_intercept, relimo_c, relimo_a_idsat, relimo_m,relimo_e,relimo_intercept-relimo_c*vddtransistor,relimo_intercept,vddtransistor);
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
        			//$display("Parameter MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2);
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule


module relimo_aging_hci_nld65b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 12500 ;
parameter real a0_b0_b0_a1_em = -1.76 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = 740 ;
parameter real a0_b0_a1_a1_em = -3.88 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 3540 ;
parameter real a0_b0_a2_a1_em = -6.25 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -5450 ;
parameter real a0_b0_a3_a1_em = 6.53 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -2.01 ;
parameter real a0_b0_p1_a1_em = 0.00665 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.89 ;
parameter real a0_b0_p2_a1_em = -0.00137 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 4.93 ;
parameter real a0_b0_p3_a1_em = -0.00502 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 9610 ;
parameter real a0_b0_b0_a2_em = -11.6 ;
parameter real b0_a0_b0_a2_em = 10.1 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -1830 ;
parameter real a0_b0_a1_a2_em = 5.24 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 823 ;
parameter real a0_b0_a2_a2_em = 1.05 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -1660 ;
parameter real a0_b0_a3_a2_em = -1.95 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -0.29 ;
parameter real a0_b0_p1_a2_em = -0.00378 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 2.36 ;
parameter real a0_b0_p2_a2_em = -0.00521 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 2.17 ;
parameter real a0_b0_p3_a2_em = -0.0021 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 156 ;
parameter real a0_b0_b0_a3_em = 24.4 ;
parameter real b0_a0_b0_a3_em = 25 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1690 ;
parameter real a0_b0_a1_a3_em = -1.69 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 0.33 ;
parameter real a0_b0_a2_a3_em = 0.302 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -4020 ;
parameter real a0_b0_a3_a3_em = 0.0695 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = -0.413 ;
parameter real a0_b0_p1_a3_em = -0.00101 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.16 ;
parameter real a0_b0_p2_a3_em = -0.00153 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.88 ;
parameter real a0_b0_p3_a3_em = -0.0035 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3.1 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 1690 ;
parameter real a0_b0_b0_a4_em = 1.24 ;
parameter real b0_a0_b0_a4_em = 0.583 ;
parameter real a0_a0_b0_a4_em = 0.0392 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -111 ;
parameter real a0_b0_a1_a4_em = 0.778 ;
parameter real b0_a0_a1_a4_em = 0.587 ;
parameter real a0_a0_a1_a4_em = 0.0311 ;
parameter real b0_b0_a2_a4_em = -1830 ;
parameter real a0_b0_a2_a4_em = 3.04 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0019 ;
parameter real b0_b0_a3_a4_em = -205 ;
parameter real a0_b0_a3_a4_em = 8.19 ;
parameter real b0_a0_a3_a4_em = 0.00514 ;
parameter real a0_a0_a3_a4_em = -0.0249 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = -5.6 ;
parameter real a0_b0_p1_a4_em = 0.0109 ;
parameter real b0_a0_p1_a4_em = 0.055 ;
parameter real a0_a0_p1_a4_em = -5.47E-05 ;
parameter real b0_b0_p2_a4_em = 2.32 ;
parameter real a0_b0_p2_a4_em = -0.00363 ;
parameter real b0_a0_p2_a4_em = -0.0314 ;
parameter real a0_a0_p2_a4_em = 8.40E-05 ;
parameter real b0_b0_p3_a4_em = 1.67 ;
parameter real a0_b0_p3_a4_em = 0.00271 ;
parameter real b0_a0_p3_a4_em = -0.00569 ;
parameter real a0_a0_p3_a4_em = 3.25E-05 ;
parameter real b0_b0_p4_a4_em = 4.77 ;
parameter real a0_b0_p4_a4_em = -0.00147 ;
parameter real b0_a0_p4_a4_em = 0.00822 ;
parameter real a0_a0_p4_a4_em = -1.44E-05 ;
parameter real b0_b0_b0_p1_em = 1.67 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.524 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 3.49 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 11.6 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.48 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 3.27 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 3.81 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 20.5 ;
parameter real a0_b0_b0_p2_em = 0.0101 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 2.86 ;
parameter real a0_b0_a1_p2_em = -0.00763 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = -7 ;
parameter real a0_b0_a2_p2_em = 0.0136 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 3.64 ;
parameter real a0_b0_a3_p2_em = 0.0153 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 0.975 ;
parameter real a0_b0_p2_p2_em = 0.00158 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 3.07 ;
parameter real a0_b0_p3_p2_em = -0.000216 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 4.49 ;
parameter real a0_b0_p4_p2_em = -0.00132 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 35.1 ;
parameter real a0_b0_b0_p3_em = 0.00167 ;
parameter real b0_a0_b0_p3_em = 0.1 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = -3.61 ;
parameter real a0_b0_a1_p3_em = -0.00246 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0.567 ;
parameter real a0_b0_a2_p3_em = 0.0088 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -7.07 ;
parameter real a0_b0_a3_p3_em = 0.0274 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 5.27 ;
parameter real a0_b0_p1_p3_em = -0.00953 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 3.94 ;
parameter real a0_b0_p2_p3_em = -0.00176 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 7.09 ;
parameter real a0_b0_p3_p3_em = -0.0154 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 4.01 ;
parameter real a0_b0_p4_p3_em = 0.000286 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 39 ;
parameter real a0_b0_b0_p4_em = -0.00378 ;
parameter real b0_a0_b0_p4_em = 0.136 ;
parameter real a0_a0_b0_p4_em = -4.67E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 4.95 ;
parameter real a0_b0_a1_p4_em = -0.0139 ;
parameter real b0_a0_a1_p4_em = -0.0295 ;
parameter real a0_a0_a1_p4_em = 4.85E-05 ;
parameter real b0_b0_a2_p4_em = 4.77 ;
parameter real a0_b0_a2_p4_em = -0.0203 ;
parameter real b0_a0_a2_p4_em = -0.0575 ;
parameter real a0_a0_a2_p4_em = 0.000154 ;
parameter real b0_b0_a3_p4_em = 9.25 ;
parameter real a0_b0_a3_p4_em = 0.0477 ;
parameter real b0_a0_a3_p4_em = 0.161 ;
parameter real a0_a0_a3_p4_em = -0.000342 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 1.07 ;
parameter real a0_b0_p1_p4_em = -0.00175 ;
parameter real b0_a0_p1_p4_em = -0.00381 ;
parameter real a0_a0_p1_p4_em = -6.05E-06 ;
parameter real b0_b0_p2_p4_em = -0.68 ;
parameter real a0_b0_p2_p4_em = 0.00784 ;
parameter real b0_a0_p2_p4_em = 0.00449 ;
parameter real a0_a0_p2_p4_em = -4.46E-05 ;
parameter real b0_b0_p3_p4_em = 3.2 ;
parameter real a0_b0_p3_p4_em = -0.00137 ;
parameter real b0_a0_p3_p4_em = -0.00153 ;
parameter real a0_a0_p3_p4_em = 4.00E-06 ;
parameter real b0_b0_p4_p4_em = 3.38 ;
parameter real a0_b0_p4_p4_em = -0.000311 ;
parameter real b0_a0_p4_p4_em = -0.00355 ;
parameter real a0_a0_p4_p4_em = 1.40E-05 ;


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.767;
parameter real        relimo_a2 = 0.643;
parameter real        relimo_c1 = 1350;
parameter real        relimo_alpha1 = 7.51e-13;
parameter real        relimo_m1 = 0.993;
parameter real        relimo_lamda0 = 3.94e-7;
parameter real        relimo_fstat1 = 0.00368;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 305;
parameter real        relimo_n_hci3 = 0.459;
parameter real        relimo_alpha2 = 9.49e27;
parameter real        relimo_beta2 = 0.854;
parameter real        relimo_gama2 = 20.9;
parameter real        relimo_eps2 = 10.1;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.701;
parameter real        relimo_rth = 0.00283;
parameter real        relimo_fstat2 = 0.0696;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
        			//$display("Parameter MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2);
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule


module relimo_aging_hci_nmos45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.617e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 19300 ;
parameter real a0_b0_b0_a1_em = -6.46 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -2760 ;
parameter real a0_b0_a1_a1_em = -2.91 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -903 ;
parameter real a0_b0_a2_a1_em = -6.21 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 3210 ;
parameter real a0_b0_a3_a1_em = -2.66 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -0.671 ;
parameter real a0_b0_p1_a1_em = 0.00438 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 0.996 ;
parameter real a0_b0_p2_a1_em = -0.0113 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.66 ;
parameter real a0_b0_p3_a1_em = -0.00286 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 8000 ;
parameter real a0_b0_b0_a2_em = 0 ;
parameter real b0_a0_b0_a2_em = 8 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -1000 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 4000 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -1000 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.5 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 1.3 ;
parameter real a0_b0_p2_a2_em = 0 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 2.2 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 5180 ;
parameter real a0_b0_b0_a3_em = 0.868 ;
parameter real b0_a0_b0_a3_em = 23 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 2120 ;
parameter real a0_b0_a1_a3_em = -3 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -12000 ;
parameter real a0_b0_a2_a3_em = 14.5 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -4980 ;
parameter real a0_b0_a3_a3_em = 6.86 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.52 ;
parameter real a0_b0_p1_a3_em = -0.00333 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2.27 ;
parameter real a0_b0_p2_a3_em = -0.00177 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 2.4 ;
parameter real a0_b0_p3_a3_em = -0.000878 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 11100 ;
parameter real a0_b0_b0_a4_em = -45.2 ;
parameter real b0_a0_b0_a4_em = 19.2 ;
parameter real a0_a0_b0_a4_em = 0.261 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 266 ;
parameter real a0_b0_a1_a4_em = 0.0606 ;
parameter real b0_a0_a1_a4_em = 1.64 ;
parameter real a0_a0_a1_a4_em = -0.000585 ;
parameter real b0_b0_a2_a4_em = -487 ;
parameter real a0_b0_a2_a4_em = -0.656 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.0279 ;
parameter real b0_b0_a3_a4_em = 4640 ;
parameter real a0_b0_a3_a4_em = -14.8 ;
parameter real b0_a0_a3_a4_em = -1.58 ;
parameter real a0_a0_a3_a4_em = -0.192 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 25.2 ;
parameter real a0_b0_p1_a4_em = -0.158 ;
parameter real b0_a0_p1_a4_em = -0.0634 ;
parameter real a0_a0_p1_a4_em = 1.21E-03 ;
parameter real b0_b0_p2_a4_em = 1.52 ;
parameter real a0_b0_p2_a4_em = -0.00143 ;
parameter real b0_a0_p2_a4_em = 0.00124 ;
parameter real a0_a0_p2_a4_em = 8.71E-06 ;
parameter real b0_b0_p3_a4_em = 3.45 ;
parameter real a0_b0_p3_a4_em = -0.00301 ;
parameter real b0_a0_p3_a4_em = -0.058 ;
parameter real a0_a0_p3_a4_em = 2.02E-04 ;
parameter real b0_b0_p4_a4_em = 5.51 ;
parameter real a0_b0_p4_a4_em = -0.00666 ;
parameter real b0_a0_p4_a4_em = -0.0565 ;
parameter real a0_a0_p4_a4_em = 1.71E-04 ;
parameter real b0_b0_b0_p1_em = 7.64 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 4.46 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 0.416 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -4.63 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.29 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 3.87 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 4.5 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4.95 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 14.1 ;
parameter real a0_b0_b0_p2_em = 0.00339 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = -0.968 ;
parameter real a0_b0_a1_p2_em = -0.000562 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 5.35 ;
parameter real a0_b0_a2_p2_em = -0.00493 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -2.32 ;
parameter real a0_b0_a3_p2_em = 0.000692 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 2.44 ;
parameter real a0_b0_p2_p2_em = -0.00178 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 3.94 ;
parameter real a0_b0_p3_p2_em = 0.000322 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 5 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 25 ;
parameter real a0_b0_b0_p3_em = 0.00403 ;
parameter real b0_a0_b0_p3_em = 0.025 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = -2.38 ;
parameter real a0_b0_a1_p3_em = 0.00211 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = -0.0466 ;
parameter real a0_b0_a2_p3_em = 0.00887 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -0.549 ;
parameter real a0_b0_a3_p3_em = 0.00339 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 1.29 ;
parameter real a0_b0_p1_p3_em = -0.00555 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 1.19 ;
parameter real a0_b0_p2_p3_em = 0.00219 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 2.47 ;
parameter real a0_b0_p3_p3_em = 0.000299 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 10.6 ;
parameter real a0_b0_p4_p3_em = -0.0106 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 44.4 ;
parameter real a0_b0_b0_p4_em = 0.193 ;
parameter real b0_a0_b0_p4_em = -0.42 ;
parameter real a0_a0_b0_p4_em = -2.25E-03 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = -6.52 ;
parameter real a0_b0_a1_p4_em = 0.0035 ;
parameter real b0_a0_a1_p4_em = 0.0294 ;
parameter real a0_a0_a1_p4_em = -3.32E-05 ;
parameter real b0_b0_a2_p4_em = -21.7 ;
parameter real a0_b0_a2_p4_em = 0.0831 ;
parameter real b0_a0_a2_p4_em = 0.228 ;
parameter real a0_a0_a2_p4_em = -0.00112 ;
parameter real b0_b0_a3_p4_em = 12 ;
parameter real a0_b0_a3_p4_em = -0.0383 ;
parameter real b0_a0_a3_p4_em = -0.846 ;
parameter real a0_a0_a3_p4_em = 0.00382 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 1.83 ;
parameter real a0_b0_p1_p4_em = -0.0461 ;
parameter real b0_a0_p1_p4_em = 0.0572 ;
parameter real a0_a0_p1_p4_em = 4.77E-04 ;
parameter real b0_b0_p2_p4_em = 0.334 ;
parameter real a0_b0_p2_p4_em = 0.00275 ;
parameter real b0_a0_p2_p4_em = 0.0217 ;
parameter real a0_a0_p2_p4_em = -5.76E-05 ;
parameter real b0_b0_p3_p4_em = 2.22 ;
parameter real a0_b0_p3_p4_em = -0.00112 ;
parameter real b0_a0_p3_p4_em = -0.0193 ;
parameter real a0_a0_p3_p4_em = 1.10E-04 ;
parameter real b0_b0_p4_p4_em = 13 ;
parameter real a0_b0_p4_p4_em = -0.0286 ;
parameter real b0_a0_p4_p4_em = -0.177 ;
parameter real a0_a0_p4_p4_em = 5.21E-04 ;
     
   


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.325;
parameter real        relimo_a2 = 1.64;
parameter real        relimo_c1 = 495;
parameter real        relimo_alpha1 = 3.94e-11;
parameter real        relimo_m1 = 1.59;
parameter real        relimo_lamda0 = 4.71e-7;
parameter real        relimo_fstat1 = 0.00382;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.362;
parameter real        relimo_alpha2 = 4.59e29;
parameter real        relimo_beta2 = 4.39;
parameter real        relimo_gama2 = 10.7;
parameter real        relimo_eps2 = 8.2;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.733;
parameter real        relimo_rth = 0.00624;
parameter real        relimo_fstat2 = 0.0198;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1.0/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
        			//$display("Parameter MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2*relimo_fstat1);
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", pow(vgs,-1*relimo_gama2), pow(vds,-1*relimo_eps2), exp(-1*relimo_eta2*abs(V(sub)-V(s))), exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule




module relimo_aging_bti_pld30b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_nbti_aging_open_flag  = 0;
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld30b";
parameter string      relimo_probe_name            = "mpowermos";

parameter real        relimo_n_nbti                = 0.201;
parameter real        relimo_alpha_nbti            = 9.05e-4;
parameter real        relimo_m_nbti                = 14.8;
parameter real        relimo_e_nbti                = 0.844;
parameter real        relimo_fstat_nbti            = 0.0256;

parameter real        relimo_n_pbti                = 0.45;
parameter real        relimo_alpha_pbti            = 1.55e-7;
parameter real        relimo_m_pbti                = 10.1;
parameter real        relimo_e_pbti                = 1.44;
parameter real        relimo_fstat_pbti            = 0.0337;

parameter real        relimo_kb                    = 8.62e-5;


// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgsub, vgs, vds, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage_nbti, delta_damage_nbti, last_delta_damage_nbti; 
real damage_pbti, delta_damage_pbti, last_delta_damage_pbti; 
   
// Start simulatoin
analog begin
	if($abstime>=relimo_aging_tstart) begin
		dt                = ($abstime - last_abstime);	
		last_abstime      = $abstime;			
	end else begin
		last_abstime   = $abstime;
	end
	if(relimo_nbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vgs = -max(-vgs, -(vgs-vds));
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vgs < 0) begin 
				delta_damage_nbti = 1.0/(relimo_fstat_nbti*relimo_alpha_nbti)*pow(abs(vgs), relimo_m_nbti)*exp(-1*relimo_e_nbti/(relimo_kb*$temperature));
			end else begin
				delta_damage_nbti = 0;
			end
			//$display ("nbti %M, %e, %e, %e, %e, %e", V(g), V(s), vgs, V(d), delta_damage_nbti);
			if($abstime>=relimo_aging_tstart) begin
				damage_nbti       = damage_nbti+dt/2*(delta_damage_nbti+last_delta_damage_nbti);
				last_delta_damage_nbti = delta_damage_nbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	if(relimo_pbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgsub = V(g)-V(sub);
			if(vgsub < 0) begin 
				delta_damage_pbti = 0;
			end else begin
				delta_damage_pbti = 1.0/(relimo_fstat_pbti*relimo_alpha_pbti)*pow(abs(vgsub), relimo_m_pbti)*exp(-1*relimo_e_pbti/(relimo_kb*$temperature));
			end
			//$display ("pbti %M, %e, %e, %e, %e, %e", V(g), V(sub), vgsub, V(d), delta_damage_pbti);
			if($abstime>=relimo_aging_tstart) begin
				damage_pbti       = damage_pbti+dt/2*(delta_damage_pbti+last_delta_damage_pbti);
				last_delta_damage_pbti = delta_damage_pbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
			//$display ("DDDDD %M, %e, %e, %e, %e, %e", V(g), V(sub), vgsub, V(d), damage_pbti);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					damage_nbti = (damage_nbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
					damage_pbti = (damage_pbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
				end else begin
					damage_nbti = 0;
					damage_pbti = 0;
				end
			end else begin
				damage_nbti = delta_damage_nbti*relimo_aging_time*3600;      
				damage_pbti = delta_damage_pbti*relimo_aging_time*3600;      
      			end
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", damage_nbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", damage_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage_nbti = (damage_nbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
				damage_pbti = (damage_pbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
			end else begin
				damage_nbti = 0;
				damage_pbti = 0;
      			end
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", damage_nbti);
			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", damage_pbti);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
		end
	end	
end
endmodule


module relimo_aging_bti_pld45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_nbti_aging_open_flag  = 0;
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld45b";
parameter string      relimo_probe_name            = "mpowermos";

parameter real        relimo_n_nbti                = 0.201;
parameter real        relimo_alpha_nbti            = 1.18e-6;
parameter real        relimo_m_nbti                = 13.3;
parameter real        relimo_e_nbti                = 0.977;
parameter real        relimo_fstat_nbti            = 0.0165;

parameter real        relimo_n_pbti                = 0.355;
parameter real        relimo_alpha_pbti            = 1.14e-5;
parameter real        relimo_m_pbti                = 11.9;
parameter real        relimo_e_pbti                = 1.39;
parameter real        relimo_fstat_pbti            = 0.0143;

parameter real        relimo_kb                    = 8.62e-5;


// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgsub, vgs, vds, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage_nbti, delta_damage_nbti, last_delta_damage_nbti; 
real damage_pbti, delta_damage_pbti, last_delta_damage_pbti; 
   
// Start simulatoin
analog begin
	if($abstime>=relimo_aging_tstart) begin
		dt                = ($abstime - last_abstime);	
		last_abstime      = $abstime;			
	end else begin
		last_abstime   = $abstime;
	end
	if(relimo_nbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vgs = -max(-vgs, -(vgs-vds));
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vgs < 0) begin 
				delta_damage_nbti = 1.0/(relimo_fstat_nbti*relimo_alpha_nbti)*pow(abs(vgs), relimo_m_nbti)*exp(-1*relimo_e_nbti/(relimo_kb*$temperature));
			end else begin
				delta_damage_nbti = 0;
			end
			//$display ("%M, %e, %e, %e, %e, %e", V(g), V(s), vgs, V(d), relimo_e_nbti);
			if($abstime>=relimo_aging_tstart) begin
				damage_nbti       = damage_nbti+dt/2*(delta_damage_nbti+last_delta_damage_nbti);
				last_delta_damage_nbti = delta_damage_nbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	if(relimo_pbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgsub = V(g)-V(sub);
			if(vgsub < 0) begin 
				delta_damage_pbti = 0;
			end else begin
				delta_damage_pbti = 1.0/(relimo_fstat_pbti*relimo_alpha_pbti)*pow(abs(vgsub), relimo_m_pbti)*exp(-1*relimo_e_pbti/(relimo_kb*$temperature));
			end
			//$display ("sdfse %M, %e, %e, %e, %e, %e", V(g), V(sub), vgsub, V(d), delta_damage_pbti);
			if($abstime>=relimo_aging_tstart) begin
				damage_pbti       = damage_pbti+dt/2*(delta_damage_pbti+last_delta_damage_pbti);
				last_delta_damage_pbti = delta_damage_pbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
			//$display ("DDDDD %M, %e, %e, %e, %e, %e", V(g), V(sub), vgsub, V(d), damage_pbti);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					damage_nbti = (damage_nbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
					damage_pbti = (damage_pbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
				end else begin
					damage_nbti = 0;
					damage_pbti = 0;
				end
			end else begin
				damage_nbti = delta_damage_nbti*relimo_aging_time*3600;      
				damage_pbti = delta_damage_pbti*relimo_aging_time*3600;      
      			end
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", damage_nbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", damage_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage_nbti = (damage_nbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
				damage_pbti = (damage_pbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
			end else begin
				damage_nbti = 0;
				damage_pbti = 0;
      			end
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", damage_nbti);
			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", damage_pbti);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
		end
	end	
end
endmodule

module relimo_aging_bti(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_nbti_aging_open_flag  = 0;
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";

parameter real        relimo_n_nbti                = 0.201;
parameter real        relimo_alpha_nbti            = 2.43e-5;
parameter real        relimo_m_nbti                = 13.9;
parameter real        relimo_e_nbti                = 0.916;
parameter real        relimo_fstat_nbti            = 0.0159;

parameter real        relimo_n_pbti                = 0.442;
parameter real        relimo_alpha_pbti            = 1.62e-4;
parameter real        relimo_m_pbti                = 11.9;
parameter real        relimo_e_pbti                = 1.33;
parameter real        relimo_fstat_pbti            = 0.0084;

parameter real        relimo_kb                    = 8.62e-5;


// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgsub, vgs, vds, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage_nbti, delta_damage_nbti, last_delta_damage_nbti; 
real damage_pbti, delta_damage_pbti, last_delta_damage_pbti; 
   
// Start simulatoin
analog begin
	if($abstime>=relimo_aging_tstart) begin
		dt                = ($abstime - last_abstime);	
		last_abstime      = $abstime;			
	end else begin
		last_abstime   = $abstime;
	end
	if(relimo_nbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vgs = -max(-vgs, -(vgs-vds));
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vgs < 0) begin 
				delta_damage_nbti = 1.0/(relimo_fstat_nbti*relimo_alpha_nbti)*pow(abs(vgs), relimo_m_nbti)*exp(-1*relimo_e_nbti/(relimo_kb*$temperature));
			end else begin
				delta_damage_nbti = 0;
			end
			//$display ("%M, %e, %e, %e, %e, %e, %e, %e, %e", relimo_fstat_nbti, relimo_alpha_nbti, vgs, relimo_m_nbti, delta_damage_nbti,relimo_e_nbti,relimo_kb,$temperature);
			if($abstime>=relimo_aging_tstart) begin
				damage_nbti       = damage_nbti+dt/2*(delta_damage_nbti+last_delta_damage_nbti);
				last_delta_damage_nbti = delta_damage_nbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	if(relimo_pbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgsub = V(g)-V(sub);
			if(vgsub < 0) begin 
				delta_damage_pbti = 0;
			end else begin
				delta_damage_pbti = 1.0/(relimo_fstat_pbti*relimo_alpha_pbti)*pow(abs(vgsub), relimo_m_pbti)*exp(-1*relimo_e_pbti/(relimo_kb*$temperature));
			end
			//$display ("%M, %e, %e, %e, %e, %e, %e, %e, %e", V(g), V(sub), vgsub, relimo_m_pbti, delta_damage_pbti,relimo_e_pbti,relimo_kb,$temperature);
			if($abstime>=relimo_aging_tstart) begin
				damage_pbti       = damage_pbti+dt/2*(delta_damage_pbti+last_delta_damage_pbti);
				last_delta_damage_pbti = delta_damage_pbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
			//$display ("DDDDD %M, %e, %e, %e, %e, %e", V(g), (V(sub)-V(s)), vgsub, V(d), damage_pbti);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					damage_nbti = (damage_nbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
					damage_pbti = (damage_pbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
				end else begin
					damage_nbti = 0;
					damage_pbti = 0;
				end
			end else begin
				damage_nbti = delta_damage_nbti*relimo_aging_time*3600;      
				damage_pbti = delta_damage_pbti*relimo_aging_time*3600;      
      			end
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", damage_nbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", damage_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage_nbti = (damage_nbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
				damage_pbti = (damage_pbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
			end else begin
				damage_nbti = 0;
				damage_pbti = 0;
      			end
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", damage_nbti);
			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", damage_pbti);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
		end
	end	
end
endmodule



module relimo_aging_hv_hci_nld10(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "nld10";
parameter string      relimo_probe_name            = "mpowermos";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

  
parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 9280 ;
parameter real a0_b0_b0_a1_em = -0.997 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -764 ;
parameter real a0_b0_a1_a1_em = -4.63 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 114 ;
parameter real a0_b0_a2_a1_em = 0.297 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -7.38 ;
parameter real a0_b0_a3_a1_em = 5.62 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.312 ;
parameter real a0_b0_p1_a1_em = 0.000259 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 2.13 ;
parameter real a0_b0_p2_a1_em = -0.00128 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.7 ;
parameter real a0_b0_p3_a1_em = 0.00154 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 5 ;
parameter real a0_b0_p4_a1_em = 0 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 23000 ;
parameter real a0_b0_b0_a2_em = 10 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = -0.0002 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 9000 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = -12000 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 0 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.2 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 1.5 ;
parameter real a0_b0_p2_a2_em = -0.0002 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 2.5 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.5 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 25000 ;
parameter real a0_b0_b0_a3_em = 4 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 20000 ;
parameter real a0_b0_a1_a3_em = 0 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -20000 ;
parameter real a0_b0_a2_a3_em = 0 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = 0 ;
parameter real a0_b0_a3_a3_em = 0 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 1 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2 ;
parameter real a0_b0_p2_a3_em = 0 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 3 ;
parameter real a0_b0_p3_a3_em = 0 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 4 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 25200 ;
parameter real a0_b0_b0_a4_em = 1.2 ;
parameter real b0_a0_b0_a4_em = -0.518 ;
parameter real a0_a0_b0_a4_em = 0.00131 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 5640 ;
parameter real a0_b0_a1_a4_em = 3.84 ;
parameter real b0_a0_a1_a4_em = 0.55 ;
parameter real a0_a0_a1_a4_em = 0.00386 ;
parameter real b0_b0_a2_a4_em = -3610 ;
parameter real a0_b0_a2_a4_em = -0.156 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0005 ;
parameter real b0_b0_a3_a4_em = -6290 ;
parameter real a0_b0_a3_a4_em = -0.173 ;
parameter real b0_a0_a3_a4_em = 0.443 ;
parameter real a0_a0_a3_a4_em = 0.00313 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 1.6 ;
parameter real a0_b0_p1_a4_em = -0.000709 ;
parameter real b0_a0_p1_a4_em = -0.0000472 ;
parameter real a0_a0_p1_a4_em = 0.000000327 ;
parameter real b0_b0_p2_a4_em = 2.61 ;
parameter real a0_b0_p2_a4_em = -0.00147 ;
parameter real b0_a0_p2_a4_em = -0.000182 ;
parameter real a0_a0_p2_a4_em = 0.000000197 ;
parameter real b0_b0_p3_a4_em = 2.89 ;
parameter real a0_b0_p3_a4_em = 0.00348 ;
parameter real b0_a0_p3_a4_em = 0.00261 ;
parameter real a0_a0_p3_a4_em = -0.00000617 ;
parameter real b0_b0_p4_a4_em = 5.37 ;
parameter real a0_b0_p4_a4_em = -0.000432 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -7.4 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 2 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 0.01 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -1.1 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.34 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 2.1 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 3.57 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4.4 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 3.52 ;
parameter real a0_b0_b0_p2_em = 0.00158 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 1.7 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 1.44 ;
parameter real a0_b0_a1_p2_em = -0.00128 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0.521 ;
parameter real a0_b0_a2_p2_em = -0.00173 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -0.2 ;
parameter real a0_b0_a3_p2_em = 0.0000282 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.22 ;
parameter real a0_b0_p2_p2_em = 0.000915 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 3.86 ;
parameter real a0_b0_p3_p2_em = -0.00302 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 8.78 ;
parameter real a0_b0_p4_p2_em = -0.00821 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 72.6 ;
parameter real a0_b0_b0_p3_em = -0.287 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0.3 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 1.08 ;
parameter real a0_b0_a1_p3_em = -0.00000609 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0.782 ;
parameter real a0_b0_a2_p3_em = -0.00348 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -4.05 ;
parameter real a0_b0_a3_p3_em = 0.007 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 86.8 ;
parameter real a0_b0_p1_p3_em = -0.369 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.31 ;
parameter real a0_b0_p2_p3_em = 0.0000997 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 3.52 ;
parameter real a0_b0_p3_p3_em = 0.000709 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 3.65 ;
parameter real a0_b0_p4_p3_em = 0.00278 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 6.89 ;
parameter real a0_b0_b0_p4_em = 0.000237 ;
parameter real b0_a0_b0_p4_em = -0.000637 ;
parameter real a0_a0_b0_p4_em = 0.00000132 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 0 ;
parameter real a0_b0_a1_p4_em = 0 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = 0 ;
parameter real a0_b0_a2_p4_em = 0 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 0 ;
parameter real a0_b0_a3_p4_em = 0 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 0 ;
parameter real a0_b0_p2_p4_em = 0 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 0 ;
parameter real a0_b0_p3_p4_em = 0 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 0 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;
  

parameter real        relimo_k_hci1 = 8.14807e-2;
parameter real        relimo_n1_1_hci1 = 0.59;
parameter real        relimo_n2_1_hci1 = 0.5;

parameter real        relimo_a1 = 0.369;
parameter real        relimo_a2 = 1.15;
parameter real        relimo_c1 = 1.02e2;
parameter real        relimo_alpha1 = 1.42e-6;
parameter real        relimo_m1 = 1.59;
parameter real        relimo_lamda0 = 9.02e-7;
parameter real        relimo_fstat1 = 0.01;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 497;
parameter real        relimo_n_hci3 = 0.49;
parameter real        relimo_alpha2 = 3.36495059253878e11;
parameter real        relimo_beta2 = 5.27e-5;
parameter real        relimo_gama2 = 10.80;
parameter real        relimo_eps2 = 5.61;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.71;
parameter real        relimo_rth = 0.00912;
parameter real        relimo_fstat2 = 0.02;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage1_1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					if (((relimo_intercept-relimo_c*vddtransistor) > 490) || (-1*relimo_e/(relimo_kb*$temperature) > 490)) begin
						delta_damage1 = 0;
					end else begin
						delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
        					//$display("Zhichen Debug 111 %e, %e, %e, %e,  %e, %e, %e, %e", relimo_intercept, relimo_c, vddtransistor, delta_damage1,relimo_a_idsat,relimo_m,relimo_e,vddtransistor);
				        	//$display("Parameter MULT in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e", relimo_intercept, relimo_c, vddtransistor, relimo_a_idsat, relimo_m, relimo_e, relimo_kb, $temperature, delta_damage1, 1.0/delta_damage1);
					end
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s))) // High V HCI.
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					if (relimo_Feb/(em*lamda) > 490) begin
						delta_damage2 = 0;
					end else begin
						delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
					end
				end
        			//$display("Paramerer MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2);
				//$display("Parameter MULT in device %e, %e, %e, %e", delta_damage2, 1.0/delta_damage2, em, id);
				if(vds > 0 && vgs > 0) begin	// High Vgs HCI.
					if ((-1*relimo_eta2*V(sub) > 490) || (relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6)) > 490)) begin
						delta_damage3 = 0;
					end else begin
						delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*V(sub))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
					end
				end
				//$display("Parameter MULT in device %e, %e, %e", relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2), pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*V(sub)), exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				//$display("Parameter MULT in device %e, %e, %e", delta_damage3, 1.0/delta_damage3, id);
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e, %e", em, relimo_ratio21_a, w, id, -1e-7*pow(($temperature-273.15),2)+7e-5*($temperature-273.15)-0.0556);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, V(sub));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, V(sub), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
	
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			
			
			if (delta_damage1==0 || damage1==0) begin
				damage1_1 = 1e12;
			end else begin
				damage1_1 = 1/(pow(damage1,relimo_n2_1_hci1)*pow(1.0/delta_damage1,(relimo_n2_1_hci1-relimo_n1_1_hci1)));
			end
				

			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
			//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e", relimo_k_hci1, relimo_n1_1_hci1, relimo_n2_1_hci1, damage1, pow(damage1,relimo_n1_1_hci1), pow(damage1,relimo_n2_1_hci1), 1/delta_damage1, pow(1/delta_damage1,relimo_n2_1_hci1-relimo_n1_1_hci1));
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			//$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth %e\n", relimo_ratio_vth2a0, -1e-7*pow(($temperature-273.15),2)+7e-5*($temperature-273.15)-0.0556);
			
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0*0.0031, -0.0472*0, -0.0017*0);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			
			
			//$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1/(pow(damage1,relimo_n2_1_hci1)*pow(1.0/delta_damage1,(relimo_n2_1_hci1-relimo_n1_1_hci1))));
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_k_hci1*pow(damage1,relimo_n1_1_hci1));
			
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			
			if (delta_damage1==0 || damage1==0) begin
				damage1_1 = 1e12;
			end else begin
				damage1_1 = 1/(pow(damage1,relimo_n2_1_hci1)*pow(1.0/delta_damage1,(relimo_n2_1_hci1-relimo_n1_1_hci1)));
			end
			
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			//$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth %e\n", relimo_ratio_vth2a0, -1e-7*pow(($temperature-273.15),2)+7e-5*($temperature-273.15)-0.0556);
			
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0*0.0031, -0.0472*0, -0.0017*0);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			//$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1/(pow(damage1,relimo_n2_1_hci1)*pow(1.0/delta_damage1,(relimo_n2_1_hci1-relimo_n1_1_hci1))));
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_k_hci1*pow(damage1,relimo_n1_1_hci1));
			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
		end	
	end
end
endmodule



module relimo_aging_hv_hci_nld90b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "nld90b";
parameter string      relimo_probe_name            = "mpowermos";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 0;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

  
parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 12400 ;
parameter real a0_b0_b0_a1_em = -0.155 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -378 ;
parameter real a0_b0_a1_a1_em = -0.618 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 5390 ;
parameter real a0_b0_a2_a1_em = -7.39 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -1760 ;
parameter real a0_b0_a3_a1_em = 3.16 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -0.823 ;
parameter real a0_b0_p1_a1_em = 0.000291 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.97 ;
parameter real a0_b0_p2_a1_em = 0.000044 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 4.49 ;
parameter real a0_b0_p3_a1_em = -0.00267 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.5 ;
parameter real a0_b0_p4_a1_em = 0 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 8000 ;
parameter real a0_b0_b0_a2_em = 0 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 1200 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 0 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = -4000 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 0 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.5 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 1.7 ;
parameter real a0_b0_p2_a2_em = 0 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3.5 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 500 ;
parameter real a0_b0_b0_a3_em = 0 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 0 ;
parameter real a0_b0_a1_a3_em = 0 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 0 ;
parameter real a0_b0_a2_a3_em = 0 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = 0 ;
parameter real a0_b0_a3_a3_em = 0 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0 ;
parameter real a0_b0_p2_a3_em = 0 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 0 ;
parameter real a0_b0_p3_a3_em = 0 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 0 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 238 ;
parameter real a0_b0_b0_a4_em = 2.17 ;
parameter real b0_a0_b0_a4_em = 30.3 ;
parameter real a0_a0_b0_a4_em = -0.0447 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 0 ;
parameter real a0_b0_a1_a4_em = 0 ;
parameter real b0_a0_a1_a4_em = 0 ;
parameter real a0_a0_a1_a4_em = 0 ;
parameter real b0_b0_a2_a4_em = 0 ;
parameter real a0_b0_a2_a4_em = 0 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0 ;
parameter real b0_b0_a3_a4_em = 0 ;
parameter real a0_b0_a3_a4_em = 0 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0 ;
parameter real a0_b0_p1_a4_em = 0 ;
parameter real b0_a0_p1_a4_em = 0 ;
parameter real a0_a0_p1_a4_em = 0 ;
parameter real b0_b0_p2_a4_em = 0 ;
parameter real a0_b0_p2_a4_em = 0 ;
parameter real b0_a0_p2_a4_em = 0 ;
parameter real a0_a0_p2_a4_em = 0 ;
parameter real b0_b0_p3_a4_em = 0 ;
parameter real a0_b0_p3_a4_em = 0 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 0 ;
parameter real a0_b0_p4_a4_em = 0 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = 2.75 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.1 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 4.5 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 6 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 0.5 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.74 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 3.5 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4.04 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 24.7 ;
parameter real a0_b0_b0_p2_em = -0.000697 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.518 ;
parameter real a0_b0_a1_p2_em = 0.00176 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = -10.4 ;
parameter real a0_b0_a2_p2_em = 0.0123 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 1.97 ;
parameter real a0_b0_a3_p2_em = -0.00556 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 2.12 ;
parameter real a0_b0_p2_p2_em = -0.000524 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.5 ;
parameter real a0_b0_p3_p2_em = 0.000633 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 1.24 ;
parameter real a0_b0_p4_p2_em = 0.0027 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 33 ;
parameter real a0_b0_b0_p3_em = 0 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 0 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = -20.6 ;
parameter real a0_b0_b0_p4_em = 0.123 ;
parameter real b0_a0_b0_p4_em = 0.807 ;
parameter real a0_a0_b0_p4_em = -0.00258 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 0 ;
parameter real a0_b0_a1_p4_em = 0 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = 0 ;
parameter real a0_b0_a2_p4_em = 0 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 0 ;
parameter real a0_b0_a3_p4_em = 0 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 0 ;
parameter real a0_b0_p2_p4_em = 0 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 0 ;
parameter real a0_b0_p3_p4_em = 0 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 0 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;

  

parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.456;
parameter real        relimo_a2 = 0.298;
parameter real        relimo_c1 = 9.04e2;
parameter real        relimo_alpha1 = 3.31e-14;
parameter real        relimo_m1 = 1.24;
parameter real        relimo_lamda0 = 3.96e-7;
parameter real        relimo_fstat1 = 0.0029;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 328.897234744751;
parameter real        relimo_n_hci3 = 0.398964672265143;
parameter real        relimo_alpha2 = 9.95939441800961e23;
parameter real        relimo_beta2 = 8e-8;
parameter real        relimo_gama2 = 18.830740743597;
parameter real        relimo_eps2 = 8.36674142708708;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.810028787024253;
parameter real        relimo_rth = 0.00268380090939087;
parameter real        relimo_fstat2 = 0.0176092698723206;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					if (((relimo_intercept-relimo_c*vddtransistor) > 490) || (-1*relimo_e/(relimo_kb*$temperature) > 490)) begin
						delta_damage1 = 0;
					end else begin
						delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
        					//$display("Zhichen Debug 111 %e, %e, %e, %e,  %e, %e, %e, %e", relimo_intercept, relimo_c, relimo_a_idsat, relimo_m, relimo_e, delta_damage1,relimo_c,relimo_c);
				        	//$display("Parameter MULT in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e", relimo_intercept, relimo_c, vddtransistor, relimo_a_idsat, relimo_m, relimo_e, relimo_kb, $temperature, delta_damage1, 1.0/delta_damage1);
					end
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					   if (relimo_Feb/(em*lamda) > 490) begin
					   	delta_damage2 = 0;
					   end else begin
						delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
					   end
				end
        			//$display("Paramerer MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2);
				//$display("Parameter MULT in device %e, %e, %e, %e", em, id, delta_damage2, 1.0/delta_damage2);
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					if ((-1*relimo_eta2*abs(V(sub)-V(s)) > 490) || (relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6)) > 490)) begin
						delta_damage3 = 0;
					end else begin
						delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
					end
				end
				//$display("Parameter MULT in device %e, %e, %e", delta_damage3, 1.0/delta_damage3, id);
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e, %e, %e", em, 1.0/delta_damage1, 1.0/delta_damage2, 1.0/delta_damage3, w, id);
		//$display("Paramerer %M in device %e, %e, %e, %e, %e, %e, %e, %e, %", $temperature, id,relimo_fstat1,relimo_alpha1, relimo_m1,em,relimo_Feb,lamda, delta_damage2, 1.0/delta_damage2);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule


module relimo_aging_hv_hci_nmos90b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "nmos90b";
parameter string      relimo_probe_name            = "mamost";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 0;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;

// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

  
parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 20900 ;
parameter real a0_b0_b0_a1_em = -1.51 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = -2500 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = 3920 ;
parameter real a0_b0_a1_a1_em = -4.01 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3420 ;
parameter real a0_b0_a2_a1_em = -23.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -38100 ;
parameter real a0_b0_a3_a1_em = 186 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.966 ;
parameter real a0_b0_p1_a1_em = 0.000674 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.59 ;
parameter real a0_b0_p2_a1_em = 0.00166 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.18 ;
parameter real a0_b0_p3_a1_em = 0.00033 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 3.5 ;
parameter real a0_b0_p4_a1_em = 0 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 5900 ;
parameter real a0_b0_b0_a2_em = 0.8 ;
parameter real b0_a0_b0_a2_em = 3.55 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0.5 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -2000 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 15300 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -10000 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.7 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 1.9 ;
parameter real a0_b0_p2_a2_em = 0.0005 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 2.7 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.9 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 3000 ;
parameter real a0_b0_b0_a3_em = 0.5 ;
parameter real b0_a0_b0_a3_em = 10 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 3000 ;
parameter real a0_b0_a1_a3_em = -0.002 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -4500 ;
parameter real a0_b0_a2_a3_em = -0.000003 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = 0 ;
parameter real a0_b0_a3_a3_em = 0 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.9 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2.5 ;
parameter real a0_b0_p2_a3_em = -0.0003 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 4 ;
parameter real a0_b0_p3_a3_em = -0.000004 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 4.5 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 889 ;
parameter real a0_b0_b0_a4_em = -1.05 ;
parameter real b0_a0_b0_a4_em = 17.5 ;
parameter real a0_a0_b0_a4_em = 0.0102 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 0 ;
parameter real a0_b0_a1_a4_em = 0 ;
parameter real b0_a0_a1_a4_em = 0 ;
parameter real a0_a0_a1_a4_em = 0 ;
parameter real b0_b0_a2_a4_em = 0 ;
parameter real a0_b0_a2_a4_em = 0 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0 ;
parameter real b0_b0_a3_a4_em = 0 ;
parameter real a0_b0_a3_a4_em = 0 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0 ;
parameter real a0_b0_p1_a4_em = 0 ;
parameter real b0_a0_p1_a4_em = 0 ;
parameter real a0_a0_p1_a4_em = 0 ;
parameter real b0_b0_p2_a4_em = 0 ;
parameter real a0_b0_p2_a4_em = 0 ;
parameter real b0_a0_p2_a4_em = 0 ;
parameter real a0_a0_p2_a4_em = 0 ;
parameter real b0_b0_p3_a4_em = 0 ;
parameter real a0_b0_p3_a4_em = 0 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 0 ;
parameter real a0_b0_p4_a4_em = 0 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -8 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = -0.1 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 9 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 0.1 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -0.9 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.4 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 3.08 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4.3 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 8.42 ;
parameter real a0_b0_b0_p2_em = 0.000999 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 1.66 ;
parameter real a0_b0_a0_p2_em = -0.0005 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = -4.56 ;
parameter real a0_b0_a1_p2_em = 0.0118 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 13.7 ;
parameter real a0_b0_a2_p2_em = -0.0153 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -10.2 ;
parameter real a0_b0_a3_p2_em = -0.00276 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0.7 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.36 ;
parameter real a0_b0_p2_p2_em = 0.00115 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.26 ;
parameter real a0_b0_p3_p2_em = 0.000641 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 3.1 ;
parameter real a0_b0_p4_p2_em = 0.000275 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 17.6 ;
parameter real a0_b0_b0_p3_em = 0.00292 ;
parameter real b0_a0_b0_p3_em = 0.1 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = -9.45 ;
parameter real a0_b0_a1_p3_em = -0.0435 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 17 ;
parameter real a0_b0_a2_p3_em = -0.0256 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0.457 ;
parameter real a0_b0_a3_p3_em = -0.0183 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0.35 ;
parameter real a0_b0_p1_p3_em = 0.00179 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 1.24 ;
parameter real a0_b0_p2_p3_em = 0.000298 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 2.21 ;
parameter real a0_b0_p3_p3_em = 0.00128 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 4 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 43.4 ;
parameter real a0_b0_b0_p4_em = -0.0144 ;
parameter real b0_a0_b0_p4_em = 0.313 ;
parameter real a0_a0_b0_p4_em = -0.000301 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = -18 ;
parameter real a0_b0_a1_p4_em = 0.0146 ;
parameter real b0_a0_a1_p4_em = -0.0649 ;
parameter real a0_a0_a1_p4_em = 0.0000371 ;
parameter real b0_b0_a2_p4_em = -18.1 ;
parameter real a0_b0_a2_p4_em = 0.137 ;
parameter real b0_a0_a2_p4_em = 0.945 ;
parameter real a0_a0_a2_p4_em = -0.00142 ;
parameter real b0_b0_a3_p4_em = 0.0315 ;
parameter real a0_b0_a3_p4_em = -0.183 ;
parameter real b0_a0_a3_p4_em = 1.55 ;
parameter real a0_a0_a3_p4_em = 0.00225 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 1.42 ;
parameter real a0_b0_p1_p4_em = -0.00115 ;
parameter real b0_a0_p1_p4_em = -0.00603 ;
parameter real a0_a0_p1_p4_em = 0.0000146 ;
parameter real b0_b0_p2_p4_em = 2.09 ;
parameter real a0_b0_p2_p4_em = 0.000857 ;
parameter real b0_a0_p2_p4_em = 0.00871 ;
parameter real a0_a0_p2_p4_em = -0.0000117 ;
parameter real b0_b0_p3_p4_em = 3.31 ;
parameter real a0_b0_p3_p4_em = 0.00286 ;
parameter real b0_a0_p3_p4_em = 0.0118 ;
parameter real a0_a0_p3_p4_em = -0.0001 ;
parameter real b0_b0_p4_p4_em = 4 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;
  

parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.078;
parameter real        relimo_a2 = 0.48;
parameter real        relimo_c1 = 9.64e2;
parameter real        relimo_alpha1 = 1.96e-12;
parameter real        relimo_m1 = 1.1;
parameter real        relimo_lamda0 = 3.09e-7;
parameter real        relimo_fstat1 = 0.00392;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 283.763535360547;
parameter real        relimo_n_hci3 = 0.46671749214653;
parameter real        relimo_alpha2 = 1.10163299713746e17;
parameter real        relimo_beta2 = 0.0000437895530284509;
parameter real        relimo_gama2 = 11.9861294324972;
parameter real        relimo_eps2 = 4.86661881343166;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.61992188566913;
parameter real        relimo_rth = 0.00249866524239777;
parameter real        relimo_fstat2 = 0.0160772520570436;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			id = abs($simprobe(relimo_probe_name, "ide"));

			//id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					if (((relimo_intercept-relimo_c*vddtransistor) > 490) || (-1*relimo_e/(relimo_kb*$temperature) > 490)) begin
						delta_damage1 = 0;
					end else begin
						delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
        					//$display("Parameter MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", exp(relimo_intercept-relimo_c*vddtransistor), relimo_a_idsat*relimo_m, exp(-1*relimo_e/(relimo_kb*$temperature)), delta_damage1,relimo_c,relimo_intercept-relimo_c*vddtransistor,relimo_intercept,vddtransistor);
				        	//$display("Parameter MULT in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e", relimo_intercept, relimo_c, vddtransistor, relimo_a_idsat, relimo_m, relimo_e, relimo_kb, $temperature, delta_damage1, 1.0/delta_damage1);
					end
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					   if (relimo_Feb/(em*lamda) > 490) begin
					   	delta_damage2 = 0;
					   end else begin
						delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
					   end
				end
        			//$display("Paramerer MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", pow(w*1e-6/id,relimo_m1), relimo_Feb/(em*lamda), exp(relimo_Feb/(em*lamda)), id,relimo_m1,em,relimo_Feb,delta_damage2);
				//$display("Parameter MULT in device %e, %e, %e, %e", em, id, delta_damage2, 1.0/delta_damage2);
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					if ((-1*relimo_eta2*abs(V(sub)-V(s)) > 490) || (relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6)) > 490)) begin
						delta_damage3 = 0;
					end else begin
						delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
					end
				end
				//$display("Parameter MULT in device %e, %e, %e", delta_damage3, 1.0/delta_damage3, id);
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e", em, delta_damage2, 1.0/delta_damage2, 1.0/delta_damage1, 1.0/delta_damage3, w, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_pld45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld45b";
parameter string      relimo_probe_name            = "mpowermos";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.241;
parameter real        relimo_fstat3 = 0.0142;
parameter real        relimo_alpha3 = 5.12E+11;
parameter real        relimo_beta3 = 2.90E-08;
parameter real        relimo_gama3 = 15.7;
parameter real        relimo_eps3 = 4.56;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 1.31;
parameter real        relimo_rth = 0.0279;

// parameter for off stat
parameter real        relimo_a1_off = 14.5;
parameter real        relimo_a2_off = 0.288;
parameter real        relimo_n1_off = 0.301;
parameter real        relimo_n2_off = 1.46;
parameter real        relimo_alpha1_off = 7330;
parameter real        relimo_beta1 = 0.112;
parameter real        relimo_ea1 = 0.368;
parameter real        relimo_alpha2_off = 0.0011;
parameter real        relimo_beta2 = 0.139;
parameter real        relimo_ea2 = 0.48;
parameter real        fstat_tau1_off = 0.0129;
parameter real        fstat_tau2_off = 0.0189;
parameter real        fstat_tau1tau2_off = 18.2;
parameter real        fstat_tau2tau1_off = 18.2;
parameter real        m_sigma_b_off = 1;
parameter real        delta_m_sigma_b_off = 0.5;
parameter real        m_sigma_a_off = 1;
parameter real        delta_m_sigma_a_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Ep = 0.063;
parameter real        relimo_lamda_h0 = 2.66E-06;
parameter real        relimo_alpha1 = 0.342;
parameter real        relimo_m1 = 0.49;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_lamda_el0 = 3.16E-07;
parameter real        relimo_alpha2 = 7.38E-40;
parameter real        relimo_m2 = 0.851;
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_a1 = 1.0483;
parameter real        relimo_a2 = 34.922;
parameter real        relimo_c1 = 1.48E+05;
parameter real        relimo_b = 7.44E-05;
parameter real        relimo_n_hci = 3;
parameter real        m_sigma_b = 1;
parameter real        delta_m_sigma_b = 0.4;
parameter real        m_sigma_a = 1;
parameter real        delta_m_sigma_a = 6;
parameter real        fstat_tau1 = 0.0387;
parameter real        fstat_tau2 = 0.00333;
parameter real        fstat_tau1tau2 = 96.8;
parameter real        fstat_tau2tau1 = 96.8;
parameter real        vgs_cutoff_HCI = -0.9;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 13700 ;
parameter real a0_b0_b0_a1_em = -2.61 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = 466 ;
parameter real a0_b0_a1_a1_em = -0.885 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -2500 ;
parameter real a0_b0_a2_a1_em = -3.64 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 2120 ;
parameter real a0_b0_a3_a1_em = -1.8 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 2.15 ;
parameter real a0_b0_p1_a1_em = -0.00452 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.84 ;
parameter real a0_b0_p2_a1_em = 0.000795 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.65 ;
parameter real a0_b0_p3_a1_em = -0.000646 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 7250 ;
parameter real a0_b0_b0_a2_em = -0.926 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -344 ;
parameter real a0_b0_a1_a2_em = 3.25 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 1520 ;
parameter real a0_b0_a2_a2_em = -9.25 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -2780 ;
parameter real a0_b0_a3_a2_em = 3.52 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -0.214 ;
parameter real a0_b0_p1_a2_em = 0.00118 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 1.51 ;
parameter real a0_b0_p2_a2_em = 0.000344 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 2.37 ;
parameter real a0_b0_p3_a2_em = -0.000328 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 4340 ;
parameter real a0_b0_b0_a3_em = -0.16 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 623 ;
parameter real a0_b0_a1_a3_em = -1.83 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -7100 ;
parameter real a0_b0_a2_a3_em = 16.7 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -1760 ;
parameter real a0_b0_a3_a3_em = 1.81 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = -1.82 ;
parameter real a0_b0_p1_a3_em = 0.00979 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.69 ;
parameter real a0_b0_p2_a3_em = 0.00141 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.91 ;
parameter real a0_b0_p3_a3_em = 0.00058 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2990 ;
parameter real a0_b0_b0_a4_em = 0.323 ;
parameter real b0_a0_b0_a4_em = -0.204 ;
parameter real a0_a0_b0_a4_em = 0.000505 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -470 ;
parameter real a0_b0_a1_a4_em = 1.79 ;
parameter real b0_a0_a1_a4_em = 0.0293 ;
parameter real a0_a0_a1_a4_em = 0.00881 ;
parameter real b0_b0_a2_a4_em = -413 ;
parameter real a0_b0_a2_a4_em = 0.531 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00135 ;
parameter real b0_b0_a3_a4_em = 442 ;
parameter real a0_b0_a3_a4_em = -1.14 ;
parameter real b0_a0_a3_a4_em = -0.423 ;
parameter real a0_a0_a3_a4_em = -0.00545 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0.0428 ;
parameter real a0_b0_p1_a4_em = 0.00318 ;
parameter real b0_a0_p1_a4_em = -0.0223 ;
parameter real a0_a0_p1_a4_em = 6.39E-05 ;
parameter real b0_b0_p2_a4_em = 1.43 ;
parameter real a0_b0_p2_a4_em = -0.000456 ;
parameter real b0_a0_p2_a4_em = -0.00644 ;
parameter real a0_a0_p2_a4_em = 3.43E-05 ;
parameter real b0_b0_p3_a4_em = 2 ;
parameter real a0_b0_p3_a4_em = 0.00508 ;
parameter real b0_a0_p3_a4_em = -0.00732 ;
parameter real a0_a0_p3_a4_em = 1.42E-05 ;
parameter real b0_b0_p4_a4_em = 3.61 ;
parameter real a0_b0_p4_a4_em = 0.00576 ;
parameter real b0_a0_p4_a4_em = -0.0734 ;
parameter real a0_a0_p4_a4_em = 0.000243 ;
parameter real b0_b0_b0_p1_em = 4.05 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.827 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.877 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -4.88 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 0.116 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.7 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.5 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 3.46 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 14.2 ;
parameter real a0_b0_b0_p2_em = 0.0037 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.327 ;
parameter real a0_b0_a1_p2_em = -0.0014 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = -1.5 ;
parameter real a0_b0_a2_p2_em = 0.00513 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -0.11 ;
parameter real a0_b0_a3_p2_em = -0.0172 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.09 ;
parameter real a0_b0_p2_p2_em = 0.0031 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 3.77 ;
parameter real a0_b0_p3_p2_em = -0.000521 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 4.78 ;
parameter real a0_b0_p4_p2_em = -0.00196 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 21.7 ;
parameter real a0_b0_b0_p3_em = 0.00308 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 1.82 ;
parameter real a0_b0_a1_p3_em = -0.000988 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 1.31 ;
parameter real a0_b0_a2_p3_em = -0.00202 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0.0916 ;
parameter real a0_b0_a3_p3_em = 0.00239 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 4.52 ;
parameter real a0_b0_p1_p3_em = -0.00217 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.32 ;
parameter real a0_b0_p2_p3_em = -0.00512 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0.938 ;
parameter real a0_b0_p3_p3_em = 0.00601 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 4.02 ;
parameter real a0_b0_p4_p3_em = 0.0872 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 33.5 ;
parameter real a0_b0_b0_p4_em = 0.00418 ;
parameter real b0_a0_b0_p4_em = 0.0126 ;
parameter real a0_a0_b0_p4_em = -3.91E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 12.4 ;
parameter real a0_b0_a1_p4_em = 0.0683 ;
parameter real b0_a0_a1_p4_em = -0.0213 ;
parameter real a0_a0_a1_p4_em = 0.000322 ;
parameter real b0_b0_a2_p4_em = -14.9 ;
parameter real a0_b0_a2_p4_em = 0.0255 ;
parameter real b0_a0_a2_p4_em = -0.344 ;
parameter real a0_a0_a2_p4_em = 0.000792 ;
parameter real b0_b0_a3_p4_em = -15.9 ;
parameter real a0_b0_a3_p4_em = -0.0024 ;
parameter real b0_a0_a3_p4_em = 0.158 ;
parameter real a0_a0_a3_p4_em = -0.000578 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 1.89 ;
parameter real a0_b0_p1_p4_em = 0.00101 ;
parameter real b0_a0_p1_p4_em = 0.000923 ;
parameter real a0_a0_p1_p4_em = -1.13E-06 ;
parameter real b0_b0_p2_p4_em = 2.7 ;
parameter real a0_b0_p2_p4_em = -0.000443 ;
parameter real b0_a0_p2_p4_em = 0.00365 ;
parameter real a0_a0_p2_p4_em = -9.26E-06 ;
parameter real b0_b0_p3_p4_em = 3.19 ;
parameter real a0_b0_p3_p4_em = 0.00164 ;
parameter real b0_a0_p3_p4_em = 0.00461 ;
parameter real a0_a0_p3_p4_em = -8.57E-08 ;
parameter real b0_b0_p4_p4_em = 5.18 ;
parameter real a0_b0_p4_p4_em = -0.00168 ;
parameter real b0_a0_p4_p4_em = -0.00462 ;
parameter real a0_a0_p4_p4_em = 5.38E-06 ;

parameter real b0_b0_b0_b0_em2 = 0 ;
parameter real a0_b0_b0_b0_em2 = 0 ;
parameter real b0_a0_b0_b0_em2 = 0 ;
parameter real a0_a0_b0_b0_em2 = 0 ;
parameter real b0_b0_a0_b0_em2 = 0 ;
parameter real a0_b0_a0_b0_em2 = 0 ;
parameter real b0_a0_a0_b0_em2 = 0 ;
parameter real a0_a0_a0_b0_em2 = 0 ;
parameter real b0_b0_a1_b0_em2 = 0 ;
parameter real a0_b0_a1_b0_em2 = 0 ;
parameter real b0_a0_a1_b0_em2 = 0 ;
parameter real a0_a0_a1_b0_em2 = 0 ;
parameter real b0_b0_a2_b0_em2 = 0 ;
parameter real a0_b0_a2_b0_em2 = 0 ;
parameter real b0_a0_a2_b0_em2 = 0 ;
parameter real a0_a0_a2_b0_em2 = 0 ;
parameter real b0_b0_a3_b0_em2 = 0 ;
parameter real a0_b0_a3_b0_em2 = 0 ;
parameter real b0_a0_a3_b0_em2 = 0 ;
parameter real a0_a0_a3_b0_em2 = 0 ;
parameter real b0_b0_a4_b0_em2 = 0 ;
parameter real a0_b0_a4_b0_em2 = 0 ;
parameter real b0_a0_a4_b0_em2 = 0 ;
parameter real a0_a0_a4_b0_em2 = 0 ;
parameter real b0_b0_p1_b0_em2 = 0 ;
parameter real a0_b0_p1_b0_em2 = 0 ;
parameter real b0_a0_p1_b0_em2 = 0 ;
parameter real a0_a0_p1_b0_em2 = 0 ;
parameter real b0_b0_p2_b0_em2 = 0 ;
parameter real a0_b0_p2_b0_em2 = 0 ;
parameter real b0_a0_p2_b0_em2 = 0 ;
parameter real a0_a0_p2_b0_em2 = 0 ;
parameter real b0_b0_p3_b0_em2 = 0 ;
parameter real a0_b0_p3_b0_em2 = 0 ;
parameter real b0_a0_p3_b0_em2 = 0 ;
parameter real a0_a0_p3_b0_em2 = 0 ;
parameter real b0_b0_p4_b0_em2 = 0 ;
parameter real a0_b0_p4_b0_em2 = 0 ;
parameter real b0_a0_p4_b0_em2 = 0 ;
parameter real a0_a0_p4_b0_em2 = 0 ;
parameter real b0_b0_b0_a0_em2 = 0 ;
parameter real a0_b0_b0_a0_em2 = 0 ;
parameter real b0_a0_b0_a0_em2 = 0 ;
parameter real a0_a0_b0_a0_em2 = 0 ;
parameter real b0_b0_a0_a0_em2 = 0 ;
parameter real a0_b0_a0_a0_em2 = 0 ;
parameter real b0_a0_a0_a0_em2 = 0 ;
parameter real a0_a0_a0_a0_em2 = 0 ;
parameter real b0_b0_a1_a0_em2 = 0 ;
parameter real a0_b0_a1_a0_em2 = 0 ;
parameter real b0_a0_a1_a0_em2 = 0 ;
parameter real a0_a0_a1_a0_em2 = 0 ;
parameter real b0_b0_a2_a0_em2 = 0 ;
parameter real a0_b0_a2_a0_em2 = 0 ;
parameter real b0_a0_a2_a0_em2 = 0 ;
parameter real a0_a0_a2_a0_em2 = 0 ;
parameter real b0_b0_a3_a0_em2 = 0 ;
parameter real a0_b0_a3_a0_em2 = 0 ;
parameter real b0_a0_a3_a0_em2 = 0 ;
parameter real a0_a0_a3_a0_em2 = 0 ;
parameter real b0_b0_a4_a0_em2 = 0 ;
parameter real a0_b0_a4_a0_em2 = 0 ;
parameter real b0_a0_a4_a0_em2 = 0 ;
parameter real a0_a0_a4_a0_em2 = 0 ;
parameter real b0_b0_p1_a0_em2 = 0 ;
parameter real a0_b0_p1_a0_em2 = 0 ;
parameter real b0_a0_p1_a0_em2 = 0 ;
parameter real a0_a0_p1_a0_em2 = 0 ;
parameter real b0_b0_p2_a0_em2 = 0 ;
parameter real a0_b0_p2_a0_em2 = 0 ;
parameter real b0_a0_p2_a0_em2 = 0 ;
parameter real a0_a0_p2_a0_em2 = 0 ;
parameter real b0_b0_p3_a0_em2 = 0 ;
parameter real a0_b0_p3_a0_em2 = 0 ;
parameter real b0_a0_p3_a0_em2 = 0 ;
parameter real a0_a0_p3_a0_em2 = 0 ;
parameter real b0_b0_p4_a0_em2 = 0 ;
parameter real a0_b0_p4_a0_em2 = 0 ;
parameter real b0_a0_p4_a0_em2 = 0 ;
parameter real a0_a0_p4_a0_em2 = 0 ;
parameter real b0_b0_b0_a1_em2 = 11800 ;
parameter real a0_b0_b0_a1_em2 = -2.09 ;
parameter real b0_a0_b0_a1_em2 = 0 ;
parameter real a0_a0_b0_a1_em2 = 0 ;
parameter real b0_b0_a0_a1_em2 = 0 ;
parameter real a0_b0_a0_a1_em2 = 0 ;
parameter real b0_a0_a0_a1_em2 = 0 ;
parameter real a0_a0_a0_a1_em2 = 0 ;
parameter real b0_b0_a1_a1_em2 = -502 ;
parameter real a0_b0_a1_a1_em2 = 0.398 ;
parameter real b0_a0_a1_a1_em2 = 0 ;
parameter real a0_a0_a1_a1_em2 = 0 ;
parameter real b0_b0_a2_a1_em2 = -1520 ;
parameter real a0_b0_a2_a1_em2 = -0.915 ;
parameter real b0_a0_a2_a1_em2 = 0 ;
parameter real a0_a0_a2_a1_em2 = 0 ;
parameter real b0_b0_a3_a1_em2 = -1070 ;
parameter real a0_b0_a3_a1_em2 = 2.14 ;
parameter real b0_a0_a3_a1_em2 = 0 ;
parameter real a0_a0_a3_a1_em2 = 0 ;
parameter real b0_b0_a4_a1_em2 = 0 ;
parameter real a0_b0_a4_a1_em2 = 0 ;
parameter real b0_a0_a4_a1_em2 = 0 ;
parameter real a0_a0_a4_a1_em2 = 0 ;
parameter real b0_b0_p1_a1_em2 = -2.79 ;
parameter real a0_b0_p1_a1_em2 = 0.000263 ;
parameter real b0_a0_p1_a1_em2 = 0 ;
parameter real a0_a0_p1_a1_em2 = 0 ;
parameter real b0_b0_p2_a1_em2 = 2.54 ;
parameter real a0_b0_p2_a1_em2 = -0.00164 ;
parameter real b0_a0_p2_a1_em2 = 0 ;
parameter real a0_a0_p2_a1_em2 = 0 ;
parameter real b0_b0_p3_a1_em2 = 3.27 ;
parameter real a0_b0_p3_a1_em2 = -0.000853 ;
parameter real b0_a0_p3_a1_em2 = 0 ;
parameter real a0_a0_p3_a1_em2 = 0 ;
parameter real b0_b0_p4_a1_em2 = 4.9 ;
parameter real a0_b0_p4_a1_em2 = -0.0017 ;
parameter real b0_a0_p4_a1_em2 = 0 ;
parameter real a0_a0_p4_a1_em2 = 0 ;
parameter real b0_b0_b0_a2_em2 = 5700 ;
parameter real a0_b0_b0_a2_em2 = -1.7 ;
parameter real b0_a0_b0_a2_em2 = 0 ;
parameter real a0_a0_b0_a2_em2 = 0 ;
parameter real b0_b0_a0_a2_em2 = 0 ;
parameter real a0_b0_a0_a2_em2 = 0 ;
parameter real b0_a0_a0_a2_em2 = 0 ;
parameter real a0_a0_a0_a2_em2 = 0 ;
parameter real b0_b0_a1_a2_em2 = -1230 ;
parameter real a0_b0_a1_a2_em2 = 0.923 ;
parameter real b0_a0_a1_a2_em2 = 0 ;
parameter real a0_a0_a1_a2_em2 = 0 ;
parameter real b0_b0_a2_a2_em2 = 123 ;
parameter real a0_b0_a2_a2_em2 = 0.528 ;
parameter real b0_a0_a2_a2_em2 = 0 ;
parameter real a0_a0_a2_a2_em2 = 0 ;
parameter real b0_b0_a3_a2_em2 = -1720 ;
parameter real a0_b0_a3_a2_em2 = 1.83 ;
parameter real b0_a0_a3_a2_em2 = 0 ;
parameter real a0_a0_a3_a2_em2 = 0 ;
parameter real b0_b0_a4_a2_em2 = 0 ;
parameter real a0_b0_a4_a2_em2 = 0 ;
parameter real b0_a0_a4_a2_em2 = 0 ;
parameter real a0_a0_a4_a2_em2 = 0 ;
parameter real b0_b0_p1_a2_em2 = -1.45 ;
parameter real a0_b0_p1_a2_em2 = 0.00118 ;
parameter real b0_a0_p1_a2_em2 = 0 ;
parameter real a0_a0_p1_a2_em2 = 0 ;
parameter real b0_b0_p2_a2_em2 = -0.285 ;
parameter real a0_b0_p2_a2_em2 = 0.000212 ;
parameter real b0_a0_p2_a2_em2 = 0 ;
parameter real a0_a0_p2_a2_em2 = 0 ;
parameter real b0_b0_p3_a2_em2 = 2.72 ;
parameter real a0_b0_p3_a2_em2 = -0.0023 ;
parameter real b0_a0_p3_a2_em2 = 0 ;
parameter real a0_a0_p3_a2_em2 = 0 ;
parameter real b0_b0_p4_a2_em2 = 4 ;
parameter real a0_b0_p4_a2_em2 = 0 ;
parameter real b0_a0_p4_a2_em2 = 0 ;
parameter real a0_a0_p4_a2_em2 = 0 ;
parameter real b0_b0_b0_a3_em2 = 3160 ;
parameter real a0_b0_b0_a3_em2 = 0.264 ;
parameter real b0_a0_b0_a3_em2 = 0 ;
parameter real a0_a0_b0_a3_em2 = 0 ;
parameter real b0_b0_a0_a3_em2 = 0 ;
parameter real a0_b0_a0_a3_em2 = 0 ;
parameter real b0_a0_a0_a3_em2 = 0 ;
parameter real a0_a0_a0_a3_em2 = 0 ;
parameter real b0_b0_a1_a3_em2 = 311 ;
parameter real a0_b0_a1_a3_em2 = -1.12 ;
parameter real b0_a0_a1_a3_em2 = 0 ;
parameter real a0_a0_a1_a3_em2 = 0 ;
parameter real b0_b0_a2_a3_em2 = -2270 ;
parameter real a0_b0_a2_a3_em2 = 6.19 ;
parameter real b0_a0_a2_a3_em2 = 0 ;
parameter real a0_a0_a2_a3_em2 = 0 ;
parameter real b0_b0_a3_a3_em2 = -413 ;
parameter real a0_b0_a3_a3_em2 = -0.749 ;
parameter real b0_a0_a3_a3_em2 = 0 ;
parameter real a0_a0_a3_a3_em2 = 0 ;
parameter real b0_b0_a4_a3_em2 = 0 ;
parameter real a0_b0_a4_a3_em2 = 0 ;
parameter real b0_a0_a4_a3_em2 = 0 ;
parameter real a0_a0_a4_a3_em2 = 0 ;
parameter real b0_b0_p1_a3_em2 = -3.3 ;
parameter real a0_b0_p1_a3_em2 = 0.0102 ;
parameter real b0_a0_p1_a3_em2 = 0 ;
parameter real a0_a0_p1_a3_em2 = 0 ;
parameter real b0_b0_p2_a3_em2 = -1.15 ;
parameter real a0_b0_p2_a3_em2 = 0.0132 ;
parameter real b0_a0_p2_a3_em2 = 0 ;
parameter real a0_a0_p2_a3_em2 = 0 ;
parameter real b0_b0_p3_a3_em2 = -1.27 ;
parameter real a0_b0_p3_a3_em2 = 0.0126 ;
parameter real b0_a0_p3_a3_em2 = 0 ;
parameter real a0_a0_p3_a3_em2 = 0 ;
parameter real b0_b0_p4_a3_em2 = 4.5 ;
parameter real a0_b0_p4_a3_em2 = 0 ;
parameter real b0_a0_p4_a3_em2 = 0 ;
parameter real a0_a0_p4_a3_em2 = 0 ;
parameter real b0_b0_b0_a4_em2 = 2230 ;
parameter real a0_b0_b0_a4_em2 = 0.075 ;
parameter real b0_a0_b0_a4_em2 = -0.0157 ;
parameter real a0_a0_b0_a4_em2 = 0.00113 ;
parameter real b0_b0_a0_a4_em2 = 0 ;
parameter real a0_b0_a0_a4_em2 = 0 ;
parameter real b0_a0_a0_a4_em2 = 0 ;
parameter real a0_a0_a0_a4_em2 = 0 ;
parameter real b0_b0_a1_a4_em2 = 242 ;
parameter real a0_b0_a1_a4_em2 = -0.625 ;
parameter real b0_a0_a1_a4_em2 = 1.14 ;
parameter real a0_a0_a1_a4_em2 = -0.00266 ;
parameter real b0_b0_a2_a4_em2 = 11.8 ;
parameter real a0_b0_a2_a4_em2 = -0.239 ;
parameter real b0_a0_a2_a4_em2 = 0 ;
parameter real a0_a0_a2_a4_em2 = 9.01E-05 ;
parameter real b0_b0_a3_a4_em2 = 1540 ;
parameter real a0_b0_a3_a4_em2 = 16.4 ;
parameter real b0_a0_a3_a4_em2 = -0.000875 ;
parameter real a0_a0_a3_a4_em2 = -0.19 ;
parameter real b0_b0_a4_a4_em2 = 0 ;
parameter real a0_b0_a4_a4_em2 = 0 ;
parameter real b0_a0_a4_a4_em2 = 0 ;
parameter real a0_a0_a4_a4_em2 = 0 ;
parameter real b0_b0_p1_a4_em2 = -0.58 ;
parameter real a0_b0_p1_a4_em2 = 0.000326 ;
parameter real b0_a0_p1_a4_em2 = 0.109 ;
parameter real a0_a0_p1_a4_em2 = -0.000229 ;
parameter real b0_b0_p2_a4_em2 = -2.55 ;
parameter real a0_b0_p2_a4_em2 = 0.0103 ;
parameter real b0_a0_p2_a4_em2 = 0.0581 ;
parameter real a0_a0_p2_a4_em2 = -0.00014 ;
parameter real b0_b0_p3_a4_em2 = -4.34 ;
parameter real a0_b0_p3_a4_em2 = 0.037 ;
parameter real b0_a0_p3_a4_em2 = -8.81E-05 ;
parameter real a0_a0_p3_a4_em2 = -1.12E-05 ;
parameter real b0_b0_p4_a4_em2 = -4.38 ;
parameter real a0_b0_p4_a4_em2 = 0.0463 ;
parameter real b0_a0_p4_a4_em2 = 0 ;
parameter real a0_a0_p4_a4_em2 = 0 ;
parameter real b0_b0_b0_p1_em2 = 0.07 ;
parameter real a0_b0_b0_p1_em2 = 0 ;
parameter real b0_a0_b0_p1_em2 = 0 ;
parameter real a0_a0_b0_p1_em2 = 0 ;
parameter real b0_b0_a0_p1_em2 = 0 ;
parameter real a0_b0_a0_p1_em2 = 0 ;
parameter real b0_a0_a0_p1_em2 = 0 ;
parameter real a0_a0_a0_p1_em2 = 0 ;
parameter real b0_b0_a1_p1_em2 = 0.753 ;
parameter real a0_b0_a1_p1_em2 = 0 ;
parameter real b0_a0_a1_p1_em2 = 0 ;
parameter real a0_a0_a1_p1_em2 = 0 ;
parameter real b0_b0_a2_p1_em2 = 1.20E-08 ;
parameter real a0_b0_a2_p1_em2 = 0 ;
parameter real b0_a0_a2_p1_em2 = 0 ;
parameter real a0_a0_a2_p1_em2 = 0 ;
parameter real b0_b0_a3_p1_em2 = 7.53E-12 ;
parameter real a0_b0_a3_p1_em2 = 0 ;
parameter real b0_a0_a3_p1_em2 = 0 ;
parameter real a0_a0_a3_p1_em2 = 0 ;
parameter real b0_b0_a4_p1_em2 = 0 ;
parameter real a0_b0_a4_p1_em2 = 0 ;
parameter real b0_a0_a4_p1_em2 = 0 ;
parameter real a0_a0_a4_p1_em2 = 0 ;
parameter real b0_b0_p1_p1_em2 = -0.172 ;
parameter real a0_b0_p1_p1_em2 = 0 ;
parameter real b0_a0_p1_p1_em2 = 0 ;
parameter real a0_a0_p1_p1_em2 = 0 ;
parameter real b0_b0_p2_p1_em2 = 1.9 ;
parameter real a0_b0_p2_p1_em2 = 0 ;
parameter real b0_a0_p2_p1_em2 = 0 ;
parameter real a0_a0_p2_p1_em2 = 0 ;
parameter real b0_b0_p3_p1_em2 = 2 ;
parameter real a0_b0_p3_p1_em2 = 0 ;
parameter real b0_a0_p3_p1_em2 = 0 ;
parameter real a0_a0_p3_p1_em2 = 0 ;
parameter real b0_b0_p4_p1_em2 = 3 ;
parameter real a0_b0_p4_p1_em2 = 0 ;
parameter real b0_a0_p4_p1_em2 = 0 ;
parameter real a0_a0_p4_p1_em2 = 0 ;
parameter real b0_b0_b0_p2_em2 = 14.1 ;
parameter real a0_b0_b0_p2_em2 = 0.00409 ;
parameter real b0_a0_b0_p2_em2 = 0 ;
parameter real a0_a0_b0_p2_em2 = 0 ;
parameter real b0_b0_a0_p2_em2 = 0 ;
parameter real a0_b0_a0_p2_em2 = 0 ;
parameter real b0_a0_a0_p2_em2 = 0 ;
parameter real a0_a0_a0_p2_em2 = 0 ;
parameter real b0_b0_a1_p2_em2 = 1.03 ;
parameter real a0_b0_a1_p2_em2 = -0.00161 ;
parameter real b0_a0_a1_p2_em2 = 0 ;
parameter real a0_a0_a1_p2_em2 = 0 ;
parameter real b0_b0_a2_p2_em2 = -2.27 ;
parameter real a0_b0_a2_p2_em2 = 0.00625 ;
parameter real b0_a0_a2_p2_em2 = 0 ;
parameter real a0_a0_a2_p2_em2 = 0 ;
parameter real b0_b0_a3_p2_em2 = 1.64 ;
parameter real a0_b0_a3_p2_em2 = -0.0103 ;
parameter real b0_a0_a3_p2_em2 = 0 ;
parameter real a0_a0_a3_p2_em2 = 0 ;
parameter real b0_b0_a4_p2_em2 = 0 ;
parameter real a0_b0_a4_p2_em2 = 0 ;
parameter real b0_a0_a4_p2_em2 = 0 ;
parameter real a0_a0_a4_p2_em2 = 0 ;
parameter real b0_b0_p1_p2_em2 = -1 ;
parameter real a0_b0_p1_p2_em2 = 0 ;
parameter real b0_a0_p1_p2_em2 = 0 ;
parameter real a0_a0_p1_p2_em2 = 0 ;
parameter real b0_b0_p2_p2_em2 = 2.02 ;
parameter real a0_b0_p2_p2_em2 = -0.000541 ;
parameter real b0_a0_p2_p2_em2 = 0 ;
parameter real a0_a0_p2_p2_em2 = 0 ;
parameter real b0_b0_p3_p2_em2 = 3.04 ;
parameter real a0_b0_p3_p2_em2 = -0.000317 ;
parameter real b0_a0_p3_p2_em2 = 0 ;
parameter real a0_a0_p3_p2_em2 = 0 ;
parameter real b0_b0_p4_p2_em2 = 3.96 ;
parameter real a0_b0_p4_p2_em2 = -0.000614 ;
parameter real b0_a0_p4_p2_em2 = 0 ;
parameter real a0_a0_p4_p2_em2 = 0 ;
parameter real b0_b0_b0_p3_em2 = 6.79 ;
parameter real a0_b0_b0_p3_em2 = 0.0318 ;
parameter real b0_a0_b0_p3_em2 = 0 ;
parameter real a0_a0_b0_p3_em2 = 0 ;
parameter real b0_b0_a0_p3_em2 = 0 ;
parameter real a0_b0_a0_p3_em2 = 0 ;
parameter real b0_a0_a0_p3_em2 = 0 ;
parameter real a0_a0_a0_p3_em2 = 0 ;
parameter real b0_b0_a1_p3_em2 = 2.59 ;
parameter real a0_b0_a1_p3_em2 = 0.00113 ;
parameter real b0_a0_a1_p3_em2 = 0 ;
parameter real a0_a0_a1_p3_em2 = 0 ;
parameter real b0_b0_a2_p3_em2 = -0.142 ;
parameter real a0_b0_a2_p3_em2 = 0.00058 ;
parameter real b0_a0_a2_p3_em2 = 0 ;
parameter real a0_a0_a2_p3_em2 = 0 ;
parameter real b0_b0_a3_p3_em2 = -5.83 ;
parameter real a0_b0_a3_p3_em2 = 0.00774 ;
parameter real b0_a0_a3_p3_em2 = 0 ;
parameter real a0_a0_a3_p3_em2 = 0 ;
parameter real b0_b0_a4_p3_em2 = 0 ;
parameter real a0_b0_a4_p3_em2 = 0 ;
parameter real b0_a0_a4_p3_em2 = 0 ;
parameter real a0_a0_a4_p3_em2 = 0 ;
parameter real b0_b0_p1_p3_em2 = -6.44 ;
parameter real a0_b0_p1_p3_em2 = 0.0106 ;
parameter real b0_a0_p1_p3_em2 = 0 ;
parameter real a0_a0_p1_p3_em2 = 0 ;
parameter real b0_b0_p2_p3_em2 = -0.0982 ;
parameter real a0_b0_p2_p3_em2 = -0.000827 ;
parameter real b0_a0_p2_p3_em2 = 0 ;
parameter real a0_a0_p2_p3_em2 = 0 ;
parameter real b0_b0_p3_p3_em2 = 5.54 ;
parameter real a0_b0_p3_p3_em2 = -0.00496 ;
parameter real b0_a0_p3_p3_em2 = 0 ;
parameter real a0_a0_p3_p3_em2 = 0 ;
parameter real b0_b0_p4_p3_em2 = 4.15 ;
parameter real a0_b0_p4_p3_em2 = 0.00794 ;
parameter real b0_a0_p4_p3_em2 = 0 ;
parameter real a0_a0_p4_p3_em2 = 0 ;
parameter real b0_b0_b0_p4_em2 = 37.3 ;
parameter real a0_b0_b0_p4_em2 = 0.000597 ;
parameter real b0_a0_b0_p4_em2 = 0.0329 ;
parameter real a0_a0_b0_p4_em2 = -8.93E-05 ;
parameter real b0_b0_a0_p4_em2 = 0 ;
parameter real a0_b0_a0_p4_em2 = 0 ;
parameter real b0_a0_a0_p4_em2 = 0 ;
parameter real a0_a0_a0_p4_em2 = 0 ;
parameter real b0_b0_a1_p4_em2 = -72.8 ;
parameter real a0_b0_a1_p4_em2 = 0.305 ;
parameter real b0_a0_a1_p4_em2 = -0.455 ;
parameter real a0_a0_a1_p4_em2 = -5.93E-05 ;
parameter real b0_b0_a2_p4_em2 = -2.04 ;
parameter real a0_b0_a2_p4_em2 = 0.00132 ;
parameter real b0_a0_a2_p4_em2 = -0.0189 ;
parameter real a0_a0_a2_p4_em2 = 4.39E-05 ;
parameter real b0_b0_a3_p4_em2 = 23.5 ;
parameter real a0_b0_a3_p4_em2 = -0.0792 ;
parameter real b0_a0_a3_p4_em2 = -0.157 ;
parameter real a0_a0_a3_p4_em2 = 0.000532 ;
parameter real b0_b0_a4_p4_em2 = 0 ;
parameter real a0_b0_a4_p4_em2 = 0 ;
parameter real b0_a0_a4_p4_em2 = 0 ;
parameter real a0_a0_a4_p4_em2 = 0 ;
parameter real b0_b0_p1_p4_em2 = 2.28 ;
parameter real a0_b0_p1_p4_em2 = -0.00342 ;
parameter real b0_a0_p1_p4_em2 = 0.0392 ;
parameter real a0_a0_p1_p4_em2 = -9.06E-05 ;
parameter real b0_b0_p2_p4_em2 = 2.33 ;
parameter real a0_b0_p2_p4_em2 = -0.00345 ;
parameter real b0_a0_p2_p4_em2 = 0.0389 ;
parameter real a0_a0_p2_p4_em2 = -8.94E-05 ;
parameter real b0_b0_p3_p4_em2 = 1.22 ;
parameter real a0_b0_p3_p4_em2 = 0.00555 ;
parameter real b0_a0_p3_p4_em2 = -0.014 ;
parameter real a0_a0_p3_p4_em2 = 2.67E-05 ;
parameter real b0_b0_p4_p4_em2 = 5.44 ;
parameter real a0_b0_p4_p4_em2 = -0.00233 ;
parameter real b0_a0_p4_p4_em2 = -0.00146 ;
parameter real a0_a0_p4_p4_em2 = 6.28E-06 ;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			
			delta_damage1_3_1 = 0;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				end
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_pld30b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld30b";
parameter string      relimo_probe_name            = "mpowermos";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.234;
parameter real        relimo_alpha3 = 2.16E+28;
parameter real        relimo_beta3 = 2.76;
parameter real        relimo_gama3 = 14.8;
parameter real        relimo_eps3 = 8.91;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 0.751;
parameter real        relimo_rth = 0.00743;
parameter real        relimo_fstat3 = 0.0409;

// parameter for off stat
parameter real        relimo_a1_off = 12.7;
parameter real        relimo_n1_off = 0.15;
parameter real        relimo_a2_off = 2.02;
parameter real        relimo_n2_off = 0.463;
parameter real        relimo_alpha1_off = 93900;
parameter real        relimo_beta1 = 0.229;
parameter real        relimo_ea1 = 0.666;
parameter real        relimo_alpha2_off = 5.61;
parameter real        relimo_beta2 = 0.325;
parameter real        relimo_ea2 = 0.469;
parameter real        fstat_tau1_off = 0.0134;
parameter real        fstat_tau2_off = 0.0707;
parameter real        fstat_tau1tau2_off = 56.3;
parameter real        fstat_tau2tau1_off = 56.3;
parameter real        m_sigma_b_off = 1;
parameter real        delta_m_sigma_b_off = 0.5;
parameter real        m_sigma_a_off = 1;
parameter real        delta_m_sigma_a_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 1.5199;
parameter real        relimo_a2 = 3.4802;
parameter real        relimo_c1 = 288.96;
parameter real        relimo_b = 0.032351;
parameter real        relimo_n_hci = 1.8297;
parameter real        relimo_alpha1 = 0.000404;
parameter real        relimo_m1 = 1.35;
parameter real        relimo_lamda_h0 = 9.56E-07;
parameter real        relimo_alpha2 = 7.86E-31;
parameter real        relimo_m2 = 0.874;
parameter real        relimo_lamda_el0 = 3.25E-07;
parameter real        fstat_tau1 = 0.0299;
parameter real        fstat_tau2 = 0.00269;
parameter real        fstat_tau1tau2 = 152;
parameter real        fstat_tau2tau1 = 152;
parameter real        m_sigma_a = 1;
parameter real        delta_m_sigma_a = 6;
parameter real        m_sigma_b = 1;
parameter real        delta_m_sigma_b = 0.4;
parameter real        vgs_cutoff_HCI = -0.3;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 48300 ;
parameter real a0_b0_b0_a1_em = -40.7 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -580 ;
parameter real a0_b0_a1_a1_em = 0.71 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -1370 ;
parameter real a0_b0_a2_a1_em = -3.46 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 1990 ;
parameter real a0_b0_a3_a1_em = -1.79 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -54.2 ;
parameter real a0_b0_p1_a1_em = 0.00138 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.28 ;
parameter real a0_b0_p2_a1_em = 0.000574 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 2.46 ;
parameter real a0_b0_p3_a1_em = -4.67E-05 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 12500 ;
parameter real a0_b0_b0_a2_em = -1.63 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 966 ;
parameter real a0_b0_a1_a2_em = -1.55 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = -2660 ;
parameter real a0_b0_a2_a2_em = 3.18 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -515 ;
parameter real a0_b0_a3_a2_em = -0.108 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 4.38 ;
parameter real a0_b0_p1_a2_em = -0.0111 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 2.02 ;
parameter real a0_b0_p2_a2_em = -0.002 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 1.98 ;
parameter real a0_b0_p3_a2_em = 0.00105 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 9040 ;
parameter real a0_b0_b0_a3_em = -0.397 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 613 ;
parameter real a0_b0_a1_a3_em = -2.07 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -7430 ;
parameter real a0_b0_a2_a3_em = 1.92 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -3220 ;
parameter real a0_b0_a3_a3_em = 1.16 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = -0.855 ;
parameter real a0_b0_p1_a3_em = 0.00486 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.5 ;
parameter real a0_b0_p2_a3_em = 0.00113 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.31 ;
parameter real a0_b0_p3_a3_em = 0.00125 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 4580 ;
parameter real a0_b0_b0_a4_em = 2.06 ;
parameter real b0_a0_b0_a4_em = -11.6 ;
parameter real a0_a0_b0_a4_em = 0.0349 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 1490 ;
parameter real a0_b0_a1_a4_em = -2.59 ;
parameter real b0_a0_a1_a4_em = 0.349 ;
parameter real a0_a0_a1_a4_em = 0.222 ;
parameter real b0_b0_a2_a4_em = -766 ;
parameter real a0_b0_a2_a4_em = 1.62 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00571 ;
parameter real b0_b0_a3_a4_em = 1280 ;
parameter real a0_b0_a3_a4_em = -2.19 ;
parameter real b0_a0_a3_a4_em = -1.68 ;
parameter real a0_a0_a3_a4_em = 0.00401 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 1.69 ;
parameter real a0_b0_p1_a4_em = -0.000112 ;
parameter real b0_a0_p1_a4_em = 0.00464 ;
parameter real a0_a0_p1_a4_em = -1.99E-05 ;
parameter real b0_b0_p2_a4_em = 1.61 ;
parameter real a0_b0_p2_a4_em = 0.000945 ;
parameter real b0_a0_p2_a4_em = 0.00287 ;
parameter real a0_a0_p2_a4_em = -5.40E-06 ;
parameter real b0_b0_p3_a4_em = 2.43 ;
parameter real a0_b0_p3_a4_em = 0.00368 ;
parameter real b0_a0_p3_a4_em = -0.000645 ;
parameter real a0_a0_p3_a4_em = 4.65E-06 ;
parameter real b0_b0_p4_a4_em = 2.41 ;
parameter real a0_b0_p4_a4_em = 0.00876 ;
parameter real b0_a0_p4_a4_em = -0.0085 ;
parameter real a0_a0_p4_a4_em = 2.18E-05 ;
parameter real b0_b0_b0_p1_em = 1.62 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.216 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -2.41 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 2.69E-05 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1.09 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.55 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.45 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.13 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 11.1 ;
parameter real a0_b0_b0_p2_em = 0.00576 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 1.2 ;
parameter real a0_b0_a1_p2_em = -0.00324 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = -10.7 ;
parameter real a0_b0_a2_p2_em = 0.0153 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -1.46 ;
parameter real a0_b0_a3_p2_em = -0.000321 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.97 ;
parameter real a0_b0_p2_p2_em = 0.000922 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.37 ;
parameter real a0_b0_p3_p2_em = 0.00127 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 4.94 ;
parameter real a0_b0_p4_p2_em = -0.00247 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 16.8 ;
parameter real a0_b0_b0_p3_em = 0.00252 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = -1.61 ;
parameter real a0_b0_a1_p3_em = 0.00304 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = -2.34 ;
parameter real a0_b0_a2_p3_em = -4.87E-05 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0.769 ;
parameter real a0_b0_a3_p3_em = -0.000416 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 2.09 ;
parameter real a0_b0_p1_p3_em = -0.00402 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.58 ;
parameter real a0_b0_p2_p3_em = -0.00036 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 4.83 ;
parameter real a0_b0_p3_p3_em = -0.00136 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 6 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 25.5 ;
parameter real a0_b0_b0_p4_em = -0.0011 ;
parameter real b0_a0_b0_p4_em = 0.02 ;
parameter real a0_a0_b0_p4_em = -6.04E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = -5.22 ;
parameter real a0_b0_a1_p4_em = 0.00888 ;
parameter real b0_a0_a1_p4_em = -0.0275 ;
parameter real a0_a0_a1_p4_em = 7.37E-05 ;
parameter real b0_b0_a2_p4_em = 12.5 ;
parameter real a0_b0_a2_p4_em = -0.0205 ;
parameter real b0_a0_a2_p4_em = 0.00131 ;
parameter real a0_a0_a2_p4_em = 3.13E-06 ;
parameter real b0_b0_a3_p4_em = -5.61 ;
parameter real a0_b0_a3_p4_em = 0.00578 ;
parameter real b0_a0_a3_p4_em = 0.0235 ;
parameter real a0_a0_a3_p4_em = -4.63E-05 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 1.24 ;
parameter real a0_b0_p1_p4_em = -0.000731 ;
parameter real b0_a0_p1_p4_em = 0.00394 ;
parameter real a0_a0_p1_p4_em = -9.11E-06 ;
parameter real b0_b0_p2_p4_em = 2.19 ;
parameter real a0_b0_p2_p4_em = -6.92E-05 ;
parameter real b0_a0_p2_p4_em = -0.00175 ;
parameter real a0_a0_p2_p4_em = 6.09E-06 ;
parameter real b0_b0_p3_p4_em = 2.6 ;
parameter real a0_b0_p3_p4_em = 0.000913 ;
parameter real b0_a0_p3_p4_em = -0.00121 ;
parameter real a0_a0_p3_p4_em = 2.12E-06 ;
parameter real b0_b0_p4_p4_em = 5.04 ;
parameter real a0_b0_p4_p4_em = 0.00206 ;
parameter real b0_a0_p4_p4_em = -0.0222 ;
parameter real a0_a0_p4_p4_em = 6.49E-05 ;

parameter real b0_b0_b0_b0_em2 = 0 ;
parameter real a0_b0_b0_b0_em2 = 0 ;
parameter real b0_a0_b0_b0_em2 = 0 ;
parameter real a0_a0_b0_b0_em2 = 0 ;
parameter real b0_b0_a0_b0_em2 = 0 ;
parameter real a0_b0_a0_b0_em2 = 0 ;
parameter real b0_a0_a0_b0_em2 = 0 ;
parameter real a0_a0_a0_b0_em2 = 0 ;
parameter real b0_b0_a1_b0_em2 = 0 ;
parameter real a0_b0_a1_b0_em2 = 0 ;
parameter real b0_a0_a1_b0_em2 = 0 ;
parameter real a0_a0_a1_b0_em2 = 0 ;
parameter real b0_b0_a2_b0_em2 = 0 ;
parameter real a0_b0_a2_b0_em2 = 0 ;
parameter real b0_a0_a2_b0_em2 = 0 ;
parameter real a0_a0_a2_b0_em2 = 0 ;
parameter real b0_b0_a3_b0_em2 = 0 ;
parameter real a0_b0_a3_b0_em2 = 0 ;
parameter real b0_a0_a3_b0_em2 = 0 ;
parameter real a0_a0_a3_b0_em2 = 0 ;
parameter real b0_b0_a4_b0_em2 = 0 ;
parameter real a0_b0_a4_b0_em2 = 0 ;
parameter real b0_a0_a4_b0_em2 = 0 ;
parameter real a0_a0_a4_b0_em2 = 0 ;
parameter real b0_b0_p1_b0_em2 = 0 ;
parameter real a0_b0_p1_b0_em2 = 0 ;
parameter real b0_a0_p1_b0_em2 = 0 ;
parameter real a0_a0_p1_b0_em2 = 0 ;
parameter real b0_b0_p2_b0_em2 = 0 ;
parameter real a0_b0_p2_b0_em2 = 0 ;
parameter real b0_a0_p2_b0_em2 = 0 ;
parameter real a0_a0_p2_b0_em2 = 0 ;
parameter real b0_b0_p3_b0_em2 = 0 ;
parameter real a0_b0_p3_b0_em2 = 0 ;
parameter real b0_a0_p3_b0_em2 = 0 ;
parameter real a0_a0_p3_b0_em2 = 0 ;
parameter real b0_b0_p4_b0_em2 = 0 ;
parameter real a0_b0_p4_b0_em2 = 0 ;
parameter real b0_a0_p4_b0_em2 = 0 ;
parameter real a0_a0_p4_b0_em2 = 0 ;
parameter real b0_b0_b0_a0_em2 = 0 ;
parameter real a0_b0_b0_a0_em2 = 0 ;
parameter real b0_a0_b0_a0_em2 = 0 ;
parameter real a0_a0_b0_a0_em2 = 0 ;
parameter real b0_b0_a0_a0_em2 = 0 ;
parameter real a0_b0_a0_a0_em2 = 0 ;
parameter real b0_a0_a0_a0_em2 = 0 ;
parameter real a0_a0_a0_a0_em2 = 0 ;
parameter real b0_b0_a1_a0_em2 = 0 ;
parameter real a0_b0_a1_a0_em2 = 0 ;
parameter real b0_a0_a1_a0_em2 = 0 ;
parameter real a0_a0_a1_a0_em2 = 0 ;
parameter real b0_b0_a2_a0_em2 = 0 ;
parameter real a0_b0_a2_a0_em2 = 0 ;
parameter real b0_a0_a2_a0_em2 = 0 ;
parameter real a0_a0_a2_a0_em2 = 0 ;
parameter real b0_b0_a3_a0_em2 = 0 ;
parameter real a0_b0_a3_a0_em2 = 0 ;
parameter real b0_a0_a3_a0_em2 = 0 ;
parameter real a0_a0_a3_a0_em2 = 0 ;
parameter real b0_b0_a4_a0_em2 = 0 ;
parameter real a0_b0_a4_a0_em2 = 0 ;
parameter real b0_a0_a4_a0_em2 = 0 ;
parameter real a0_a0_a4_a0_em2 = 0 ;
parameter real b0_b0_p1_a0_em2 = 0 ;
parameter real a0_b0_p1_a0_em2 = 0 ;
parameter real b0_a0_p1_a0_em2 = 0 ;
parameter real a0_a0_p1_a0_em2 = 0 ;
parameter real b0_b0_p2_a0_em2 = 0 ;
parameter real a0_b0_p2_a0_em2 = 0 ;
parameter real b0_a0_p2_a0_em2 = 0 ;
parameter real a0_a0_p2_a0_em2 = 0 ;
parameter real b0_b0_p3_a0_em2 = 0 ;
parameter real a0_b0_p3_a0_em2 = 0 ;
parameter real b0_a0_p3_a0_em2 = 0 ;
parameter real a0_a0_p3_a0_em2 = 0 ;
parameter real b0_b0_p4_a0_em2 = 0 ;
parameter real a0_b0_p4_a0_em2 = 0 ;
parameter real b0_a0_p4_a0_em2 = 0 ;
parameter real a0_a0_p4_a0_em2 = 0 ;
parameter real b0_b0_b0_a1_em2 = 11900 ;
parameter real a0_b0_b0_a1_em2 = -9.82 ;
parameter real b0_a0_b0_a1_em2 = 0 ;
parameter real a0_a0_b0_a1_em2 = 0 ;
parameter real b0_b0_a0_a1_em2 = 0 ;
parameter real a0_b0_a0_a1_em2 = 0 ;
parameter real b0_a0_a0_a1_em2 = 0 ;
parameter real a0_a0_a0_a1_em2 = 0 ;
parameter real b0_b0_a1_a1_em2 = 3350 ;
parameter real a0_b0_a1_a1_em2 = -0.864 ;
parameter real b0_a0_a1_a1_em2 = 0 ;
parameter real a0_a0_a1_a1_em2 = 0 ;
parameter real b0_b0_a2_a1_em2 = -2220 ;
parameter real a0_b0_a2_a1_em2 = 4.52 ;
parameter real b0_a0_a2_a1_em2 = 0 ;
parameter real a0_a0_a2_a1_em2 = 0 ;
parameter real b0_b0_a3_a1_em2 = -4050 ;
parameter real a0_b0_a3_a1_em2 = 2.43 ;
parameter real b0_a0_a3_a1_em2 = 0 ;
parameter real a0_a0_a3_a1_em2 = 0 ;
parameter real b0_b0_a4_a1_em2 = 0 ;
parameter real a0_b0_a4_a1_em2 = 0 ;
parameter real b0_a0_a4_a1_em2 = 0 ;
parameter real a0_a0_a4_a1_em2 = 0 ;
parameter real b0_b0_p1_a1_em2 = -0.0246 ;
parameter real a0_b0_p1_a1_em2 = -0.00041 ;
parameter real b0_a0_p1_a1_em2 = 0 ;
parameter real a0_a0_p1_a1_em2 = 0 ;
parameter real b0_b0_p2_a1_em2 = 0.975 ;
parameter real a0_b0_p2_a1_em2 = 0.000376 ;
parameter real b0_a0_p2_a1_em2 = 0 ;
parameter real a0_a0_p2_a1_em2 = 0 ;
parameter real b0_b0_p3_a1_em2 = 2.89 ;
parameter real a0_b0_p3_a1_em2 = -0.00123 ;
parameter real b0_a0_p3_a1_em2 = 0 ;
parameter real a0_a0_p3_a1_em2 = 0 ;
parameter real b0_b0_p4_a1_em2 = 3.9 ;
parameter real a0_b0_p4_a1_em2 = -0.0001 ;
parameter real b0_a0_p4_a1_em2 = 0 ;
parameter real a0_a0_p4_a1_em2 = 0 ;
parameter real b0_b0_b0_a2_em2 = 8160 ;
parameter real a0_b0_b0_a2_em2 = 3.34 ;
parameter real b0_a0_b0_a2_em2 = 0 ;
parameter real a0_a0_b0_a2_em2 = 0 ;
parameter real b0_b0_a0_a2_em2 = 0 ;
parameter real a0_b0_a0_a2_em2 = 0 ;
parameter real b0_a0_a0_a2_em2 = 0 ;
parameter real a0_a0_a0_a2_em2 = 0 ;
parameter real b0_b0_a1_a2_em2 = 714 ;
parameter real a0_b0_a1_a2_em2 = 9.39 ;
parameter real b0_a0_a1_a2_em2 = 0 ;
parameter real a0_a0_a1_a2_em2 = 0 ;
parameter real b0_b0_a2_a2_em2 = -3740 ;
parameter real a0_b0_a2_a2_em2 = 4.27 ;
parameter real b0_a0_a2_a2_em2 = 0 ;
parameter real a0_a0_a2_a2_em2 = 0 ;
parameter real b0_b0_a3_a2_em2 = 3050 ;
parameter real a0_b0_a3_a2_em2 = -10.9 ;
parameter real b0_a0_a3_a2_em2 = 0 ;
parameter real a0_a0_a3_a2_em2 = 0 ;
parameter real b0_b0_a4_a2_em2 = 0 ;
parameter real a0_b0_a4_a2_em2 = 0 ;
parameter real b0_a0_a4_a2_em2 = 0 ;
parameter real a0_a0_a4_a2_em2 = 0 ;
parameter real b0_b0_p1_a2_em2 = -0.887 ;
parameter real a0_b0_p1_a2_em2 = 0.00271 ;
parameter real b0_a0_p1_a2_em2 = 0 ;
parameter real a0_a0_p1_a2_em2 = 0 ;
parameter real b0_b0_p2_a2_em2 = 1.31 ;
parameter real a0_b0_p2_a2_em2 = -0.000751 ;
parameter real b0_a0_p2_a2_em2 = 0 ;
parameter real a0_a0_p2_a2_em2 = 0 ;
parameter real b0_b0_p3_a2_em2 = 2.83 ;
parameter real a0_b0_p3_a2_em2 = 0.00258 ;
parameter real b0_a0_p3_a2_em2 = 0 ;
parameter real a0_a0_p3_a2_em2 = 0 ;
parameter real b0_b0_p4_a2_em2 = 4 ;
parameter real a0_b0_p4_a2_em2 = 0 ;
parameter real b0_a0_p4_a2_em2 = 0 ;
parameter real a0_a0_p4_a2_em2 = 0 ;
parameter real b0_b0_b0_a3_em2 = 4270 ;
parameter real a0_b0_b0_a3_em2 = 13.4 ;
parameter real b0_a0_b0_a3_em2 = 0 ;
parameter real a0_a0_b0_a3_em2 = 0 ;
parameter real b0_b0_a0_a3_em2 = 0 ;
parameter real a0_b0_a0_a3_em2 = 0 ;
parameter real b0_a0_a0_a3_em2 = 0 ;
parameter real a0_a0_a0_a3_em2 = 0 ;
parameter real b0_b0_a1_a3_em2 = 514 ;
parameter real a0_b0_a1_a3_em2 = -4.08 ;
parameter real b0_a0_a1_a3_em2 = 0 ;
parameter real a0_a0_a1_a3_em2 = 0 ;
parameter real b0_b0_a2_a3_em2 = 3690 ;
parameter real a0_b0_a2_a3_em2 = -2.09 ;
parameter real b0_a0_a2_a3_em2 = 0 ;
parameter real a0_a0_a2_a3_em2 = 0 ;
parameter real b0_b0_a3_a3_em2 = -993 ;
parameter real a0_b0_a3_a3_em2 = -0.568 ;
parameter real b0_a0_a3_a3_em2 = 0 ;
parameter real a0_a0_a3_a3_em2 = 0 ;
parameter real b0_b0_a4_a3_em2 = 0 ;
parameter real a0_b0_a4_a3_em2 = 0 ;
parameter real b0_a0_a4_a3_em2 = 0 ;
parameter real a0_a0_a4_a3_em2 = 0 ;
parameter real b0_b0_p1_a3_em2 = 0.818 ;
parameter real a0_b0_p1_a3_em2 = -0.00394 ;
parameter real b0_a0_p1_a3_em2 = 0 ;
parameter real a0_a0_p1_a3_em2 = 0 ;
parameter real b0_b0_p2_a3_em2 = 0.281 ;
parameter real a0_b0_p2_a3_em2 = -0.000546 ;
parameter real b0_a0_p2_a3_em2 = 0 ;
parameter real a0_a0_p2_a3_em2 = 0 ;
parameter real b0_b0_p3_a3_em2 = 0.929 ;
parameter real a0_b0_p3_a3_em2 = -0.00049 ;
parameter real b0_a0_p3_a3_em2 = 0 ;
parameter real a0_a0_p3_a3_em2 = 0 ;
parameter real b0_b0_p4_a3_em2 = 4.5 ;
parameter real a0_b0_p4_a3_em2 = 0 ;
parameter real b0_a0_p4_a3_em2 = 0 ;
parameter real a0_a0_p4_a3_em2 = 0 ;
parameter real b0_b0_b0_a4_em2 = 6810 ;
parameter real a0_b0_b0_a4_em2 = -1.6 ;
parameter real b0_a0_b0_a4_em2 = -1.04 ;
parameter real a0_a0_b0_a4_em2 = 0.00305 ;
parameter real b0_b0_a0_a4_em2 = 0 ;
parameter real a0_b0_a0_a4_em2 = 0 ;
parameter real b0_a0_a0_a4_em2 = 0 ;
parameter real a0_a0_a0_a4_em2 = 0 ;
parameter real b0_b0_a1_a4_em2 = -1350 ;
parameter real a0_b0_a1_a4_em2 = 4.74 ;
parameter real b0_a0_a1_a4_em2 = -0.718 ;
parameter real a0_a0_a1_a4_em2 = 0.00231 ;
parameter real b0_b0_a2_a4_em2 = -73.4 ;
parameter real a0_b0_a2_a4_em2 = -2.2 ;
parameter real b0_a0_a2_a4_em2 = 0 ;
parameter real a0_a0_a2_a4_em2 = 0.00588 ;
parameter real b0_b0_a3_a4_em2 = -445 ;
parameter real a0_b0_a3_a4_em2 = 4.15 ;
parameter real b0_a0_a3_a4_em2 = 0.708 ;
parameter real a0_a0_a3_a4_em2 = -0.00966 ;
parameter real b0_b0_a4_a4_em2 = 0 ;
parameter real a0_b0_a4_a4_em2 = 0 ;
parameter real b0_a0_a4_a4_em2 = 0 ;
parameter real a0_a0_a4_a4_em2 = 0 ;
parameter real b0_b0_p1_a4_em2 = -0.011 ;
parameter real a0_b0_p1_a4_em2 = -0.00282 ;
parameter real b0_a0_p1_a4_em2 = 0.00387 ;
parameter real a0_a0_p1_a4_em2 = -8.04E-06 ;
parameter real b0_b0_p2_a4_em2 = -0.19 ;
parameter real a0_b0_p2_a4_em2 = 0.000581 ;
parameter real b0_a0_p2_a4_em2 = 0.00111 ;
parameter real a0_a0_p2_a4_em2 = -3.28E-06 ;
parameter real b0_b0_p3_a4_em2 = 2.19 ;
parameter real a0_b0_p3_a4_em2 = 0.00188 ;
parameter real b0_a0_p3_a4_em2 = -0.00511 ;
parameter real a0_a0_p3_a4_em2 = 1.02E-05 ;
parameter real b0_b0_p4_a4_em2 = 4.39 ;
parameter real a0_b0_p4_a4_em2 = -0.000239 ;
parameter real b0_a0_p4_a4_em2 = 0.00753 ;
parameter real a0_a0_p4_a4_em2 = -1.54E-05 ;
parameter real b0_b0_b0_p1_em2 = 4.7 ;
parameter real a0_b0_b0_p1_em2 = 0 ;
parameter real b0_a0_b0_p1_em2 = 0 ;
parameter real a0_a0_b0_p1_em2 = 0 ;
parameter real b0_b0_a0_p1_em2 = 0 ;
parameter real a0_b0_a0_p1_em2 = 0 ;
parameter real b0_a0_a0_p1_em2 = 0 ;
parameter real a0_a0_a0_p1_em2 = 0 ;
parameter real b0_b0_a1_p1_em2 = 4.15 ;
parameter real a0_b0_a1_p1_em2 = 0 ;
parameter real b0_a0_a1_p1_em2 = 0 ;
parameter real a0_a0_a1_p1_em2 = 0 ;
parameter real b0_b0_a2_p1_em2 = -1.88 ;
parameter real a0_b0_a2_p1_em2 = 0 ;
parameter real b0_a0_a2_p1_em2 = 0 ;
parameter real a0_a0_a2_p1_em2 = 0 ;
parameter real b0_b0_a3_p1_em2 = -5.05 ;
parameter real a0_b0_a3_p1_em2 = 0 ;
parameter real b0_a0_a3_p1_em2 = 0 ;
parameter real a0_a0_a3_p1_em2 = 0 ;
parameter real b0_b0_a4_p1_em2 = 0 ;
parameter real a0_b0_a4_p1_em2 = 0 ;
parameter real b0_a0_a4_p1_em2 = 0 ;
parameter real a0_a0_a4_p1_em2 = 0 ;
parameter real b0_b0_p1_p1_em2 = -0.233 ;
parameter real a0_b0_p1_p1_em2 = 0 ;
parameter real b0_a0_p1_p1_em2 = 0 ;
parameter real a0_a0_p1_p1_em2 = 0 ;
parameter real b0_b0_p2_p1_em2 = 1 ;
parameter real a0_b0_p2_p1_em2 = 0 ;
parameter real b0_a0_p2_p1_em2 = 0 ;
parameter real a0_a0_p2_p1_em2 = 0 ;
parameter real b0_b0_p3_p1_em2 = 2.56 ;
parameter real a0_b0_p3_p1_em2 = 0 ;
parameter real b0_a0_p3_p1_em2 = 0 ;
parameter real a0_a0_p3_p1_em2 = 0 ;
parameter real b0_b0_p4_p1_em2 = 3.9 ;
parameter real a0_b0_p4_p1_em2 = 0 ;
parameter real b0_a0_p4_p1_em2 = 0 ;
parameter real a0_a0_p4_p1_em2 = 0 ;
parameter real b0_b0_b0_p2_em2 = 15 ;
parameter real a0_b0_b0_p2_em2 = 0 ;
parameter real b0_a0_b0_p2_em2 = 0 ;
parameter real a0_a0_b0_p2_em2 = 0 ;
parameter real b0_b0_a0_p2_em2 = 0 ;
parameter real a0_b0_a0_p2_em2 = 0 ;
parameter real b0_a0_a0_p2_em2 = 0 ;
parameter real a0_a0_a0_p2_em2 = 0 ;
parameter real b0_b0_a1_p2_em2 = 0 ;
parameter real a0_b0_a1_p2_em2 = 0 ;
parameter real b0_a0_a1_p2_em2 = 0 ;
parameter real a0_a0_a1_p2_em2 = 0 ;
parameter real b0_b0_a2_p2_em2 = 0 ;
parameter real a0_b0_a2_p2_em2 = 0 ;
parameter real b0_a0_a2_p2_em2 = 0 ;
parameter real a0_a0_a2_p2_em2 = 0 ;
parameter real b0_b0_a3_p2_em2 = 0 ;
parameter real a0_b0_a3_p2_em2 = 0 ;
parameter real b0_a0_a3_p2_em2 = 0 ;
parameter real a0_a0_a3_p2_em2 = 0 ;
parameter real b0_b0_a4_p2_em2 = 0 ;
parameter real a0_b0_a4_p2_em2 = 0 ;
parameter real b0_a0_a4_p2_em2 = 0 ;
parameter real a0_a0_a4_p2_em2 = 0 ;
parameter real b0_b0_p1_p2_em2 = 0 ;
parameter real a0_b0_p1_p2_em2 = 0 ;
parameter real b0_a0_p1_p2_em2 = 0 ;
parameter real a0_a0_p1_p2_em2 = 0 ;
parameter real b0_b0_p2_p2_em2 = 1 ;
parameter real a0_b0_p2_p2_em2 = 0 ;
parameter real b0_a0_p2_p2_em2 = 0 ;
parameter real a0_a0_p2_p2_em2 = 0 ;
parameter real b0_b0_p3_p2_em2 = 2 ;
parameter real a0_b0_p3_p2_em2 = 0 ;
parameter real b0_a0_p3_p2_em2 = 0 ;
parameter real a0_a0_p3_p2_em2 = 0 ;
parameter real b0_b0_p4_p2_em2 = 3 ;
parameter real a0_b0_p4_p2_em2 = 0 ;
parameter real b0_a0_p4_p2_em2 = 0 ;
parameter real a0_a0_p4_p2_em2 = 0 ;
parameter real b0_b0_b0_p3_em2 = 20 ;
parameter real a0_b0_b0_p3_em2 = 0 ;
parameter real b0_a0_b0_p3_em2 = 0 ;
parameter real a0_a0_b0_p3_em2 = 0 ;
parameter real b0_b0_a0_p3_em2 = 0 ;
parameter real a0_b0_a0_p3_em2 = 0 ;
parameter real b0_a0_a0_p3_em2 = 0 ;
parameter real a0_a0_a0_p3_em2 = 0 ;
parameter real b0_b0_a1_p3_em2 = 0 ;
parameter real a0_b0_a1_p3_em2 = 0 ;
parameter real b0_a0_a1_p3_em2 = 0 ;
parameter real a0_a0_a1_p3_em2 = 0 ;
parameter real b0_b0_a2_p3_em2 = 0 ;
parameter real a0_b0_a2_p3_em2 = 0 ;
parameter real b0_a0_a2_p3_em2 = 0 ;
parameter real a0_a0_a2_p3_em2 = 0 ;
parameter real b0_b0_a3_p3_em2 = 0 ;
parameter real a0_b0_a3_p3_em2 = 0 ;
parameter real b0_a0_a3_p3_em2 = 0 ;
parameter real a0_a0_a3_p3_em2 = 0 ;
parameter real b0_b0_a4_p3_em2 = 0 ;
parameter real a0_b0_a4_p3_em2 = 0 ;
parameter real b0_a0_a4_p3_em2 = 0 ;
parameter real a0_a0_a4_p3_em2 = 0 ;
parameter real b0_b0_p1_p3_em2 = 0 ;
parameter real a0_b0_p1_p3_em2 = 0 ;
parameter real b0_a0_p1_p3_em2 = 0 ;
parameter real a0_a0_p1_p3_em2 = 0 ;
parameter real b0_b0_p2_p3_em2 = 1 ;
parameter real a0_b0_p2_p3_em2 = 0 ;
parameter real b0_a0_p2_p3_em2 = 0 ;
parameter real a0_a0_p2_p3_em2 = 0 ;
parameter real b0_b0_p3_p3_em2 = 2 ;
parameter real a0_b0_p3_p3_em2 = 0 ;
parameter real b0_a0_p3_p3_em2 = 0 ;
parameter real a0_a0_p3_p3_em2 = 0 ;
parameter real b0_b0_p4_p3_em2 = 3 ;
parameter real a0_b0_p4_p3_em2 = 0 ;
parameter real b0_a0_p4_p3_em2 = 0 ;
parameter real a0_a0_p4_p3_em2 = 0 ;
parameter real b0_b0_b0_p4_em2 = 24 ;
parameter real a0_b0_b0_p4_em2 = 0.00305 ;
parameter real b0_a0_b0_p4_em2 = 0.00419 ;
parameter real a0_a0_b0_p4_em2 = -1.06E-05 ;
parameter real b0_b0_a0_p4_em2 = 0 ;
parameter real a0_b0_a0_p4_em2 = 0 ;
parameter real b0_a0_a0_p4_em2 = 0 ;
parameter real a0_a0_a0_p4_em2 = 0 ;
parameter real b0_b0_a1_p4_em2 = 3.38 ;
parameter real a0_b0_a1_p4_em2 = -0.00505 ;
parameter real b0_a0_a1_p4_em2 = 0 ;
parameter real a0_a0_a1_p4_em2 = 0 ;
parameter real b0_b0_a2_p4_em2 = 2.74 ;
parameter real a0_b0_a2_p4_em2 = -0.00761 ;
parameter real b0_a0_a2_p4_em2 = 0 ;
parameter real a0_a0_a2_p4_em2 = 0 ;
parameter real b0_b0_a3_p4_em2 = -9.92 ;
parameter real a0_b0_a3_p4_em2 = 0.0464 ;
parameter real b0_a0_a3_p4_em2 = 0 ;
parameter real a0_a0_a3_p4_em2 = 0 ;
parameter real b0_b0_a4_p4_em2 = 0 ;
parameter real a0_b0_a4_p4_em2 = 0 ;
parameter real b0_a0_a4_p4_em2 = 0 ;
parameter real a0_a0_a4_p4_em2 = 0 ;
parameter real b0_b0_p1_p4_em2 = 1.92 ;
parameter real a0_b0_p1_p4_em2 = 0.0224 ;
parameter real b0_a0_p1_p4_em2 = 0 ;
parameter real a0_a0_p1_p4_em2 = 0 ;
parameter real b0_b0_p2_p4_em2 = 2.45 ;
parameter real a0_b0_p2_p4_em2 = 0.0139 ;
parameter real b0_a0_p2_p4_em2 = 0 ;
parameter real a0_a0_p2_p4_em2 = 0 ;
parameter real b0_b0_p3_p4_em2 = 4.6 ;
parameter real a0_b0_p3_p4_em2 = -0.000542 ;
parameter real b0_a0_p3_p4_em2 = 0 ;
parameter real a0_a0_p3_p4_em2 = 0 ;
parameter real b0_b0_p4_p4_em2 = 9.74 ;
parameter real a0_b0_p4_p4_em2 = -0.0153 ;
parameter real b0_a0_p4_p4_em2 = 0 ;
parameter real a0_a0_p4_p4_em2 = 0 ;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vsub > 0 && vsub < 1e-6) begin
				vsub = 1e-6;
			end
			if(vsub < 0 && vsub > -1e-6) begin
				vsub = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			
			delta_damage1_3_1 = 0;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				end
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.106*0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.106*0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_pld10b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld10b";
parameter string      relimo_probe_name            = "mamost";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.24;
parameter real        relimo_alpha3 = 1.28E+7;
parameter real        relimo_beta3 = 5.9e-9;
parameter real        relimo_gama3 = 11.7;
parameter real        relimo_eps3 = 3.7;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 1.28;
parameter real        relimo_rth = 0.0601;
parameter real        relimo_fstat3 = 0.0171;

// parameter for off stat
parameter real        relimo_a1_off = 12.7;
parameter real        relimo_n1_off = 0.15;
parameter real        relimo_a2_off = 2.02;
parameter real        relimo_n2_off = 0.463;
parameter real        relimo_alpha1_off = 93900;
parameter real        relimo_beta1 = 0.229;
parameter real        relimo_ea1 = 0.666;
parameter real        relimo_alpha2_off = 5.61;
parameter real        relimo_beta2 = 0.325;
parameter real        relimo_ea2 = 0.469;
parameter real        fstat_tau1_off = 0.0134;
parameter real        fstat_tau2_off = 0.0707;
parameter real        fstat_tau1tau2_off = 56.3;
parameter real        fstat_tau2tau1_off = 56.3;
parameter real        m_sigma_b_off = 1;
parameter real        delta_m_sigma_b_off = 0.5;
parameter real        m_sigma_a_off = 1;
parameter real        delta_m_sigma_a_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.769;
parameter real        relimo_a2 = 1.83e-8;
parameter real        relimo_c1 = 7.89e12;
parameter real        relimo_b = 4.77;
parameter real        relimo_n_hci = 0.236;
parameter real        relimo_alpha1 = 0.00211;
parameter real        relimo_m1 = 1.18;
parameter real        relimo_lamda_h0 = 4.09E-6;
parameter real        relimo_alpha2 = 0.14;
parameter real        relimo_m2 = 1.18;
parameter real        relimo_lamda_el0 = 2.73E-06;
parameter real        fstat_tau1 = 0.018;
parameter real        fstat_tau2 = 0.018;
parameter real        fstat_tau1tau2 = 1;
parameter real        fstat_tau2tau1 = 1;
parameter real        m_sigma_a = 1;
parameter real        delta_m_sigma_a = 6;
parameter real        m_sigma_b = 1;
parameter real        delta_m_sigma_b = 0.4;
parameter real        vgs_cutoff_HCI = -0.6;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 0.6336;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 1010 ;
parameter real a0_b0_b0_a1_em = 0.00908 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = 5.34 ;
parameter real a0_b0_a1_a1_em = 0.00395 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -7.39 ;
parameter real a0_b0_a2_a1_em = -0.00369 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 5000 ;
parameter real a0_b0_a3_a1_em = -0.00713 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.842 ;
parameter real a0_b0_p1_a1_em = -0.000441 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.5 ;
parameter real a0_b0_p2_a1_em = 0.000898 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3 ;
parameter real a0_b0_p3_a1_em = -0.00176 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 6 ;
parameter real a0_b0_p4_a1_em = 0 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 24200 ;
parameter real a0_b0_b0_a2_em = 13.9 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -2940 ;
parameter real a0_b0_a1_a2_em = -6.55 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 3460 ;
parameter real a0_b0_a2_a2_em = -17.7 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 2300 ;
parameter real a0_b0_a3_a2_em = -0.318 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -1.18 ;
parameter real a0_b0_p1_a2_em = 0.00238 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 4 ;
parameter real a0_b0_p2_a2_em = -0.0112 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 6.53 ;
parameter real a0_b0_p3_a2_em = -0.00537 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 6 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 28500 ;
parameter real a0_b0_b0_a3_em = -7.78 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 5110 ;
parameter real a0_b0_a1_a3_em = -12.7 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -1820 ;
parameter real a0_b0_a2_a3_em = 2.79 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -4090 ;
parameter real a0_b0_a3_a3_em = 0.117 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = -1.07 ;
parameter real a0_b0_p1_a3_em = 0.00538 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0.0341 ;
parameter real a0_b0_p2_a3_em = 0.00216 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.58 ;
parameter real a0_b0_p3_a3_em = 0.00378 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 6 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 12300 ;
parameter real a0_b0_b0_a4_em = 16.8 ;
parameter real b0_a0_b0_a4_em = -0.0175 ;
parameter real a0_a0_b0_a4_em = -0.171 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -1360 ;
parameter real a0_b0_a1_a4_em = 13.6 ;
parameter real b0_a0_a1_a4_em = -0.000497 ;
parameter real a0_a0_a1_a4_em = 0.203 ;
parameter real b0_b0_a2_a4_em = -3260 ;
parameter real a0_b0_a2_a4_em = 15.5 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0318 ;
parameter real b0_b0_a3_a4_em = -6010 ;
parameter real a0_b0_a3_a4_em = 8.15 ;
parameter real b0_a0_a3_a4_em = 0.00471 ;
parameter real a0_a0_a3_a4_em = 0.0382 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = -1.42 ;
parameter real a0_b0_p1_a4_em = 0.000549 ;
parameter real b0_a0_p1_a4_em = 0.55 ;
parameter real a0_a0_p1_a4_em = -0.00166 ;
parameter real b0_b0_p2_a4_em = 5.89 ;
parameter real a0_b0_p2_a4_em = -0.0234 ;
parameter real b0_a0_p2_a4_em = -0.33 ;
parameter real a0_a0_p2_a4_em = 0.0013 ;
parameter real b0_b0_p3_a4_em = 5.73 ;
parameter real a0_b0_p3_a4_em = -0.0103 ;
parameter real b0_a0_p3_a4_em = 0.0191 ;
parameter real a0_a0_p3_a4_em = -5.95E-05 ;
parameter real b0_b0_p4_a4_em = 3.71 ;
parameter real a0_b0_p4_a4_em = 0.00308 ;
parameter real b0_a0_p4_a4_em = 0.00956 ;
parameter real a0_a0_p4_a4_em = 2.32E-06 ;
parameter real b0_b0_b0_p1_em = 2.05 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 22.3 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -1.07 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -2.11 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.2 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.3 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.18 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 3.4 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 4.72 ;
parameter real a0_b0_b0_p2_em = 0.00247 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = -0.549 ;
parameter real a0_b0_a1_p2_em = 0.00244 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0.596 ;
parameter real a0_b0_a2_p2_em = -0.00241 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 2.79 ;
parameter real a0_b0_a3_p2_em = -0.0264 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 4.38 ;
parameter real a0_b0_p2_p2_em = -0.00737 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 3.69 ;
parameter real a0_b0_p3_p2_em = -3.90E-05 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 5.19 ;
parameter real a0_b0_p4_p2_em = -0.00243 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 10 ;
parameter real a0_b0_b0_p3_em = 0 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = -1 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.5 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 4 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 6 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 13.4 ;
parameter real a0_b0_b0_p4_em = 0.0028 ;
parameter real b0_a0_b0_p4_em = 0.0163 ;
parameter real a0_a0_b0_p4_em = 3.54E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 1.32 ;
parameter real a0_b0_a1_p4_em = -0.00399 ;
parameter real b0_a0_a1_p4_em = -0.0222 ;
parameter real a0_a0_a1_p4_em = 5.70E-05 ;
parameter real b0_b0_a2_p4_em = 4.36 ;
parameter real a0_b0_a2_p4_em = -0.00947 ;
parameter real b0_a0_a2_p4_em = 0.00211 ;
parameter real a0_a0_a2_p4_em = -2.04E-05 ;
parameter real b0_b0_a3_p4_em = -3.68 ;
parameter real a0_b0_a3_p4_em = 0.00288 ;
parameter real b0_a0_a3_p4_em = -0.0495 ;
parameter real a0_a0_a3_p4_em = 0.000178 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = -0.453 ;
parameter real a0_b0_p1_p4_em = 0.00529 ;
parameter real b0_a0_p1_p4_em = 0.0436 ;
parameter real a0_a0_p1_p4_em = -0.000176 ;
parameter real b0_b0_p2_p4_em = 3.47 ;
parameter real a0_b0_p2_p4_em = -0.0054 ;
parameter real b0_a0_p2_p4_em = -0.0938 ;
parameter real a0_a0_p2_p4_em = 0.00039 ;
parameter real b0_b0_p3_p4_em = 3.64 ;
parameter real a0_b0_p3_p4_em = -0.00292 ;
parameter real b0_a0_p3_p4_em = -0.0362 ;
parameter real a0_a0_p3_p4_em = 0.000122 ;
parameter real b0_b0_p4_p4_em = 4.16 ;
parameter real a0_b0_p4_p4_em = -0.000635 ;
parameter real b0_a0_p4_p4_em = -0.063 ;
parameter real a0_a0_p4_p4_em = 0.000171 ;

parameter real b0_b0_b0_b0_em2 = 0 ;
parameter real a0_b0_b0_b0_em2 = 0 ;
parameter real b0_a0_b0_b0_em2 = 0 ;
parameter real a0_a0_b0_b0_em2 = 0 ;
parameter real b0_b0_a0_b0_em2 = 0 ;
parameter real a0_b0_a0_b0_em2 = 0 ;
parameter real b0_a0_a0_b0_em2 = 0 ;
parameter real a0_a0_a0_b0_em2 = 0 ;
parameter real b0_b0_a1_b0_em2 = 0 ;
parameter real a0_b0_a1_b0_em2 = 0 ;
parameter real b0_a0_a1_b0_em2 = 0 ;
parameter real a0_a0_a1_b0_em2 = 0 ;
parameter real b0_b0_a2_b0_em2 = 0 ;
parameter real a0_b0_a2_b0_em2 = 0 ;
parameter real b0_a0_a2_b0_em2 = 0 ;
parameter real a0_a0_a2_b0_em2 = 0 ;
parameter real b0_b0_a3_b0_em2 = 0 ;
parameter real a0_b0_a3_b0_em2 = 0 ;
parameter real b0_a0_a3_b0_em2 = 0 ;
parameter real a0_a0_a3_b0_em2 = 0 ;
parameter real b0_b0_a4_b0_em2 = 0 ;
parameter real a0_b0_a4_b0_em2 = 0 ;
parameter real b0_a0_a4_b0_em2 = 0 ;
parameter real a0_a0_a4_b0_em2 = 0 ;
parameter real b0_b0_p1_b0_em2 = 0 ;
parameter real a0_b0_p1_b0_em2 = 0 ;
parameter real b0_a0_p1_b0_em2 = 0 ;
parameter real a0_a0_p1_b0_em2 = 0 ;
parameter real b0_b0_p2_b0_em2 = 0 ;
parameter real a0_b0_p2_b0_em2 = 0 ;
parameter real b0_a0_p2_b0_em2 = 0 ;
parameter real a0_a0_p2_b0_em2 = 0 ;
parameter real b0_b0_p3_b0_em2 = 0 ;
parameter real a0_b0_p3_b0_em2 = 0 ;
parameter real b0_a0_p3_b0_em2 = 0 ;
parameter real a0_a0_p3_b0_em2 = 0 ;
parameter real b0_b0_p4_b0_em2 = 0 ;
parameter real a0_b0_p4_b0_em2 = 0 ;
parameter real b0_a0_p4_b0_em2 = 0 ;
parameter real a0_a0_p4_b0_em2 = 0 ;
parameter real b0_b0_b0_a0_em2 = 0 ;
parameter real a0_b0_b0_a0_em2 = 0 ;
parameter real b0_a0_b0_a0_em2 = 0 ;
parameter real a0_a0_b0_a0_em2 = 0 ;
parameter real b0_b0_a0_a0_em2 = 0 ;
parameter real a0_b0_a0_a0_em2 = 0 ;
parameter real b0_a0_a0_a0_em2 = 0 ;
parameter real a0_a0_a0_a0_em2 = 0 ;
parameter real b0_b0_a1_a0_em2 = 0 ;
parameter real a0_b0_a1_a0_em2 = 0 ;
parameter real b0_a0_a1_a0_em2 = 0 ;
parameter real a0_a0_a1_a0_em2 = 0 ;
parameter real b0_b0_a2_a0_em2 = 0 ;
parameter real a0_b0_a2_a0_em2 = 0 ;
parameter real b0_a0_a2_a0_em2 = 0 ;
parameter real a0_a0_a2_a0_em2 = 0 ;
parameter real b0_b0_a3_a0_em2 = 0 ;
parameter real a0_b0_a3_a0_em2 = 0 ;
parameter real b0_a0_a3_a0_em2 = 0 ;
parameter real a0_a0_a3_a0_em2 = 0 ;
parameter real b0_b0_a4_a0_em2 = 0 ;
parameter real a0_b0_a4_a0_em2 = 0 ;
parameter real b0_a0_a4_a0_em2 = 0 ;
parameter real a0_a0_a4_a0_em2 = 0 ;
parameter real b0_b0_p1_a0_em2 = 0 ;
parameter real a0_b0_p1_a0_em2 = 0 ;
parameter real b0_a0_p1_a0_em2 = 0 ;
parameter real a0_a0_p1_a0_em2 = 0 ;
parameter real b0_b0_p2_a0_em2 = 0 ;
parameter real a0_b0_p2_a0_em2 = 0 ;
parameter real b0_a0_p2_a0_em2 = 0 ;
parameter real a0_a0_p2_a0_em2 = 0 ;
parameter real b0_b0_p3_a0_em2 = 0 ;
parameter real a0_b0_p3_a0_em2 = 0 ;
parameter real b0_a0_p3_a0_em2 = 0 ;
parameter real a0_a0_p3_a0_em2 = 0 ;
parameter real b0_b0_p4_a0_em2 = 0 ;
parameter real a0_b0_p4_a0_em2 = 0 ;
parameter real b0_a0_p4_a0_em2 = 0 ;
parameter real a0_a0_p4_a0_em2 = 0 ;
parameter real b0_b0_b0_a1_em2 = 1010 ;
parameter real a0_b0_b0_a1_em2 = 0.00908 ;
parameter real b0_a0_b0_a1_em2 = 0 ;
parameter real a0_a0_b0_a1_em2 = 0 ;
parameter real b0_b0_a0_a1_em2 = 0 ;
parameter real a0_b0_a0_a1_em2 = 0 ;
parameter real b0_a0_a0_a1_em2 = 0 ;
parameter real a0_a0_a0_a1_em2 = 0 ;
parameter real b0_b0_a1_a1_em2 = 5.34 ;
parameter real a0_b0_a1_a1_em2 = 0.00395 ;
parameter real b0_a0_a1_a1_em2 = 0 ;
parameter real a0_a0_a1_a1_em2 = 0 ;
parameter real b0_b0_a2_a1_em2 = -7.39 ;
parameter real a0_b0_a2_a1_em2 = -0.00369 ;
parameter real b0_a0_a2_a1_em2 = 0 ;
parameter real a0_a0_a2_a1_em2 = 0 ;
parameter real b0_b0_a3_a1_em2 = 5000 ;
parameter real a0_b0_a3_a1_em2 = -0.00713 ;
parameter real b0_a0_a3_a1_em2 = 0 ;
parameter real a0_a0_a3_a1_em2 = 0 ;
parameter real b0_b0_a4_a1_em2 = 0 ;
parameter real a0_b0_a4_a1_em2 = 0 ;
parameter real b0_a0_a4_a1_em2 = 0 ;
parameter real a0_a0_a4_a1_em2 = 0 ;
parameter real b0_b0_p1_a1_em2 = 0.842 ;
parameter real a0_b0_p1_a1_em2 = -0.000441 ;
parameter real b0_a0_p1_a1_em2 = 0 ;
parameter real a0_a0_p1_a1_em2 = 0 ;
parameter real b0_b0_p2_a1_em2 = 1.5 ;
parameter real a0_b0_p2_a1_em2 = 0.000898 ;
parameter real b0_a0_p2_a1_em2 = 0 ;
parameter real a0_a0_p2_a1_em2 = 0 ;
parameter real b0_b0_p3_a1_em2 = 3 ;
parameter real a0_b0_p3_a1_em2 = -0.00176 ;
parameter real b0_a0_p3_a1_em2 = 0 ;
parameter real a0_a0_p3_a1_em2 = 0 ;
parameter real b0_b0_p4_a1_em2 = 6 ;
parameter real a0_b0_p4_a1_em2 = 0 ;
parameter real b0_a0_p4_a1_em2 = 0 ;
parameter real a0_a0_p4_a1_em2 = 0 ;
parameter real b0_b0_b0_a2_em2 = 24200 ;
parameter real a0_b0_b0_a2_em2 = 13.9 ;
parameter real b0_a0_b0_a2_em2 = 0 ;
parameter real a0_a0_b0_a2_em2 = 0 ;
parameter real b0_b0_a0_a2_em2 = 0 ;
parameter real a0_b0_a0_a2_em2 = 0 ;
parameter real b0_a0_a0_a2_em2 = 0 ;
parameter real a0_a0_a0_a2_em2 = 0 ;
parameter real b0_b0_a1_a2_em2 = -2940 ;
parameter real a0_b0_a1_a2_em2 = -6.55 ;
parameter real b0_a0_a1_a2_em2 = 0 ;
parameter real a0_a0_a1_a2_em2 = 0 ;
parameter real b0_b0_a2_a2_em2 = 3460 ;
parameter real a0_b0_a2_a2_em2 = -17.7 ;
parameter real b0_a0_a2_a2_em2 = 0 ;
parameter real a0_a0_a2_a2_em2 = 0 ;
parameter real b0_b0_a3_a2_em2 = 2300 ;
parameter real a0_b0_a3_a2_em2 = -0.318 ;
parameter real b0_a0_a3_a2_em2 = 0 ;
parameter real a0_a0_a3_a2_em2 = 0 ;
parameter real b0_b0_a4_a2_em2 = 0 ;
parameter real a0_b0_a4_a2_em2 = 0 ;
parameter real b0_a0_a4_a2_em2 = 0 ;
parameter real a0_a0_a4_a2_em2 = 0 ;
parameter real b0_b0_p1_a2_em2 = -1.18 ;
parameter real a0_b0_p1_a2_em2 = 0.00238 ;
parameter real b0_a0_p1_a2_em2 = 0 ;
parameter real a0_a0_p1_a2_em2 = 0 ;
parameter real b0_b0_p2_a2_em2 = 4 ;
parameter real a0_b0_p2_a2_em2 = -0.0112 ;
parameter real b0_a0_p2_a2_em2 = 0 ;
parameter real a0_a0_p2_a2_em2 = 0 ;
parameter real b0_b0_p3_a2_em2 = 6.53 ;
parameter real a0_b0_p3_a2_em2 = -0.00537 ;
parameter real b0_a0_p3_a2_em2 = 0 ;
parameter real a0_a0_p3_a2_em2 = 0 ;
parameter real b0_b0_p4_a2_em2 = 6 ;
parameter real a0_b0_p4_a2_em2 = 0 ;
parameter real b0_a0_p4_a2_em2 = 0 ;
parameter real a0_a0_p4_a2_em2 = 0 ;
parameter real b0_b0_b0_a3_em2 = 28500 ;
parameter real a0_b0_b0_a3_em2 = -7.78 ;
parameter real b0_a0_b0_a3_em2 = 0 ;
parameter real a0_a0_b0_a3_em2 = 0 ;
parameter real b0_b0_a0_a3_em2 = 0 ;
parameter real a0_b0_a0_a3_em2 = 0 ;
parameter real b0_a0_a0_a3_em2 = 0 ;
parameter real a0_a0_a0_a3_em2 = 0 ;
parameter real b0_b0_a1_a3_em2 = 5110 ;
parameter real a0_b0_a1_a3_em2 = -12.7 ;
parameter real b0_a0_a1_a3_em2 = 0 ;
parameter real a0_a0_a1_a3_em2 = 0 ;
parameter real b0_b0_a2_a3_em2 = -1820 ;
parameter real a0_b0_a2_a3_em2 = 2.79 ;
parameter real b0_a0_a2_a3_em2 = 0 ;
parameter real a0_a0_a2_a3_em2 = 0 ;
parameter real b0_b0_a3_a3_em2 = -4090 ;
parameter real a0_b0_a3_a3_em2 = 0.117 ;
parameter real b0_a0_a3_a3_em2 = 0 ;
parameter real a0_a0_a3_a3_em2 = 0 ;
parameter real b0_b0_a4_a3_em2 = 0 ;
parameter real a0_b0_a4_a3_em2 = 0 ;
parameter real b0_a0_a4_a3_em2 = 0 ;
parameter real a0_a0_a4_a3_em2 = 0 ;
parameter real b0_b0_p1_a3_em2 = -1.07 ;
parameter real a0_b0_p1_a3_em2 = 0.00538 ;
parameter real b0_a0_p1_a3_em2 = 0 ;
parameter real a0_a0_p1_a3_em2 = 0 ;
parameter real b0_b0_p2_a3_em2 = 0.0341 ;
parameter real a0_b0_p2_a3_em2 = 0.00216 ;
parameter real b0_a0_p2_a3_em2 = 0 ;
parameter real a0_a0_p2_a3_em2 = 0 ;
parameter real b0_b0_p3_a3_em2 = 1.58 ;
parameter real a0_b0_p3_a3_em2 = 0.00378 ;
parameter real b0_a0_p3_a3_em2 = 0 ;
parameter real a0_a0_p3_a3_em2 = 0 ;
parameter real b0_b0_p4_a3_em2 = 6 ;
parameter real a0_b0_p4_a3_em2 = 0 ;
parameter real b0_a0_p4_a3_em2 = 0 ;
parameter real a0_a0_p4_a3_em2 = 0 ;
parameter real b0_b0_b0_a4_em2 = 12300 ;
parameter real a0_b0_b0_a4_em2 = 16.8 ;
parameter real b0_a0_b0_a4_em2 = -0.0175 ;
parameter real a0_a0_b0_a4_em2 = -0.171 ;
parameter real b0_b0_a0_a4_em2 = 0 ;
parameter real a0_b0_a0_a4_em2 = 0 ;
parameter real b0_a0_a0_a4_em2 = 0 ;
parameter real a0_a0_a0_a4_em2 = 0 ;
parameter real b0_b0_a1_a4_em2 = -1360 ;
parameter real a0_b0_a1_a4_em2 = 13.6 ;
parameter real b0_a0_a1_a4_em2 = -0.000497 ;
parameter real a0_a0_a1_a4_em2 = 0.203 ;
parameter real b0_b0_a2_a4_em2 = -3260 ;
parameter real a0_b0_a2_a4_em2 = 15.5 ;
parameter real b0_a0_a2_a4_em2 = 0 ;
parameter real a0_a0_a2_a4_em2 = 0.0318 ;
parameter real b0_b0_a3_a4_em2 = -6010 ;
parameter real a0_b0_a3_a4_em2 = 8.15 ;
parameter real b0_a0_a3_a4_em2 = 0.00471 ;
parameter real a0_a0_a3_a4_em2 = 0.0382 ;
parameter real b0_b0_a4_a4_em2 = 0 ;
parameter real a0_b0_a4_a4_em2 = 0 ;
parameter real b0_a0_a4_a4_em2 = 0 ;
parameter real a0_a0_a4_a4_em2 = 0 ;
parameter real b0_b0_p1_a4_em2 = -1.42 ;
parameter real a0_b0_p1_a4_em2 = 0.000549 ;
parameter real b0_a0_p1_a4_em2 = 0.55 ;
parameter real a0_a0_p1_a4_em2 = -0.00166 ;
parameter real b0_b0_p2_a4_em2 = 5.89 ;
parameter real a0_b0_p2_a4_em2 = -0.0234 ;
parameter real b0_a0_p2_a4_em2 = -0.33 ;
parameter real a0_a0_p2_a4_em2 = 0.0013 ;
parameter real b0_b0_p3_a4_em2 = 5.73 ;
parameter real a0_b0_p3_a4_em2 = -0.0103 ;
parameter real b0_a0_p3_a4_em2 = 0.0191 ;
parameter real a0_a0_p3_a4_em2 = -5.95E-05 ;
parameter real b0_b0_p4_a4_em2 = 3.71 ;
parameter real a0_b0_p4_a4_em2 = 0.00308 ;
parameter real b0_a0_p4_a4_em2 = 0.00956 ;
parameter real a0_a0_p4_a4_em2 = 2.32E-06 ;
parameter real b0_b0_b0_p1_em2 = 2.05 ;
parameter real a0_b0_b0_p1_em2 = 0 ;
parameter real b0_a0_b0_p1_em2 = 0 ;
parameter real a0_a0_b0_p1_em2 = 0 ;
parameter real b0_b0_a0_p1_em2 = 0 ;
parameter real a0_b0_a0_p1_em2 = 0 ;
parameter real b0_a0_a0_p1_em2 = 0 ;
parameter real a0_a0_a0_p1_em2 = 0 ;
parameter real b0_b0_a1_p1_em2 = 22.3 ;
parameter real a0_b0_a1_p1_em2 = 0 ;
parameter real b0_a0_a1_p1_em2 = 0 ;
parameter real a0_a0_a1_p1_em2 = 0 ;
parameter real b0_b0_a2_p1_em2 = -1.07 ;
parameter real a0_b0_a2_p1_em2 = 0 ;
parameter real b0_a0_a2_p1_em2 = 0 ;
parameter real a0_a0_a2_p1_em2 = 0 ;
parameter real b0_b0_a3_p1_em2 = -2.11 ;
parameter real a0_b0_a3_p1_em2 = 0 ;
parameter real b0_a0_a3_p1_em2 = 0 ;
parameter real a0_a0_a3_p1_em2 = 0 ;
parameter real b0_b0_a4_p1_em2 = 0 ;
parameter real a0_b0_a4_p1_em2 = 0 ;
parameter real b0_a0_a4_p1_em2 = 0 ;
parameter real a0_a0_a4_p1_em2 = 0 ;
parameter real b0_b0_p1_p1_em2 = 1.2 ;
parameter real a0_b0_p1_p1_em2 = 0 ;
parameter real b0_a0_p1_p1_em2 = 0 ;
parameter real a0_a0_p1_p1_em2 = 0 ;
parameter real b0_b0_p2_p1_em2 = 1.3 ;
parameter real a0_b0_p2_p1_em2 = 0 ;
parameter real b0_a0_p2_p1_em2 = 0 ;
parameter real a0_a0_p2_p1_em2 = 0 ;
parameter real b0_b0_p3_p1_em2 = 2.18 ;
parameter real a0_b0_p3_p1_em2 = 0 ;
parameter real b0_a0_p3_p1_em2 = 0 ;
parameter real a0_a0_p3_p1_em2 = 0 ;
parameter real b0_b0_p4_p1_em2 = 3.4 ;
parameter real a0_b0_p4_p1_em2 = 0 ;
parameter real b0_a0_p4_p1_em2 = 0 ;
parameter real a0_a0_p4_p1_em2 = 0 ;
parameter real b0_b0_b0_p2_em2 = 4.72 ;
parameter real a0_b0_b0_p2_em2 = 0.00247 ;
parameter real b0_a0_b0_p2_em2 = 0 ;
parameter real a0_a0_b0_p2_em2 = 0 ;
parameter real b0_b0_a0_p2_em2 = 0 ;
parameter real a0_b0_a0_p2_em2 = 0 ;
parameter real b0_a0_a0_p2_em2 = 0 ;
parameter real a0_a0_a0_p2_em2 = 0 ;
parameter real b0_b0_a1_p2_em2 = -0.549 ;
parameter real a0_b0_a1_p2_em2 = 0.00244 ;
parameter real b0_a0_a1_p2_em2 = 0 ;
parameter real a0_a0_a1_p2_em2 = 0 ;
parameter real b0_b0_a2_p2_em2 = 0.596 ;
parameter real a0_b0_a2_p2_em2 = -0.00241 ;
parameter real b0_a0_a2_p2_em2 = 0 ;
parameter real a0_a0_a2_p2_em2 = 0 ;
parameter real b0_b0_a3_p2_em2 = 2.79 ;
parameter real a0_b0_a3_p2_em2 = -0.0264 ;
parameter real b0_a0_a3_p2_em2 = 0 ;
parameter real a0_a0_a3_p2_em2 = 0 ;
parameter real b0_b0_a4_p2_em2 = 0 ;
parameter real a0_b0_a4_p2_em2 = 0 ;
parameter real b0_a0_a4_p2_em2 = 0 ;
parameter real a0_a0_a4_p2_em2 = 0 ;
parameter real b0_b0_p1_p2_em2 = -1 ;
parameter real a0_b0_p1_p2_em2 = 0 ;
parameter real b0_a0_p1_p2_em2 = 0 ;
parameter real a0_a0_p1_p2_em2 = 0 ;
parameter real b0_b0_p2_p2_em2 = 4.38 ;
parameter real a0_b0_p2_p2_em2 = -0.00737 ;
parameter real b0_a0_p2_p2_em2 = 0 ;
parameter real a0_a0_p2_p2_em2 = 0 ;
parameter real b0_b0_p3_p2_em2 = 3.69 ;
parameter real a0_b0_p3_p2_em2 = -3.90E-05 ;
parameter real b0_a0_p3_p2_em2 = 0 ;
parameter real a0_a0_p3_p2_em2 = 0 ;
parameter real b0_b0_p4_p2_em2 = 5.19 ;
parameter real a0_b0_p4_p2_em2 = -0.00243 ;
parameter real b0_a0_p4_p2_em2 = 0 ;
parameter real a0_a0_p4_p2_em2 = 0 ;
parameter real b0_b0_b0_p3_em2 = 10 ;
parameter real a0_b0_b0_p3_em2 = 0 ;
parameter real b0_a0_b0_p3_em2 = 0 ;
parameter real a0_a0_b0_p3_em2 = 0 ;
parameter real b0_b0_a0_p3_em2 = 0 ;
parameter real a0_b0_a0_p3_em2 = 0 ;
parameter real b0_a0_a0_p3_em2 = 0 ;
parameter real a0_a0_a0_p3_em2 = 0 ;
parameter real b0_b0_a1_p3_em2 = 0 ;
parameter real a0_b0_a1_p3_em2 = 0 ;
parameter real b0_a0_a1_p3_em2 = 0 ;
parameter real a0_a0_a1_p3_em2 = 0 ;
parameter real b0_b0_a2_p3_em2 = 0 ;
parameter real a0_b0_a2_p3_em2 = 0 ;
parameter real b0_a0_a2_p3_em2 = 0 ;
parameter real a0_a0_a2_p3_em2 = 0 ;
parameter real b0_b0_a3_p3_em2 = 0 ;
parameter real a0_b0_a3_p3_em2 = 0 ;
parameter real b0_a0_a3_p3_em2 = 0 ;
parameter real a0_a0_a3_p3_em2 = 0 ;
parameter real b0_b0_a4_p3_em2 = 0 ;
parameter real a0_b0_a4_p3_em2 = 0 ;
parameter real b0_a0_a4_p3_em2 = 0 ;
parameter real a0_a0_a4_p3_em2 = 0 ;
parameter real b0_b0_p1_p3_em2 = -1 ;
parameter real a0_b0_p1_p3_em2 = 0 ;
parameter real b0_a0_p1_p3_em2 = 0 ;
parameter real a0_a0_p1_p3_em2 = 0 ;
parameter real b0_b0_p2_p3_em2 = 2.5 ;
parameter real a0_b0_p2_p3_em2 = 0 ;
parameter real b0_a0_p2_p3_em2 = 0 ;
parameter real a0_a0_p2_p3_em2 = 0 ;
parameter real b0_b0_p3_p3_em2 = 4 ;
parameter real a0_b0_p3_p3_em2 = 0 ;
parameter real b0_a0_p3_p3_em2 = 0 ;
parameter real a0_a0_p3_p3_em2 = 0 ;
parameter real b0_b0_p4_p3_em2 = 6 ;
parameter real a0_b0_p4_p3_em2 = 0 ;
parameter real b0_a0_p4_p3_em2 = 0 ;
parameter real a0_a0_p4_p3_em2 = 0 ;
parameter real b0_b0_b0_p4_em2 = 13.4 ;
parameter real a0_b0_b0_p4_em2 = 0.0028 ;
parameter real b0_a0_b0_p4_em2 = 0.0163 ;
parameter real a0_a0_b0_p4_em2 = 3.54E-05 ;
parameter real b0_b0_a0_p4_em2 = 0 ;
parameter real a0_b0_a0_p4_em2 = 0 ;
parameter real b0_a0_a0_p4_em2 = 0 ;
parameter real a0_a0_a0_p4_em2 = 0 ;
parameter real b0_b0_a1_p4_em2 = 1.32 ;
parameter real a0_b0_a1_p4_em2 = -0.00399 ;
parameter real b0_a0_a1_p4_em2 = -0.0222 ;
parameter real a0_a0_a1_p4_em2 = 5.70E-05 ;
parameter real b0_b0_a2_p4_em2 = 4.36 ;
parameter real a0_b0_a2_p4_em2 = -0.00947 ;
parameter real b0_a0_a2_p4_em2 = 0.00211 ;
parameter real a0_a0_a2_p4_em2 = -2.04E-05 ;
parameter real b0_b0_a3_p4_em2 = -3.68 ;
parameter real a0_b0_a3_p4_em2 = 0.00288 ;
parameter real b0_a0_a3_p4_em2 = -0.0495 ;
parameter real a0_a0_a3_p4_em2 = 0.000178 ;
parameter real b0_b0_a4_p4_em2 = 0 ;
parameter real a0_b0_a4_p4_em2 = 0 ;
parameter real b0_a0_a4_p4_em2 = 0 ;
parameter real a0_a0_a4_p4_em2 = 0 ;
parameter real b0_b0_p1_p4_em2 = -0.453 ;
parameter real a0_b0_p1_p4_em2 = 0.00529 ;
parameter real b0_a0_p1_p4_em2 = 0.0436 ;
parameter real a0_a0_p1_p4_em2 = -0.000176 ;
parameter real b0_b0_p2_p4_em2 = 3.47 ;
parameter real a0_b0_p2_p4_em2 = -0.0054 ;
parameter real b0_a0_p2_p4_em2 = -0.0938 ;
parameter real a0_a0_p2_p4_em2 = 0.00039 ;
parameter real b0_b0_p3_p4_em2 = 3.64 ;
parameter real a0_b0_p3_p4_em2 = -0.00292 ;
parameter real b0_a0_p3_p4_em2 = -0.0362 ;
parameter real a0_a0_p3_p4_em2 = 0.000122 ;
parameter real b0_b0_p4_p4_em2 = 4.16 ;
parameter real a0_b0_p4_p4_em2 = -0.000635 ;
parameter real b0_a0_p4_p4_em2 = -0.063 ;
parameter real a0_a0_p4_p4_em2 = 0.000171 ;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vsub > 0 && vsub < 1e-6) begin
				vsub = 1e-6;
			end
			if(vsub < 0 && vsub > -1e-6) begin
				vsub = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));
			
			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));
			
			if (id == 0) begin
				id = id+1e-15;
			end
			
			
			
			delta_damage1_3_1 = 0;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
				end				
				
				// There is no off-state value for this device. To keep above lines for not reporting warning. 
				delta_damage1_3_1 = 0.0;	
				delta_damage1_3_2 = 0.0;
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				end
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.133*0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.133*0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_pmos45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			
parameter real        l               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pmos45b";
parameter string      relimo_probe_name            = "mamost";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.234;
parameter real        relimo_alpha3 = 1.71E+32;
parameter real        relimo_beta3 = 1.64e-7;
parameter real        relimo_gama3 = 21.8;
parameter real        relimo_eps3 = 9.08;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 0.682;
parameter real        relimo_rth = 0.00799;
parameter real        relimo_fstat3 = 0.0986;

// parameter for off stat
parameter real        relimo_a1_off = 7.68;
parameter real        relimo_n1_off = 0.213;
parameter real        relimo_a2_off = 3.75;
parameter real        relimo_n2_off = 0.302;
parameter real        relimo_alpha1_off = 66.8;
parameter real        relimo_beta1 = 0.0975;
parameter real        relimo_ea1 = 0.596;
parameter real        relimo_alpha2_off = 332;
parameter real        relimo_beta2 = 0.144;
parameter real        relimo_ea2 = 0.394;
parameter real        fstat_tau1_off = 0.0198;
parameter real        fstat_tau2_off = 0.0244;
parameter real        fstat_tau1tau2_off = 14.4;
parameter real        fstat_tau2tau1_off = 14.4;
parameter real        m_sigma_b_off = 1;
parameter real        delta_m_sigma_b_off = 0.5;
parameter real        m_sigma_a_off = 1;
parameter real        delta_m_sigma_a_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.28;
parameter real        relimo_a2 = 1.42;
parameter real        relimo_c1 = 3870;
parameter real        relimo_b = 0.000133;
parameter real        relimo_n_hci = 3;
parameter real        relimo_alpha1 = 5.21e-5;
parameter real        relimo_m1 = 0.999;
parameter real        relimo_lamda_h0 = 2.23E-6;
parameter real        relimo_alpha2 = 3.76e-29;
parameter real        relimo_m2 = 0.5;
parameter real        relimo_lamda_el0 = 4.6E-07;
parameter real        fstat_tau1 = 0.00718;
parameter real        fstat_tau2 = 0.00717;
parameter real        fstat_tau1tau2 = 460;
parameter real        fstat_tau2tau1 = 460;
parameter real        m_sigma_a = 1;
parameter real        delta_m_sigma_a = 6;
parameter real        m_sigma_b = 1;
parameter real        delta_m_sigma_b = 0.4;
parameter real        vgs_cutoff_HCI = -0.3;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 0.78;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;
  
parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 17500 ;
parameter real a0_b0_b0_a1_em = -6.37 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = 7520 ;
parameter real a0_b0_a1_a1_em = -3.73 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -2130 ;
parameter real a0_b0_a2_a1_em = 2.24 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -3030 ;
parameter real a0_b0_a3_a1_em = 19.1 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -0.0802 ;
parameter real a0_b0_p1_a1_em = 0.000244 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.17 ;
parameter real a0_b0_p2_a1_em = -0.00075 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.76 ;
parameter real a0_b0_p3_a1_em = -0.000303 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 5650 ;
parameter real a0_b0_b0_a2_em = -0.0946 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -3020 ;
parameter real a0_b0_a1_a2_em = 43.7 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = -879 ;
parameter real a0_b0_a2_a2_em = 0.736 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -1120 ;
parameter real a0_b0_a3_a2_em = -4.61 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.286 ;
parameter real a0_b0_p1_a2_em = 0.000103 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 0.536 ;
parameter real a0_b0_p2_a2_em = -0.000153 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3.97 ;
parameter real a0_b0_p3_a2_em = -0.000551 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 3360 ;
parameter real a0_b0_b0_a3_em = 0.181 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 2920 ;
parameter real a0_b0_a1_a3_em = -4.55 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -695 ;
parameter real a0_b0_a2_a3_em = 1.58 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -4790 ;
parameter real a0_b0_a3_a3_em = 1.6 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.0896 ;
parameter real a0_b0_p1_a3_em = -1.24E-05 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0.321 ;
parameter real a0_b0_p2_a3_em = 0.000648 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 2.96 ;
parameter real a0_b0_p3_a3_em = -0.000183 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2210 ;
parameter real a0_b0_b0_a4_em = -0.595 ;
parameter real b0_a0_b0_a4_em = -0.651 ;
parameter real a0_a0_b0_a4_em = 0.00184 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -130 ;
parameter real a0_b0_a1_a4_em = -0.632 ;
parameter real b0_a0_a1_a4_em = 1.74 ;
parameter real a0_a0_a1_a4_em = -0.00594 ;
parameter real b0_b0_a2_a4_em = 1770 ;
parameter real a0_b0_a2_a4_em = 0.153 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00156 ;
parameter real b0_b0_a3_a4_em = -22.5 ;
parameter real a0_b0_a3_a4_em = 0.102 ;
parameter real b0_a0_a3_a4_em = 0.619 ;
parameter real a0_a0_a3_a4_em = -0.00158 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = -2.09 ;
parameter real a0_b0_p1_a4_em = 0.00332 ;
parameter real b0_a0_p1_a4_em = 0.00392 ;
parameter real a0_a0_p1_a4_em = -9.15E-06 ;
parameter real b0_b0_p2_a4_em = -0.0679 ;
parameter real a0_b0_p2_a4_em = 2.20E-05 ;
parameter real b0_a0_p2_a4_em = 0.000391 ;
parameter real a0_a0_p2_a4_em = -1.16E-06 ;
parameter real b0_b0_p3_a4_em = 0.14 ;
parameter real a0_b0_p3_a4_em = -0.000166 ;
parameter real b0_a0_p3_a4_em = -0.00201 ;
parameter real a0_a0_p3_a4_em = 5.26E-06 ;
parameter real b0_b0_p4_a4_em = 11.1 ;
parameter real a0_b0_p4_a4_em = -0.0104 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = 6.28 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 6.82 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.00446 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 0.817 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -0.037 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 0.532 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.82 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 1.92 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 10.8 ;
parameter real a0_b0_b0_p2_em = 0.00224 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.764 ;
parameter real a0_b0_a1_p2_em = -0.00124 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 2.91 ;
parameter real a0_b0_a2_p2_em = -0.0485 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 0.913 ;
parameter real a0_b0_a3_p2_em = -0.00123 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 2.71 ;
parameter real a0_b0_p2_p2_em = 0.00025 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.89 ;
parameter real a0_b0_p3_p2_em = 1.35E-06 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2.97 ;
parameter real a0_b0_p4_p2_em = 0.00355 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 19.4 ;
parameter real a0_b0_b0_p3_em = 0.00254 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0.0291 ;
parameter real a0_b0_a1_p3_em = 0.00745 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 1.74 ;
parameter real a0_b0_a2_p3_em = 0.00387 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -2.39 ;
parameter real a0_b0_a3_p3_em = 0.00404 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 3.71 ;
parameter real a0_b0_p1_p3_em = -0.00218 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.17 ;
parameter real a0_b0_p2_p3_em = -0.00215 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 4.49 ;
parameter real a0_b0_p3_p3_em = -0.00358 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 3.83 ;
parameter real a0_b0_p4_p3_em = 0.00402 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 28.9 ;
parameter real a0_b0_b0_p4_em = 0.0108 ;
parameter real b0_a0_b0_p4_em = -0.0347 ;
parameter real a0_a0_b0_p4_em = 8.99E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 1.4 ;
parameter real a0_b0_a1_p4_em = -0.00475 ;
parameter real b0_a0_a1_p4_em = 0.0106 ;
parameter real a0_a0_a1_p4_em = -2.55E-05 ;
parameter real b0_b0_a2_p4_em = 11.9 ;
parameter real a0_b0_a2_p4_em = -0.0106 ;
parameter real b0_a0_a2_p4_em = -0.0271 ;
parameter real a0_a0_a2_p4_em = 7.81E-05 ;
parameter real b0_b0_a3_p4_em = -5.27 ;
parameter real a0_b0_a3_p4_em = 0.00181 ;
parameter real b0_a0_a3_p4_em = -0.00506 ;
parameter real a0_a0_a3_p4_em = 1.34E-05 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = -3.23 ;
parameter real a0_b0_p1_p4_em = 0.00417 ;
parameter real b0_a0_p1_p4_em = 0.0335 ;
parameter real a0_a0_p1_p4_em = -9.28E-05 ;
parameter real b0_b0_p2_p4_em = 2.37 ;
parameter real a0_b0_p2_p4_em = 0.000953 ;
parameter real b0_a0_p2_p4_em = 0.000539 ;
parameter real a0_a0_p2_p4_em = -8.65E-07 ;
parameter real b0_b0_p3_p4_em = 2.42 ;
parameter real a0_b0_p3_p4_em = 0.00213 ;
parameter real b0_a0_p3_p4_em = 0.000306 ;
parameter real a0_a0_p3_p4_em = -1.09E-06 ;
parameter real b0_b0_p4_p4_em = 5.19 ;
parameter real a0_b0_p4_p4_em = -0.000374 ;
parameter real b0_a0_p4_p4_em = 0.00251 ;
parameter real a0_a0_p4_p4_em = -6.21E-06 ;

parameter real b0_b0_b0_b0_em2 = 0 ;
parameter real a0_b0_b0_b0_em2 = 0 ;
parameter real b0_a0_b0_b0_em2 = 0 ;
parameter real a0_a0_b0_b0_em2 = 0 ;
parameter real b0_b0_a0_b0_em2 = 0 ;
parameter real a0_b0_a0_b0_em2 = 0 ;
parameter real b0_a0_a0_b0_em2 = 0 ;
parameter real a0_a0_a0_b0_em2 = 0 ;
parameter real b0_b0_a1_b0_em2 = 0 ;
parameter real a0_b0_a1_b0_em2 = 0 ;
parameter real b0_a0_a1_b0_em2 = 0 ;
parameter real a0_a0_a1_b0_em2 = 0 ;
parameter real b0_b0_a2_b0_em2 = 0 ;
parameter real a0_b0_a2_b0_em2 = 0 ;
parameter real b0_a0_a2_b0_em2 = 0 ;
parameter real a0_a0_a2_b0_em2 = 0 ;
parameter real b0_b0_a3_b0_em2 = 0 ;
parameter real a0_b0_a3_b0_em2 = 0 ;
parameter real b0_a0_a3_b0_em2 = 0 ;
parameter real a0_a0_a3_b0_em2 = 0 ;
parameter real b0_b0_a4_b0_em2 = 0 ;
parameter real a0_b0_a4_b0_em2 = 0 ;
parameter real b0_a0_a4_b0_em2 = 0 ;
parameter real a0_a0_a4_b0_em2 = 0 ;
parameter real b0_b0_p1_b0_em2 = 0 ;
parameter real a0_b0_p1_b0_em2 = 0 ;
parameter real b0_a0_p1_b0_em2 = 0 ;
parameter real a0_a0_p1_b0_em2 = 0 ;
parameter real b0_b0_p2_b0_em2 = 0 ;
parameter real a0_b0_p2_b0_em2 = 0 ;
parameter real b0_a0_p2_b0_em2 = 0 ;
parameter real a0_a0_p2_b0_em2 = 0 ;
parameter real b0_b0_p3_b0_em2 = 0 ;
parameter real a0_b0_p3_b0_em2 = 0 ;
parameter real b0_a0_p3_b0_em2 = 0 ;
parameter real a0_a0_p3_b0_em2 = 0 ;
parameter real b0_b0_p4_b0_em2 = 0 ;
parameter real a0_b0_p4_b0_em2 = 0 ;
parameter real b0_a0_p4_b0_em2 = 0 ;
parameter real a0_a0_p4_b0_em2 = 0 ;
parameter real b0_b0_b0_a0_em2 = 0 ;
parameter real a0_b0_b0_a0_em2 = 0 ;
parameter real b0_a0_b0_a0_em2 = 0 ;
parameter real a0_a0_b0_a0_em2 = 0 ;
parameter real b0_b0_a0_a0_em2 = 0 ;
parameter real a0_b0_a0_a0_em2 = 0 ;
parameter real b0_a0_a0_a0_em2 = 0 ;
parameter real a0_a0_a0_a0_em2 = 0 ;
parameter real b0_b0_a1_a0_em2 = 0 ;
parameter real a0_b0_a1_a0_em2 = 0 ;
parameter real b0_a0_a1_a0_em2 = 0 ;
parameter real a0_a0_a1_a0_em2 = 0 ;
parameter real b0_b0_a2_a0_em2 = 0 ;
parameter real a0_b0_a2_a0_em2 = 0 ;
parameter real b0_a0_a2_a0_em2 = 0 ;
parameter real a0_a0_a2_a0_em2 = 0 ;
parameter real b0_b0_a3_a0_em2 = 0 ;
parameter real a0_b0_a3_a0_em2 = 0 ;
parameter real b0_a0_a3_a0_em2 = 0 ;
parameter real a0_a0_a3_a0_em2 = 0 ;
parameter real b0_b0_a4_a0_em2 = 0 ;
parameter real a0_b0_a4_a0_em2 = 0 ;
parameter real b0_a0_a4_a0_em2 = 0 ;
parameter real a0_a0_a4_a0_em2 = 0 ;
parameter real b0_b0_p1_a0_em2 = 0 ;
parameter real a0_b0_p1_a0_em2 = 0 ;
parameter real b0_a0_p1_a0_em2 = 0 ;
parameter real a0_a0_p1_a0_em2 = 0 ;
parameter real b0_b0_p2_a0_em2 = 0 ;
parameter real a0_b0_p2_a0_em2 = 0 ;
parameter real b0_a0_p2_a0_em2 = 0 ;
parameter real a0_a0_p2_a0_em2 = 0 ;
parameter real b0_b0_p3_a0_em2 = 0 ;
parameter real a0_b0_p3_a0_em2 = 0 ;
parameter real b0_a0_p3_a0_em2 = 0 ;
parameter real a0_a0_p3_a0_em2 = 0 ;
parameter real b0_b0_p4_a0_em2 = 0 ;
parameter real a0_b0_p4_a0_em2 = 0 ;
parameter real b0_a0_p4_a0_em2 = 0 ;
parameter real a0_a0_p4_a0_em2 = 0 ;
parameter real b0_b0_b0_a1_em2 = 12700 ;
parameter real a0_b0_b0_a1_em2 = -10.7 ;
parameter real b0_a0_b0_a1_em2 = 0 ;
parameter real a0_a0_b0_a1_em2 = 0 ;
parameter real b0_b0_a0_a1_em2 = 0 ;
parameter real a0_b0_a0_a1_em2 = 0 ;
parameter real b0_a0_a0_a1_em2 = 0 ;
parameter real a0_a0_a0_a1_em2 = 0 ;
parameter real b0_b0_a1_a1_em2 = -1750 ;
parameter real a0_b0_a1_a1_em2 = 0.442 ;
parameter real b0_a0_a1_a1_em2 = 0 ;
parameter real a0_a0_a1_a1_em2 = 0 ;
parameter real b0_b0_a2_a1_em2 = 3830 ;
parameter real a0_b0_a2_a1_em2 = -4.95 ;
parameter real b0_a0_a2_a1_em2 = 0 ;
parameter real a0_a0_a2_a1_em2 = 0 ;
parameter real b0_b0_a3_a1_em2 = -5270 ;
parameter real a0_b0_a3_a1_em2 = 6.23 ;
parameter real b0_a0_a3_a1_em2 = 0 ;
parameter real a0_a0_a3_a1_em2 = 0 ;
parameter real b0_b0_a4_a1_em2 = 0 ;
parameter real a0_b0_a4_a1_em2 = 0 ;
parameter real b0_a0_a4_a1_em2 = 0 ;
parameter real a0_a0_a4_a1_em2 = 0 ;
parameter real b0_b0_p1_a1_em2 = -2.05 ;
parameter real a0_b0_p1_a1_em2 = 0.00798 ;
parameter real b0_a0_p1_a1_em2 = 0 ;
parameter real a0_a0_p1_a1_em2 = 0 ;
parameter real b0_b0_p2_a1_em2 = 0.845 ;
parameter real a0_b0_p2_a1_em2 = 0.00205 ;
parameter real b0_a0_p2_a1_em2 = 0 ;
parameter real a0_a0_p2_a1_em2 = 0 ;
parameter real b0_b0_p3_a1_em2 = 3.31 ;
parameter real a0_b0_p3_a1_em2 = -0.000216 ;
parameter real b0_a0_p3_a1_em2 = 0 ;
parameter real a0_a0_p3_a1_em2 = 0 ;
parameter real b0_b0_p4_a1_em2 = 5 ;
parameter real a0_b0_p4_a1_em2 = 0 ;
parameter real b0_a0_p4_a1_em2 = 0 ;
parameter real a0_a0_p4_a1_em2 = 0 ;
parameter real b0_b0_b0_a2_em2 = 4410 ;
parameter real a0_b0_b0_a2_em2 = 6.2 ;
parameter real b0_a0_b0_a2_em2 = 0 ;
parameter real a0_a0_b0_a2_em2 = 0 ;
parameter real b0_b0_a0_a2_em2 = 0 ;
parameter real a0_b0_a0_a2_em2 = 0 ;
parameter real b0_a0_a0_a2_em2 = 0 ;
parameter real a0_a0_a0_a2_em2 = 0 ;
parameter real b0_b0_a1_a2_em2 = -107 ;
parameter real a0_b0_a1_a2_em2 = 0.023 ;
parameter real b0_a0_a1_a2_em2 = 0 ;
parameter real a0_a0_a1_a2_em2 = 0 ;
parameter real b0_b0_a2_a2_em2 = -3.74 ;
parameter real a0_b0_a2_a2_em2 = 0.00353 ;
parameter real b0_a0_a2_a2_em2 = 0 ;
parameter real a0_a0_a2_a2_em2 = 0 ;
parameter real b0_b0_a3_a2_em2 = 2.19 ;
parameter real a0_b0_a3_a2_em2 = -0.00231 ;
parameter real b0_a0_a3_a2_em2 = 0 ;
parameter real a0_a0_a3_a2_em2 = 0 ;
parameter real b0_b0_a4_a2_em2 = 0 ;
parameter real a0_b0_a4_a2_em2 = 0 ;
parameter real b0_a0_a4_a2_em2 = 0 ;
parameter real a0_a0_a4_a2_em2 = 0 ;
parameter real b0_b0_p1_a2_em2 = 1.13 ;
parameter real a0_b0_p1_a2_em2 = 0.0276 ;
parameter real b0_a0_p1_a2_em2 = 0 ;
parameter real a0_a0_p1_a2_em2 = 0 ;
parameter real b0_b0_p2_a2_em2 = 2.01 ;
parameter real a0_b0_p2_a2_em2 = -0.0214 ;
parameter real b0_a0_p2_a2_em2 = 0 ;
parameter real a0_a0_p2_a2_em2 = 0 ;
parameter real b0_b0_p3_a2_em2 = 3 ;
parameter real a0_b0_p3_a2_em2 = 0 ;
parameter real b0_a0_p3_a2_em2 = 0 ;
parameter real a0_a0_p3_a2_em2 = 0 ;
parameter real b0_b0_p4_a2_em2 = 5 ;
parameter real a0_b0_p4_a2_em2 = 0 ;
parameter real b0_a0_p4_a2_em2 = 0 ;
parameter real a0_a0_p4_a2_em2 = 0 ;
parameter real b0_b0_b0_a3_em2 = 2600 ;
parameter real a0_b0_b0_a3_em2 = 1.85 ;
parameter real b0_a0_b0_a3_em2 = 0 ;
parameter real a0_a0_b0_a3_em2 = 0 ;
parameter real b0_b0_a0_a3_em2 = 0 ;
parameter real a0_b0_a0_a3_em2 = 0 ;
parameter real b0_a0_a0_a3_em2 = 0 ;
parameter real a0_a0_a0_a3_em2 = 0 ;
parameter real b0_b0_a1_a3_em2 = 5760 ;
parameter real a0_b0_a1_a3_em2 = -10.4 ;
parameter real b0_a0_a1_a3_em2 = 0 ;
parameter real a0_a0_a1_a3_em2 = 0 ;
parameter real b0_b0_a2_a3_em2 = -488 ;
parameter real a0_b0_a2_a3_em2 = 1.6 ;
parameter real b0_a0_a2_a3_em2 = 0 ;
parameter real a0_a0_a2_a3_em2 = 0 ;
parameter real b0_b0_a3_a3_em2 = -3740 ;
parameter real a0_b0_a3_a3_em2 = 5.84 ;
parameter real b0_a0_a3_a3_em2 = 0 ;
parameter real a0_a0_a3_a3_em2 = 0 ;
parameter real b0_b0_a4_a3_em2 = 0 ;
parameter real a0_b0_a4_a3_em2 = 0 ;
parameter real b0_a0_a4_a3_em2 = 0 ;
parameter real a0_a0_a4_a3_em2 = 0 ;
parameter real b0_b0_p1_a3_em2 = 0.222 ;
parameter real a0_b0_p1_a3_em2 = 0.00232 ;
parameter real b0_a0_p1_a3_em2 = 0 ;
parameter real a0_a0_p1_a3_em2 = 0 ;
parameter real b0_b0_p2_a3_em2 = -0.0694 ;
parameter real a0_b0_p2_a3_em2 = 0.00467 ;
parameter real b0_a0_p2_a3_em2 = 0 ;
parameter real a0_a0_p2_a3_em2 = 0 ;
parameter real b0_b0_p3_a3_em2 = 6.79 ;
parameter real a0_b0_p3_a3_em2 = -0.00521 ;
parameter real b0_a0_p3_a3_em2 = 0 ;
parameter real a0_a0_p3_a3_em2 = 0 ;
parameter real b0_b0_p4_a3_em2 = 6 ;
parameter real a0_b0_p4_a3_em2 = 0 ;
parameter real b0_a0_p4_a3_em2 = 0 ;
parameter real a0_a0_p4_a3_em2 = 0 ;
parameter real b0_b0_b0_a4_em2 = 1890 ;
parameter real a0_b0_b0_a4_em2 = 1.26 ;
parameter real b0_a0_b0_a4_em2 = 0.0113 ;
parameter real a0_a0_b0_a4_em2 = 0.00637 ;
parameter real b0_b0_a0_a4_em2 = 0 ;
parameter real a0_b0_a0_a4_em2 = 0 ;
parameter real b0_a0_a0_a4_em2 = 0 ;
parameter real a0_a0_a0_a4_em2 = 0 ;
parameter real b0_b0_a1_a4_em2 = 1350 ;
parameter real a0_b0_a1_a4_em2 = -5.49 ;
parameter real b0_a0_a1_a4_em2 = -0.0285 ;
parameter real a0_a0_a1_a4_em2 = -0.0088 ;
parameter real b0_b0_a2_a4_em2 = -2820 ;
parameter real a0_b0_a2_a4_em2 = 10 ;
parameter real b0_a0_a2_a4_em2 = 0 ;
parameter real a0_a0_a2_a4_em2 = -0.0146 ;
parameter real b0_b0_a3_a4_em2 = 510 ;
parameter real a0_b0_a3_a4_em2 = -0.542 ;
parameter real b0_a0_a3_a4_em2 = 0.017 ;
parameter real a0_a0_a3_a4_em2 = 0.000791 ;
parameter real b0_b0_a4_a4_em2 = 0 ;
parameter real a0_b0_a4_a4_em2 = 0 ;
parameter real b0_a0_a4_a4_em2 = 0 ;
parameter real a0_a0_a4_a4_em2 = 0 ;
parameter real b0_b0_p1_a4_em2 = -0.778 ;
parameter real a0_b0_p1_a4_em2 = 0.00281 ;
parameter real b0_a0_p1_a4_em2 = 0.00153 ;
parameter real a0_a0_p1_a4_em2 = -3.44E-06 ;
parameter real b0_b0_p2_a4_em2 = 1.84 ;
parameter real a0_b0_p2_a4_em2 = -0.00109 ;
parameter real b0_a0_p2_a4_em2 = 0.00274 ;
parameter real a0_a0_p2_a4_em2 = -6.44E-06 ;
parameter real b0_b0_p3_a4_em2 = 2.78 ;
parameter real a0_b0_p3_a4_em2 = -0.00266 ;
parameter real b0_a0_p3_a4_em2 = 0.00388 ;
parameter real a0_a0_p3_a4_em2 = -9.07E-06 ;
parameter real b0_b0_p4_a4_em2 = 1.77 ;
parameter real a0_b0_p4_a4_em2 = 0.00658 ;
parameter real b0_a0_p4_a4_em2 = 0.0127 ;
parameter real a0_a0_p4_a4_em2 = -4.66E-05 ;
parameter real b0_b0_b0_p1_em2 = 5.22 ;
parameter real a0_b0_b0_p1_em2 = 0 ;
parameter real b0_a0_b0_p1_em2 = 0 ;
parameter real a0_a0_b0_p1_em2 = 0 ;
parameter real b0_b0_a0_p1_em2 = 0 ;
parameter real a0_b0_a0_p1_em2 = 0 ;
parameter real b0_a0_a0_p1_em2 = 0 ;
parameter real a0_a0_a0_p1_em2 = 0 ;
parameter real b0_b0_a1_p1_em2 = 0.000244 ;
parameter real a0_b0_a1_p1_em2 = 0 ;
parameter real b0_a0_a1_p1_em2 = 0 ;
parameter real a0_a0_a1_p1_em2 = 0 ;
parameter real b0_b0_a2_p1_em2 = 3.02 ;
parameter real a0_b0_a2_p1_em2 = 0 ;
parameter real b0_a0_a2_p1_em2 = 0 ;
parameter real a0_a0_a2_p1_em2 = 0 ;
parameter real b0_b0_a3_p1_em2 = -2.66 ;
parameter real a0_b0_a3_p1_em2 = 0 ;
parameter real b0_a0_a3_p1_em2 = 0 ;
parameter real a0_a0_a3_p1_em2 = 0 ;
parameter real b0_b0_a4_p1_em2 = 0 ;
parameter real a0_b0_a4_p1_em2 = 0 ;
parameter real b0_a0_a4_p1_em2 = 0 ;
parameter real a0_a0_a4_p1_em2 = 0 ;
parameter real b0_b0_p1_p1_em2 = 0.798 ;
parameter real a0_b0_p1_p1_em2 = 0 ;
parameter real b0_a0_p1_p1_em2 = 0 ;
parameter real a0_a0_p1_p1_em2 = 0 ;
parameter real b0_b0_p2_p1_em2 = 1.28 ;
parameter real a0_b0_p2_p1_em2 = 0 ;
parameter real b0_a0_p2_p1_em2 = 0 ;
parameter real a0_a0_p2_p1_em2 = 0 ;
parameter real b0_b0_p3_p1_em2 = 3.29 ;
parameter real a0_b0_p3_p1_em2 = 0 ;
parameter real b0_a0_p3_p1_em2 = 0 ;
parameter real a0_a0_p3_p1_em2 = 0 ;
parameter real b0_b0_p4_p1_em2 = 5.4 ;
parameter real a0_b0_p4_p1_em2 = 0 ;
parameter real b0_a0_p4_p1_em2 = 0 ;
parameter real a0_a0_p4_p1_em2 = 0 ;
parameter real b0_b0_b0_p2_em2 = 18 ;
parameter real a0_b0_b0_p2_em2 = 0 ;
parameter real b0_a0_b0_p2_em2 = 0 ;
parameter real a0_a0_b0_p2_em2 = 0 ;
parameter real b0_b0_a0_p2_em2 = 0 ;
parameter real a0_b0_a0_p2_em2 = 0 ;
parameter real b0_a0_a0_p2_em2 = 0 ;
parameter real a0_a0_a0_p2_em2 = 0 ;
parameter real b0_b0_a1_p2_em2 = 0 ;
parameter real a0_b0_a1_p2_em2 = 0 ;
parameter real b0_a0_a1_p2_em2 = 0 ;
parameter real a0_a0_a1_p2_em2 = 0 ;
parameter real b0_b0_a2_p2_em2 = 0 ;
parameter real a0_b0_a2_p2_em2 = 0 ;
parameter real b0_a0_a2_p2_em2 = 0 ;
parameter real a0_a0_a2_p2_em2 = 0 ;
parameter real b0_b0_a3_p2_em2 = 0 ;
parameter real a0_b0_a3_p2_em2 = 0 ;
parameter real b0_a0_a3_p2_em2 = 0 ;
parameter real a0_a0_a3_p2_em2 = 0 ;
parameter real b0_b0_a4_p2_em2 = 0 ;
parameter real a0_b0_a4_p2_em2 = 0 ;
parameter real b0_a0_a4_p2_em2 = 0 ;
parameter real a0_a0_a4_p2_em2 = 0 ;
parameter real b0_b0_p1_p2_em2 = 0 ;
parameter real a0_b0_p1_p2_em2 = 0 ;
parameter real b0_a0_p1_p2_em2 = 0 ;
parameter real a0_a0_p1_p2_em2 = 0 ;
parameter real b0_b0_p2_p2_em2 = 2 ;
parameter real a0_b0_p2_p2_em2 = 0 ;
parameter real b0_a0_p2_p2_em2 = 0 ;
parameter real a0_a0_p2_p2_em2 = 0 ;
parameter real b0_b0_p3_p2_em2 = 3 ;
parameter real a0_b0_p3_p2_em2 = 0 ;
parameter real b0_a0_p3_p2_em2 = 0 ;
parameter real a0_a0_p3_p2_em2 = 0 ;
parameter real b0_b0_p4_p2_em2 = 4 ;
parameter real a0_b0_p4_p2_em2 = 0 ;
parameter real b0_a0_p4_p2_em2 = 0 ;
parameter real a0_a0_p4_p2_em2 = 0 ;
parameter real b0_b0_b0_p3_em2 = 19.8 ;
parameter real a0_b0_b0_p3_em2 = 0.00692 ;
parameter real b0_a0_b0_p3_em2 = 0 ;
parameter real a0_a0_b0_p3_em2 = 0 ;
parameter real b0_b0_a0_p3_em2 = 0 ;
parameter real a0_b0_a0_p3_em2 = 0 ;
parameter real b0_a0_a0_p3_em2 = 0 ;
parameter real a0_a0_a0_p3_em2 = 0 ;
parameter real b0_b0_a1_p3_em2 = -11.5 ;
parameter real a0_b0_a1_p3_em2 = 0.0295 ;
parameter real b0_a0_a1_p3_em2 = 0 ;
parameter real a0_a0_a1_p3_em2 = 0 ;
parameter real b0_b0_a2_p3_em2 = -4 ;
parameter real a0_b0_a2_p3_em2 = 0.0109 ;
parameter real b0_a0_a2_p3_em2 = 0 ;
parameter real a0_a0_a2_p3_em2 = 0 ;
parameter real b0_b0_a3_p3_em2 = 3.56 ;
parameter real a0_b0_a3_p3_em2 = -0.016 ;
parameter real b0_a0_a3_p3_em2 = 0 ;
parameter real a0_a0_a3_p3_em2 = 0 ;
parameter real b0_b0_a4_p3_em2 = 0 ;
parameter real a0_b0_a4_p3_em2 = 0 ;
parameter real b0_a0_a4_p3_em2 = 0 ;
parameter real a0_a0_a4_p3_em2 = 0 ;
parameter real b0_b0_p1_p3_em2 = -2.62 ;
parameter real a0_b0_p1_p3_em2 = 0.0113 ;
parameter real b0_a0_p1_p3_em2 = 0 ;
parameter real a0_a0_p1_p3_em2 = 0 ;
parameter real b0_b0_p2_p3_em2 = -3.84 ;
parameter real a0_b0_p2_p3_em2 = 0.013 ;
parameter real b0_a0_p2_p3_em2 = 0 ;
parameter real a0_a0_p2_p3_em2 = 0 ;
parameter real b0_b0_p3_p3_em2 = 2.21 ;
parameter real a0_b0_p3_p3_em2 = 0.00228 ;
parameter real b0_a0_p3_p3_em2 = 0 ;
parameter real a0_a0_p3_p3_em2 = 0 ;
parameter real b0_b0_p4_p3_em2 = 5.14 ;
parameter real a0_b0_p4_p3_em2 = -0.00163 ;
parameter real b0_a0_p4_p3_em2 = 0 ;
parameter real a0_a0_p4_p3_em2 = 0 ;
parameter real b0_b0_b0_p4_em2 = 39.6 ;
parameter real a0_b0_b0_p4_em2 = -0.00211 ;
parameter real b0_a0_b0_p4_em2 = 0.0279 ;
parameter real a0_a0_b0_p4_em2 = -9.48E-05 ;
parameter real b0_b0_a0_p4_em2 = 0 ;
parameter real a0_b0_a0_p4_em2 = 0 ;
parameter real b0_a0_a0_p4_em2 = 0 ;
parameter real a0_a0_a0_p4_em2 = 0 ;
parameter real b0_b0_a1_p4_em2 = -2.46 ;
parameter real a0_b0_a1_p4_em2 = 0.00453 ;
parameter real b0_a0_a1_p4_em2 = -0.0465 ;
parameter real a0_a0_a1_p4_em2 = 0.000104 ;
parameter real b0_b0_a2_p4_em2 = -0.108 ;
parameter real a0_b0_a2_p4_em2 = -0.0101 ;
parameter real b0_a0_a2_p4_em2 = -0.107 ;
parameter real a0_a0_a2_p4_em2 = 0.000262 ;
parameter real b0_b0_a3_p4_em2 = -1.11 ;
parameter real a0_b0_a3_p4_em2 = -0.00392 ;
parameter real b0_a0_a3_p4_em2 = 0.0167 ;
parameter real a0_a0_a3_p4_em2 = -4.83E-05 ;
parameter real b0_b0_a4_p4_em2 = 0 ;
parameter real a0_b0_a4_p4_em2 = 0 ;
parameter real b0_a0_a4_p4_em2 = 0 ;
parameter real a0_a0_a4_p4_em2 = 0 ;
parameter real b0_b0_p1_p4_em2 = 4.76 ;
parameter real a0_b0_p1_p4_em2 = -0.0074 ;
parameter real b0_a0_p1_p4_em2 = -0.0176 ;
parameter real a0_a0_p1_p4_em2 = 4.86E-05 ;
parameter real b0_b0_p2_p4_em2 = -2.99 ;
parameter real a0_b0_p2_p4_em2 = 0.0103 ;
parameter real b0_a0_p2_p4_em2 = 0.0428 ;
parameter real a0_a0_p2_p4_em2 = -9.86E-05 ;
parameter real b0_b0_p3_p4_em2 = 1.58 ;
parameter real a0_b0_p3_p4_em2 = 0.00157 ;
parameter real b0_a0_p3_p4_em2 = 0.00454 ;
parameter real a0_a0_p3_p4_em2 = -8.88E-06 ;
parameter real b0_b0_p4_p4_em2 = 5.31 ;
parameter real a0_b0_p4_p4_em2 = -0.00228 ;
parameter real b0_a0_p4_p4_em2 = 0.0237 ;
parameter real a0_a0_p4_p4_em2 = -6.33E-05 ;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vsub > 0 && vsub < 1e-6) begin
				vsub = 1e-6;
			end
			if(vsub < 0 && vsub > -1e-6) begin
				vsub = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));
			
			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));
			
			if (id == 0) begin
				id = id+1e-15;
			end
			
			
			
			delta_damage1_3_1 = 0*relimo_ratio21_a;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				end
			//$display("Zhichen Debug 111 %e, %e, %e, %e, %e", 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)), pow(abs(vgs),-1.0*relimo_gama3), pow(abs(vds),-1.0*relimo_eps3), exp(-1.0*relimo_eta3*abs(vsub)), exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -1.0*0/(0.5523*l+13.733), 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3*l+1.0));
			//$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(0.283*l+1.1706));
			//$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(-0.0013*pow(l,2)+0.3219*l+1.0071));
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n",0.0037*1/l+0.9906);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -1.0*0/(0.5523*l+13.733), 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3*l+1.0));
			//$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(0.283*l+1.1706));
			//$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(-0.0013*pow(l,2)+0.3219*l+1.0071));
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 0.0037*1/l+0.9906);
			
		end	
	end
end
endmodule

module relimo_aging_hci_pmoshs45b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			
parameter real        l               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pmoshs45b";
parameter string      relimo_probe_name            = "mamost";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.233;
parameter real        relimo_alpha3 = 1.89E+33;
parameter real        relimo_beta3 = 3.17e-5;
parameter real        relimo_gama3 = 22.7;
parameter real        relimo_eps3 = 8.94;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 0.559;
parameter real        relimo_rth = 0.00295;
parameter real        relimo_fstat3 = 0.135;

// parameter for off stat
parameter real        relimo_a1_off = 0.859;
parameter real        relimo_n1_off = 1;
parameter real        relimo_a2_off = 0.692;
parameter real        relimo_n2_off = 0.64;
parameter real        relimo_alpha1_off = 3.82e5;
parameter real        relimo_beta1 = 0.191;
parameter real        relimo_ea1 = 0.388;
parameter real        relimo_alpha2_off = 2.72e14;
parameter real        relimo_beta2 = 0.497;
parameter real        relimo_ea2 = 6.64e-12;
parameter real        fstat_tau1_off = 0.00799;
parameter real        fstat_tau2_off = 0.00178;
parameter real        fstat_tau1tau2_off = 1120;
parameter real        fstat_tau2tau1_off = 1120;
parameter real        m_sigma_b_off = 1;
parameter real        delta_m_sigma_b_off = 0.5;
parameter real        m_sigma_a_off = 1;
parameter real        delta_m_sigma_a_off = 0.1;

// parameter for HCIHV
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.328;
parameter real        relimo_a2 = 1.87;
parameter real        relimo_c1 = 1750;
parameter real        relimo_b = 0.00021;
parameter real        relimo_n_hci = 3;
parameter real        relimo_alpha1 = 3.31e-8;
parameter real        relimo_m1 = 1.09;
parameter real        relimo_lamda_h0 = 9.75E-7;
parameter real        relimo_alpha2 = 1.02e-29;
parameter real        relimo_m2 = 1.82;
parameter real        relimo_lamda_el0 = 3.57E-07;
parameter real        fstat_tau1 = 0.00602;
parameter real        fstat_tau2 = 0.00649;
parameter real        fstat_tau1tau2 = 444;
parameter real        fstat_tau2tau1 = 444;
parameter real        m_sigma_a = 1;
parameter real        delta_m_sigma_a = 6;
parameter real        m_sigma_b = 1;
parameter real        delta_m_sigma_b = 0.4;
parameter real        vgs_cutoff_HCI = -0.3;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 0.78;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 81900 ;
parameter real a0_b0_b0_a1_em = -105 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -847 ;
parameter real a0_b0_a1_a1_em = 0.00699 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3330 ;
parameter real a0_b0_a2_a1_em = 2.56 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -1480 ;
parameter real a0_b0_a3_a1_em = -5.49 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -76.1 ;
parameter real a0_b0_p1_a1_em = 0.12 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 2.62 ;
parameter real a0_b0_p2_a1_em = -0.0026 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.45 ;
parameter real a0_b0_p3_a1_em = -0.000367 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 7060 ;
parameter real a0_b0_b0_a2_em = 2.16 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 2400 ;
parameter real a0_b0_a1_a2_em = -3.25 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 332 ;
parameter real a0_b0_a2_a2_em = -4.87 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -1540 ;
parameter real a0_b0_a3_a2_em = 0.892 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = -100 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -1.7 ;
parameter real a0_b0_p1_a2_em = 0.00894 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = -1.22 ;
parameter real a0_b0_p2_a2_em = 0.00962 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3.72 ;
parameter real a0_b0_p3_a2_em = 0.0171 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4.5 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 2770 ;
parameter real a0_b0_b0_a3_em = 1.24 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = -199 ;
parameter real a0_b0_a1_a3_em = -1.26 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = -3090 ;
parameter real a0_b0_a2_a3_em = -0.0858 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -452 ;
parameter real a0_b0_a3_a3_em = 2.1 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.86 ;
parameter real a0_b0_p1_a3_em = -0.00116 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.34 ;
parameter real a0_b0_p2_a3_em = 0.000838 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 2.25 ;
parameter real a0_b0_p3_a3_em = 0.000197 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 3 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2050 ;
parameter real a0_b0_b0_a4_em = -0.0289 ;
parameter real b0_a0_b0_a4_em = 0.026 ;
parameter real a0_a0_b0_a4_em = -2.36E-06 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 3840 ;
parameter real a0_b0_a1_a4_em = -8.21 ;
parameter real b0_a0_a1_a4_em = 0.000587 ;
parameter real a0_a0_a1_a4_em = 8.50E-05 ;
parameter real b0_b0_a2_a4_em = -1080 ;
parameter real a0_b0_a2_a4_em = 2 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.000693 ;
parameter real b0_b0_a3_a4_em = 756 ;
parameter real a0_b0_a3_a4_em = 0.167 ;
parameter real b0_a0_a3_a4_em = -0.00087 ;
parameter real a0_a0_a3_a4_em = -1.86E-05 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 3.62 ;
parameter real a0_b0_p1_a4_em = -0.00109 ;
parameter real b0_a0_p1_a4_em = -0.000502 ;
parameter real a0_a0_p1_a4_em = 4.02E-06 ;
parameter real b0_b0_p2_a4_em = 3.97 ;
parameter real a0_b0_p2_a4_em = -0.00054 ;
parameter real b0_a0_p2_a4_em = -0.000209 ;
parameter real a0_a0_p2_a4_em = -2.47E-06 ;
parameter real b0_b0_p3_a4_em = 3.92 ;
parameter real a0_b0_p3_a4_em = 0.00193 ;
parameter real b0_a0_p3_a4_em = 0.000182 ;
parameter real a0_a0_p3_a4_em = 2.95E-06 ;
parameter real b0_b0_p4_a4_em = 6 ;
parameter real a0_b0_p4_a4_em = -6.94E-06 ;
parameter real b0_a0_p4_a4_em = 0.00197 ;
parameter real a0_a0_p4_a4_em = -5.04E-06 ;
parameter real b0_b0_b0_p1_em = 4.51 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.383 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.905 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -3.02 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1.03 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.78 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.98 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4.46 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 13.9 ;
parameter real a0_b0_b0_p2_em = -0.000133 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = -0.5 ;
parameter real a0_b0_a1_p2_em = 0.002 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = -7.08 ;
parameter real a0_b0_a2_p2_em = -0.00387 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = -7.78 ;
parameter real a0_b0_a3_p2_em = 0.0575 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 3.85 ;
parameter real a0_b0_p2_p2_em = -0.00254 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 4.27 ;
parameter real a0_b0_p3_p2_em = -0.00148 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 5.28 ;
parameter real a0_b0_p4_p2_em = -0.0028 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 22 ;
parameter real a0_b0_b0_p3_em = -0.0328 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = -0.17 ;
parameter real a0_b0_a1_p3_em = 0.00397 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 6.91 ;
parameter real a0_b0_a2_p3_em = -0.0157 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -3.66 ;
parameter real a0_b0_a3_p3_em = 0.00871 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = -9.66 ;
parameter real a0_b0_p1_p3_em = 0.00279 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0.582 ;
parameter real a0_b0_p2_p3_em = 0.00374 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 1.22 ;
parameter real a0_b0_p3_p3_em = 0.00552 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 6 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 31.4 ;
parameter real a0_b0_b0_p4_em = 0.00765 ;
parameter real b0_a0_b0_p4_em = -0.00471 ;
parameter real a0_a0_b0_p4_em = 1.24E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 12.4 ;
parameter real a0_b0_a1_p4_em = -0.0237 ;
parameter real b0_a0_a1_p4_em = 0.000214 ;
parameter real a0_a0_a1_p4_em = 1.10E-05 ;
parameter real b0_b0_a2_p4_em = 4.66 ;
parameter real a0_b0_a2_p4_em = -0.0114 ;
parameter real b0_a0_a2_p4_em = 0.00673 ;
parameter real a0_a0_a2_p4_em = -2.21E-05 ;
parameter real b0_b0_a3_p4_em = 1.52 ;
parameter real a0_b0_a3_p4_em = -0.000852 ;
parameter real b0_a0_a3_p4_em = 0.000678 ;
parameter real a0_a0_a3_p4_em = -6.98E-07 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 2.39 ;
parameter real a0_b0_p1_p4_em = -0.00216 ;
parameter real b0_a0_p1_p4_em = 0.00127 ;
parameter real a0_a0_p1_p4_em = 1.48E-05 ;
parameter real b0_b0_p2_p4_em = 2.04 ;
parameter real a0_b0_p2_p4_em = -0.00371 ;
parameter real b0_a0_p2_p4_em = 0.00082 ;
parameter real a0_a0_p2_p4_em = 1.84E-05 ;
parameter real b0_b0_p3_p4_em = 1.78 ;
parameter real a0_b0_p3_p4_em = 0.0035 ;
parameter real b0_a0_p3_p4_em = 0.00618 ;
parameter real a0_a0_p3_p4_em = -1.84E-05 ;
parameter real b0_b0_p4_p4_em = 4.43 ;
parameter real a0_b0_p4_p4_em = 0.00411 ;
parameter real b0_a0_p4_p4_em = -0.000269 ;
parameter real a0_a0_p4_p4_em = -1.56E-06 ;

parameter real b0_b0_b0_b0_em2 = 0 ;
parameter real a0_b0_b0_b0_em2 = 0 ;
parameter real b0_a0_b0_b0_em2 = 0 ;
parameter real a0_a0_b0_b0_em2 = 0 ;
parameter real b0_b0_a0_b0_em2 = 0 ;
parameter real a0_b0_a0_b0_em2 = 0 ;
parameter real b0_a0_a0_b0_em2 = 0 ;
parameter real a0_a0_a0_b0_em2 = 0 ;
parameter real b0_b0_a1_b0_em2 = 0 ;
parameter real a0_b0_a1_b0_em2 = 0 ;
parameter real b0_a0_a1_b0_em2 = 0 ;
parameter real a0_a0_a1_b0_em2 = 0 ;
parameter real b0_b0_a2_b0_em2 = 0 ;
parameter real a0_b0_a2_b0_em2 = 0 ;
parameter real b0_a0_a2_b0_em2 = 0 ;
parameter real a0_a0_a2_b0_em2 = 0 ;
parameter real b0_b0_a3_b0_em2 = 0 ;
parameter real a0_b0_a3_b0_em2 = 0 ;
parameter real b0_a0_a3_b0_em2 = 0 ;
parameter real a0_a0_a3_b0_em2 = 0 ;
parameter real b0_b0_a4_b0_em2 = 0 ;
parameter real a0_b0_a4_b0_em2 = 0 ;
parameter real b0_a0_a4_b0_em2 = 0 ;
parameter real a0_a0_a4_b0_em2 = 0 ;
parameter real b0_b0_p1_b0_em2 = 0 ;
parameter real a0_b0_p1_b0_em2 = 0 ;
parameter real b0_a0_p1_b0_em2 = 0 ;
parameter real a0_a0_p1_b0_em2 = 0 ;
parameter real b0_b0_p2_b0_em2 = 0 ;
parameter real a0_b0_p2_b0_em2 = 0 ;
parameter real b0_a0_p2_b0_em2 = 0 ;
parameter real a0_a0_p2_b0_em2 = 0 ;
parameter real b0_b0_p3_b0_em2 = 0 ;
parameter real a0_b0_p3_b0_em2 = 0 ;
parameter real b0_a0_p3_b0_em2 = 0 ;
parameter real a0_a0_p3_b0_em2 = 0 ;
parameter real b0_b0_p4_b0_em2 = 0 ;
parameter real a0_b0_p4_b0_em2 = 0 ;
parameter real b0_a0_p4_b0_em2 = 0 ;
parameter real a0_a0_p4_b0_em2 = 0 ;
parameter real b0_b0_b0_a0_em2 = 0 ;
parameter real a0_b0_b0_a0_em2 = 0 ;
parameter real b0_a0_b0_a0_em2 = 0 ;
parameter real a0_a0_b0_a0_em2 = 0 ;
parameter real b0_b0_a0_a0_em2 = 0 ;
parameter real a0_b0_a0_a0_em2 = 0 ;
parameter real b0_a0_a0_a0_em2 = 0 ;
parameter real a0_a0_a0_a0_em2 = 0 ;
parameter real b0_b0_a1_a0_em2 = 0 ;
parameter real a0_b0_a1_a0_em2 = 0 ;
parameter real b0_a0_a1_a0_em2 = 0 ;
parameter real a0_a0_a1_a0_em2 = 0 ;
parameter real b0_b0_a2_a0_em2 = 0 ;
parameter real a0_b0_a2_a0_em2 = 0 ;
parameter real b0_a0_a2_a0_em2 = 0 ;
parameter real a0_a0_a2_a0_em2 = 0 ;
parameter real b0_b0_a3_a0_em2 = 0 ;
parameter real a0_b0_a3_a0_em2 = 0 ;
parameter real b0_a0_a3_a0_em2 = 0 ;
parameter real a0_a0_a3_a0_em2 = 0 ;
parameter real b0_b0_a4_a0_em2 = 0 ;
parameter real a0_b0_a4_a0_em2 = 0 ;
parameter real b0_a0_a4_a0_em2 = 0 ;
parameter real a0_a0_a4_a0_em2 = 0 ;
parameter real b0_b0_p1_a0_em2 = 0 ;
parameter real a0_b0_p1_a0_em2 = 0 ;
parameter real b0_a0_p1_a0_em2 = 0 ;
parameter real a0_a0_p1_a0_em2 = 0 ;
parameter real b0_b0_p2_a0_em2 = 0 ;
parameter real a0_b0_p2_a0_em2 = 0 ;
parameter real b0_a0_p2_a0_em2 = 0 ;
parameter real a0_a0_p2_a0_em2 = 0 ;
parameter real b0_b0_p3_a0_em2 = 0 ;
parameter real a0_b0_p3_a0_em2 = 0 ;
parameter real b0_a0_p3_a0_em2 = 0 ;
parameter real a0_a0_p3_a0_em2 = 0 ;
parameter real b0_b0_p4_a0_em2 = 0 ;
parameter real a0_b0_p4_a0_em2 = 0 ;
parameter real b0_a0_p4_a0_em2 = 0 ;
parameter real a0_a0_p4_a0_em2 = 0 ;
parameter real b0_b0_b0_a1_em2 = 18000 ;
parameter real a0_b0_b0_a1_em2 = -1.13 ;
parameter real b0_a0_b0_a1_em2 = 0 ;
parameter real a0_a0_b0_a1_em2 = 0 ;
parameter real b0_b0_a0_a1_em2 = 0 ;
parameter real a0_b0_a0_a1_em2 = 0 ;
parameter real b0_a0_a0_a1_em2 = 0 ;
parameter real a0_a0_a0_a1_em2 = 0 ;
parameter real b0_b0_a1_a1_em2 = -4700 ;
parameter real a0_b0_a1_a1_em2 = -3 ;
parameter real b0_a0_a1_a1_em2 = 0 ;
parameter real a0_a0_a1_a1_em2 = 0 ;
parameter real b0_b0_a2_a1_em2 = -4280 ;
parameter real a0_b0_a2_a1_em2 = 1.21 ;
parameter real b0_a0_a2_a1_em2 = 0 ;
parameter real a0_a0_a2_a1_em2 = 0 ;
parameter real b0_b0_a3_a1_em2 = -6810 ;
parameter real a0_b0_a3_a1_em2 = 13.4 ;
parameter real b0_a0_a3_a1_em2 = 0 ;
parameter real a0_a0_a3_a1_em2 = 0 ;
parameter real b0_b0_a4_a1_em2 = 0 ;
parameter real a0_b0_a4_a1_em2 = 0 ;
parameter real b0_a0_a4_a1_em2 = 0 ;
parameter real a0_a0_a4_a1_em2 = 0 ;
parameter real b0_b0_p1_a1_em2 = 1.69 ;
parameter real a0_b0_p1_a1_em2 = 9.27E-05 ;
parameter real b0_a0_p1_a1_em2 = 0 ;
parameter real a0_a0_p1_a1_em2 = 0 ;
parameter real b0_b0_p2_a1_em2 = 1.84 ;
parameter real a0_b0_p2_a1_em2 = 0.00126 ;
parameter real b0_a0_p2_a1_em2 = 0 ;
parameter real a0_a0_p2_a1_em2 = 0 ;
parameter real b0_b0_p3_a1_em2 = 4.02 ;
parameter real a0_b0_p3_a1_em2 = -0.000463 ;
parameter real b0_a0_p3_a1_em2 = 0 ;
parameter real a0_a0_p3_a1_em2 = 0 ;
parameter real b0_b0_p4_a1_em2 = 4 ;
parameter real a0_b0_p4_a1_em2 = 0 ;
parameter real b0_a0_p4_a1_em2 = 0 ;
parameter real a0_a0_p4_a1_em2 = 0 ;
parameter real b0_b0_b0_a2_em2 = 7990 ;
parameter real a0_b0_b0_a2_em2 = 0.584 ;
parameter real b0_a0_b0_a2_em2 = 0 ;
parameter real a0_a0_b0_a2_em2 = 0 ;
parameter real b0_b0_a0_a2_em2 = 0 ;
parameter real a0_b0_a0_a2_em2 = 0 ;
parameter real b0_a0_a0_a2_em2 = 0 ;
parameter real a0_a0_a0_a2_em2 = 0 ;
parameter real b0_b0_a1_a2_em2 = -3650 ;
parameter real a0_b0_a1_a2_em2 = 4.54 ;
parameter real b0_a0_a1_a2_em2 = 0 ;
parameter real a0_a0_a1_a2_em2 = 0 ;
parameter real b0_b0_a2_a2_em2 = -1700 ;
parameter real a0_b0_a2_a2_em2 = 0.0665 ;
parameter real b0_a0_a2_a2_em2 = 0 ;
parameter real a0_a0_a2_a2_em2 = 0 ;
parameter real b0_b0_a3_a2_em2 = -5880 ;
parameter real a0_b0_a3_a2_em2 = 4.1 ;
parameter real b0_a0_a3_a2_em2 = 0 ;
parameter real a0_a0_a3_a2_em2 = 0 ;
parameter real b0_b0_a4_a2_em2 = 0 ;
parameter real a0_b0_a4_a2_em2 = 0 ;
parameter real b0_a0_a4_a2_em2 = 0 ;
parameter real a0_a0_a4_a2_em2 = 0 ;
parameter real b0_b0_p1_a2_em2 = 2.39 ;
parameter real a0_b0_p1_a2_em2 = -0.000126 ;
parameter real b0_a0_p1_a2_em2 = 0 ;
parameter real a0_a0_p1_a2_em2 = 0 ;
parameter real b0_b0_p2_a2_em2 = 2.09 ;
parameter real a0_b0_p2_a2_em2 = 0.00092 ;
parameter real b0_a0_p2_a2_em2 = 0 ;
parameter real a0_a0_p2_a2_em2 = 0 ;
parameter real b0_b0_p3_a2_em2 = 4.25 ;
parameter real a0_b0_p3_a2_em2 = -0.000852 ;
parameter real b0_a0_p3_a2_em2 = 0 ;
parameter real a0_a0_p3_a2_em2 = 0 ;
parameter real b0_b0_p4_a2_em2 = 4.5 ;
parameter real a0_b0_p4_a2_em2 = 0 ;
parameter real b0_a0_p4_a2_em2 = 0 ;
parameter real a0_a0_p4_a2_em2 = 0 ;
parameter real b0_b0_b0_a3_em2 = 3500 ;
parameter real a0_b0_b0_a3_em2 = 78.7 ;
parameter real b0_a0_b0_a3_em2 = 0 ;
parameter real a0_a0_b0_a3_em2 = 0 ;
parameter real b0_b0_a0_a3_em2 = 0 ;
parameter real a0_b0_a0_a3_em2 = 0 ;
parameter real b0_a0_a0_a3_em2 = 0 ;
parameter real a0_a0_a0_a3_em2 = 0 ;
parameter real b0_b0_a1_a3_em2 = -158 ;
parameter real a0_b0_a1_a3_em2 = 0.000922 ;
parameter real b0_a0_a1_a3_em2 = 0 ;
parameter real a0_a0_a1_a3_em2 = 0 ;
parameter real b0_b0_a2_a3_em2 = -822 ;
parameter real a0_b0_a2_a3_em2 = 9.93 ;
parameter real b0_a0_a2_a3_em2 = 0 ;
parameter real a0_a0_a2_a3_em2 = 0 ;
parameter real b0_b0_a3_a3_em2 = -1140 ;
parameter real a0_b0_a3_a3_em2 = 1.67 ;
parameter real b0_a0_a3_a3_em2 = 0 ;
parameter real a0_a0_a3_a3_em2 = 0 ;
parameter real b0_b0_a4_a3_em2 = 0 ;
parameter real a0_b0_a4_a3_em2 = 0 ;
parameter real b0_a0_a4_a3_em2 = 0 ;
parameter real a0_a0_a4_a3_em2 = 0 ;
parameter real b0_b0_p1_a3_em2 = -3.53 ;
parameter real a0_b0_p1_a3_em2 = -0.492 ;
parameter real b0_a0_p1_a3_em2 = 0 ;
parameter real a0_a0_p1_a3_em2 = 0 ;
parameter real b0_b0_p2_a3_em2 = 1.56 ;
parameter real a0_b0_p2_a3_em2 = 0.00251 ;
parameter real b0_a0_p2_a3_em2 = 0 ;
parameter real a0_a0_p2_a3_em2 = 0 ;
parameter real b0_b0_p3_a3_em2 = 2.81 ;
parameter real a0_b0_p3_a3_em2 = 0.000409 ;
parameter real b0_a0_p3_a3_em2 = 0 ;
parameter real a0_a0_p3_a3_em2 = 0 ;
parameter real b0_b0_p4_a3_em2 = 4.5 ;
parameter real a0_b0_p4_a3_em2 = 0 ;
parameter real b0_a0_p4_a3_em2 = 0 ;
parameter real a0_a0_p4_a3_em2 = 0 ;
parameter real b0_b0_b0_a4_em2 = 2010 ;
parameter real a0_b0_b0_a4_em2 = -5.5 ;
parameter real b0_a0_b0_a4_em2 = -0.235 ;
parameter real a0_a0_b0_a4_em2 = -0.0118 ;
parameter real b0_b0_a0_a4_em2 = 0 ;
parameter real a0_b0_a0_a4_em2 = 0 ;
parameter real b0_a0_a0_a4_em2 = 0 ;
parameter real a0_a0_a0_a4_em2 = 0 ;
parameter real b0_b0_a1_a4_em2 = 4.04 ;
parameter real a0_b0_a1_a4_em2 = 1.21 ;
parameter real b0_a0_a1_a4_em2 = -2.49 ;
parameter real a0_a0_a1_a4_em2 = 0.00788 ;
parameter real b0_b0_a2_a4_em2 = 10.9 ;
parameter real a0_b0_a2_a4_em2 = 0.521 ;
parameter real b0_a0_a2_a4_em2 = 0 ;
parameter real a0_a0_a2_a4_em2 = -0.00101 ;
parameter real b0_b0_a3_a4_em2 = 3.43 ;
parameter real a0_b0_a3_a4_em2 = -0.231 ;
parameter real b0_a0_a3_a4_em2 = -3.6 ;
parameter real a0_a0_a3_a4_em2 = 0.0121 ;
parameter real b0_b0_a4_a4_em2 = 0 ;
parameter real a0_b0_a4_a4_em2 = 0 ;
parameter real b0_a0_a4_a4_em2 = 0 ;
parameter real a0_a0_a4_a4_em2 = 0 ;
parameter real b0_b0_p1_a4_em2 = -2.32 ;
parameter real a0_b0_p1_a4_em2 = -0.00431 ;
parameter real b0_a0_p1_a4_em2 = -0.0392 ;
parameter real a0_a0_p1_a4_em2 = 9.04E-05 ;
parameter real b0_b0_p2_a4_em2 = 3.2 ;
parameter real a0_b0_p2_a4_em2 = -0.00847 ;
parameter real b0_a0_p2_a4_em2 = -0.00275 ;
parameter real a0_a0_p2_a4_em2 = 1.56E-05 ;
parameter real b0_b0_p3_a4_em2 = 2.1 ;
parameter real a0_b0_p3_a4_em2 = -0.000961 ;
parameter real b0_a0_p3_a4_em2 = 0.00629 ;
parameter real a0_a0_p3_a4_em2 = -1.97E-05 ;
parameter real b0_b0_p4_a4_em2 = -3.57 ;
parameter real a0_b0_p4_a4_em2 = 0.0283 ;
parameter real b0_a0_p4_a4_em2 = 0.00711 ;
parameter real a0_a0_p4_a4_em2 = -0.000744 ;
parameter real b0_b0_b0_p1_em2 = 5.38 ;
parameter real a0_b0_b0_p1_em2 = 0 ;
parameter real b0_a0_b0_p1_em2 = 0 ;
parameter real a0_a0_b0_p1_em2 = 0 ;
parameter real b0_b0_a0_p1_em2 = 0 ;
parameter real a0_b0_a0_p1_em2 = 0 ;
parameter real b0_a0_a0_p1_em2 = 0 ;
parameter real a0_a0_a0_p1_em2 = 0 ;
parameter real b0_b0_a1_p1_em2 = 0.664 ;
parameter real a0_b0_a1_p1_em2 = 0 ;
parameter real b0_a0_a1_p1_em2 = 0 ;
parameter real a0_a0_a1_p1_em2 = 0 ;
parameter real b0_b0_a2_p1_em2 = -1.22 ;
parameter real a0_b0_a2_p1_em2 = 0 ;
parameter real b0_a0_a2_p1_em2 = 0 ;
parameter real a0_a0_a2_p1_em2 = 0 ;
parameter real b0_b0_a3_p1_em2 = -2.85 ;
parameter real a0_b0_a3_p1_em2 = 0 ;
parameter real b0_a0_a3_p1_em2 = 0 ;
parameter real a0_a0_a3_p1_em2 = 0 ;
parameter real b0_b0_a4_p1_em2 = 0 ;
parameter real a0_b0_a4_p1_em2 = 0 ;
parameter real b0_a0_a4_p1_em2 = 0 ;
parameter real a0_a0_a4_p1_em2 = 0 ;
parameter real b0_b0_p1_p1_em2 = -0.00457 ;
parameter real a0_b0_p1_p1_em2 = 0 ;
parameter real b0_a0_p1_p1_em2 = 0 ;
parameter real a0_a0_p1_p1_em2 = 0 ;
parameter real b0_b0_p2_p1_em2 = 1.39 ;
parameter real a0_b0_p2_p1_em2 = 0 ;
parameter real b0_a0_p2_p1_em2 = 0 ;
parameter real a0_a0_p2_p1_em2 = 0 ;
parameter real b0_b0_p3_p1_em2 = 3.33 ;
parameter real a0_b0_p3_p1_em2 = 0 ;
parameter real b0_a0_p3_p1_em2 = 0 ;
parameter real a0_a0_p3_p1_em2 = 0 ;
parameter real b0_b0_p4_p1_em2 = 4.62 ;
parameter real a0_b0_p4_p1_em2 = 0 ;
parameter real b0_a0_p4_p1_em2 = 0 ;
parameter real a0_a0_p4_p1_em2 = 0 ;
parameter real b0_b0_b0_p2_em2 = 10.8 ;
parameter real a0_b0_b0_p2_em2 = 0.000435 ;
parameter real b0_a0_b0_p2_em2 = 0 ;
parameter real a0_a0_b0_p2_em2 = 0 ;
parameter real b0_b0_a0_p2_em2 = 0 ;
parameter real a0_b0_a0_p2_em2 = 0 ;
parameter real b0_a0_a0_p2_em2 = 0 ;
parameter real a0_a0_a0_p2_em2 = 0 ;
parameter real b0_b0_a1_p2_em2 = -11.8 ;
parameter real a0_b0_a1_p2_em2 = -0.00232 ;
parameter real b0_a0_a1_p2_em2 = 0 ;
parameter real a0_a0_a1_p2_em2 = 0 ;
parameter real b0_b0_a2_p2_em2 = -1.05 ;
parameter real a0_b0_a2_p2_em2 = -0.00022 ;
parameter real b0_a0_a2_p2_em2 = 0 ;
parameter real a0_a0_a2_p2_em2 = 0 ;
parameter real b0_b0_a3_p2_em2 = -0.205 ;
parameter real a0_b0_a3_p2_em2 = 0.000139 ;
parameter real b0_a0_a3_p2_em2 = 0 ;
parameter real a0_a0_a3_p2_em2 = 0 ;
parameter real b0_b0_a4_p2_em2 = 0 ;
parameter real a0_b0_a4_p2_em2 = 0 ;
parameter real b0_a0_a4_p2_em2 = 0 ;
parameter real a0_a0_a4_p2_em2 = 0 ;
parameter real b0_b0_p1_p2_em2 = 1.5 ;
parameter real a0_b0_p1_p2_em2 = 0 ;
parameter real b0_a0_p1_p2_em2 = 0 ;
parameter real a0_a0_p1_p2_em2 = 0 ;
parameter real b0_b0_p2_p2_em2 = 1.63 ;
parameter real a0_b0_p2_p2_em2 = 3.47E-06 ;
parameter real b0_a0_p2_p2_em2 = 0 ;
parameter real a0_a0_p2_p2_em2 = 0 ;
parameter real b0_b0_p3_p2_em2 = 2.46 ;
parameter real a0_b0_p3_p2_em2 = 0.000126 ;
parameter real b0_a0_p3_p2_em2 = 0 ;
parameter real a0_a0_p3_p2_em2 = 0 ;
parameter real b0_b0_p4_p2_em2 = 4.26 ;
parameter real a0_b0_p4_p2_em2 = 0.000219 ;
parameter real b0_a0_p4_p2_em2 = 0 ;
parameter real a0_a0_p4_p2_em2 = 0 ;
parameter real b0_b0_b0_p3_em2 = 20 ;
parameter real a0_b0_b0_p3_em2 = 0 ;
parameter real b0_a0_b0_p3_em2 = 0 ;
parameter real a0_a0_b0_p3_em2 = 0 ;
parameter real b0_b0_a0_p3_em2 = 0 ;
parameter real a0_b0_a0_p3_em2 = 0 ;
parameter real b0_a0_a0_p3_em2 = 0 ;
parameter real a0_a0_a0_p3_em2 = 0 ;
parameter real b0_b0_a1_p3_em2 = 0 ;
parameter real a0_b0_a1_p3_em2 = 0 ;
parameter real b0_a0_a1_p3_em2 = 0 ;
parameter real a0_a0_a1_p3_em2 = 0 ;
parameter real b0_b0_a2_p3_em2 = 0 ;
parameter real a0_b0_a2_p3_em2 = 0 ;
parameter real b0_a0_a2_p3_em2 = 0 ;
parameter real a0_a0_a2_p3_em2 = 0 ;
parameter real b0_b0_a3_p3_em2 = 0 ;
parameter real a0_b0_a3_p3_em2 = 0 ;
parameter real b0_a0_a3_p3_em2 = 0 ;
parameter real a0_a0_a3_p3_em2 = 0 ;
parameter real b0_b0_a4_p3_em2 = 0 ;
parameter real a0_b0_a4_p3_em2 = 0 ;
parameter real b0_a0_a4_p3_em2 = 0 ;
parameter real a0_a0_a4_p3_em2 = 0 ;
parameter real b0_b0_p1_p3_em2 = 0 ;
parameter real a0_b0_p1_p3_em2 = 0 ;
parameter real b0_a0_p1_p3_em2 = 0 ;
parameter real a0_a0_p1_p3_em2 = 0 ;
parameter real b0_b0_p2_p3_em2 = 1 ;
parameter real a0_b0_p2_p3_em2 = 0 ;
parameter real b0_a0_p2_p3_em2 = 0 ;
parameter real a0_a0_p2_p3_em2 = 0 ;
parameter real b0_b0_p3_p3_em2 = 2 ;
parameter real a0_b0_p3_p3_em2 = 0 ;
parameter real b0_a0_p3_p3_em2 = 0 ;
parameter real a0_a0_p3_p3_em2 = 0 ;
parameter real b0_b0_p4_p3_em2 = 3 ;
parameter real a0_b0_p4_p3_em2 = 0 ;
parameter real b0_a0_p4_p3_em2 = 0 ;
parameter real a0_a0_p4_p3_em2 = 0 ;
parameter real b0_b0_b0_p4_em2 = 33.3 ;
parameter real a0_b0_b0_p4_em2 = -0.0104 ;
parameter real b0_a0_b0_p4_em2 = -0.0173 ;
parameter real a0_a0_b0_p4_em2 = 5.15E-05 ;
parameter real b0_b0_a0_p4_em2 = 0 ;
parameter real a0_b0_a0_p4_em2 = 0 ;
parameter real b0_a0_a0_p4_em2 = 0 ;
parameter real a0_a0_a0_p4_em2 = 0 ;
parameter real b0_b0_a1_p4_em2 = -151 ;
parameter real a0_b0_a1_p4_em2 = 0.27 ;
parameter real b0_a0_a1_p4_em2 = 0.017 ;
parameter real a0_a0_a1_p4_em2 = -0.00026 ;
parameter real b0_b0_a2_p4_em2 = 1.56 ;
parameter real a0_b0_a2_p4_em2 = -0.0195 ;
parameter real b0_a0_a2_p4_em2 = -0.0325 ;
parameter real a0_a0_a2_p4_em2 = 0.000155 ;
parameter real b0_b0_a3_p4_em2 = 6.11 ;
parameter real a0_b0_a3_p4_em2 = -0.0128 ;
parameter real b0_a0_a3_p4_em2 = -0.017 ;
parameter real a0_a0_a3_p4_em2 = -3.61E-06 ;
parameter real b0_b0_a4_p4_em2 = 0 ;
parameter real a0_b0_a4_p4_em2 = 0 ;
parameter real b0_a0_a4_p4_em2 = 0 ;
parameter real a0_a0_a4_p4_em2 = 0 ;
parameter real b0_b0_p1_p4_em2 = 1.78 ;
parameter real a0_b0_p1_p4_em2 = 0.00199 ;
parameter real b0_a0_p1_p4_em2 = -0.000337 ;
parameter real a0_a0_p1_p4_em2 = 1.77E-06 ;
parameter real b0_b0_p2_p4_em2 = 1.87 ;
parameter real a0_b0_p2_p4_em2 = 0.00196 ;
parameter real b0_a0_p2_p4_em2 = -0.00114 ;
parameter real a0_a0_p2_p4_em2 = 4.71E-06 ;
parameter real b0_b0_p3_p4_em2 = 3 ;
parameter real a0_b0_p3_p4_em2 = -0.000192 ;
parameter real b0_a0_p3_p4_em2 = -0.00088 ;
parameter real a0_a0_p3_p4_em2 = 2.18E-06 ;
parameter real b0_b0_p4_p4_em2 = 0.522 ;
parameter real a0_b0_p4_p4_em2 = 0.0117 ;
parameter real b0_a0_p4_p4_em2 = 0.00798 ;
parameter real a0_a0_p4_p4_em2 = -2.34E-05 ;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vsub > 0 && vsub < 1e-6) begin
				vsub = 1e-6;
			end
			if(vsub < 0 && vsub > -1e-6) begin
				vsub = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));
			
			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));
			
			if (id == 0) begin
				id = id+1e-15;
			end
			
			
			
			delta_damage1_3_1 = 0*relimo_ratio21_a;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				end
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -1.0*0/(0.5523*l+13.733), 0.0);
			
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3*l+1.0));
			//$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3013*l+1.141));
			//$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0/(-0.0011*pow(l,2)+0.3329*l+1.0083));
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 0.0026*1/l+0.9911);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_b_off)+pow(delta_m_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_a_off)+pow(delta_m_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_m_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_m_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -1.0*0/(0.5523*l+13.733), 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3*l+1.0));
			//$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(0.3013*l+1.141));
			//$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0/(-0.0011*pow(l,2)+0.3329*l+1.0083));
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 0.0026*1/l+0.9911);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b_legacy(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;

parameter real        vgs_cutoff_HCI = 0.5;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;

// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 24300 ;
parameter real a0_b0_b0_a1_em = -9.46 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -51400 ;
parameter real a0_b0_a1_a1_em = 51.3 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = -3760 ;
parameter real a0_b0_a2_a1_em = 16.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -9450 ;
parameter real a0_b0_a3_a1_em = 3.73 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 0.447 ;
parameter real a0_b0_p1_a1_em = -0.000712 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 0.531 ;
parameter real a0_b0_p2_a1_em = -8.20E-07 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 2.3 ;
parameter real a0_b0_p3_a1_em = -0.00126 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 2.95 ;
parameter real a0_b0_p4_a1_em = -7.95E-05 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 11300 ;
parameter real a0_b0_b0_a2_em = -2.26 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = -12900 ;
parameter real a0_b0_a1_a2_em = 10.6 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 2300 ;
parameter real a0_b0_a2_a2_em = -4.02 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5210 ;
parameter real a0_b0_a3_a2_em = 2.19 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 0.709 ;
parameter real a0_b0_p1_a2_em = -0.000898 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 0.416 ;
parameter real a0_b0_p2_a2_em = 0.000245 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 0.788 ;
parameter real a0_b0_p3_a2_em = 0.00232 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3.69 ;
parameter real a0_b0_p4_a2_em = 0.000118 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 4030 ;
parameter real a0_b0_b0_a3_em = 0.967 ;
parameter real b0_a0_b0_a3_em = 23.9 ;
parameter real a0_a0_b0_a3_em = -0.0269 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1610 ;
parameter real a0_b0_a1_a3_em = 21.2 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1220 ;
parameter real a0_b0_a2_a3_em = -8.18 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -6040 ;
parameter real a0_b0_a3_a3_em = 5.4 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0 ;
parameter real a0_b0_p1_a3_em = 0 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 0.778 ;
parameter real a0_b0_p2_a3_em = -0.00101 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.36 ;
parameter real a0_b0_p3_a3_em = -0.00189 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2 ;
parameter real a0_b0_p4_a3_em = 0 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 4010 ;
parameter real a0_b0_b0_a4_em = 0.0686 ;
parameter real b0_a0_b0_a4_em = -5.13 ;
parameter real a0_a0_b0_a4_em = 0.0232 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = -6620 ;
parameter real a0_b0_a1_a4_em = 28.3 ;
parameter real b0_a0_a1_a4_em = 0 ;
parameter real a0_a0_a1_a4_em = 0 ;
parameter real b0_b0_a2_a4_em = -17600 ;
parameter real a0_b0_a2_a4_em = 22 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0 ;
parameter real b0_b0_a3_a4_em = 1500 ;
parameter real a0_b0_a3_a4_em = -2.56 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0 ;
parameter real a0_b0_p1_a4_em = 0 ;
parameter real b0_a0_p1_a4_em = 0 ;
parameter real a0_a0_p1_a4_em = 0 ;
parameter real b0_b0_p2_a4_em = 2.15 ;
parameter real a0_b0_p2_a4_em = -0.00289 ;
parameter real b0_a0_p2_a4_em = 0 ;
parameter real a0_a0_p2_a4_em = 0 ;
parameter real b0_b0_p3_a4_em = 1.54 ;
parameter real a0_b0_p3_a4_em = 0.000389 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 4.09 ;
parameter real a0_b0_p4_a4_em = -0.000378 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -2.91 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 0.858 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -1.96 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = -7.53 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -9.72 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.45 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.25 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.93 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 9.25 ;
parameter real a0_b0_b0_p2_em = 0.0062 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0 ;
parameter real a0_b0_a1_p2_em = 0 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0 ;
parameter real a0_b0_a2_p2_em = 0 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 0 ;
parameter real a0_b0_a3_p2_em = 0 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = 0 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 0 ;
parameter real a0_b0_p2_p2_em = 0 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 0 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 0 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 22 ;
parameter real a0_b0_b0_p3_em = 0 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0 ;
parameter real a0_b0_a1_p3_em = 0 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 0 ;
parameter real a0_b0_a2_p3_em = 0 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = 0 ;
parameter real a0_b0_a3_p3_em = 0 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0 ;
parameter real a0_b0_p1_p3_em = 0 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 0 ;
parameter real a0_b0_p2_p3_em = 0 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 0 ;
parameter real a0_b0_p3_p3_em = 0 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 0 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 40.5 ;
parameter real a0_b0_b0_p4_em = -0.0089 ;
parameter real b0_a0_b0_p4_em = -0.0405 ;
parameter real a0_a0_b0_p4_em = 3.28E-05 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 3.49 ;
parameter real a0_b0_a1_p4_em = -0.00724 ;
parameter real b0_a0_a1_p4_em = 0 ;
parameter real a0_a0_a1_p4_em = 0 ;
parameter real b0_b0_a2_p4_em = -1.75 ;
parameter real a0_b0_a2_p4_em = 0.00419 ;
parameter real b0_a0_a2_p4_em = 0 ;
parameter real a0_a0_a2_p4_em = 0 ;
parameter real b0_b0_a3_p4_em = 1.39 ;
parameter real a0_b0_a3_p4_em = 0.000782 ;
parameter real b0_a0_a3_p4_em = 0 ;
parameter real a0_a0_a3_p4_em = 0 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.1 ;
parameter real a0_b0_p1_p4_em = 0 ;
parameter real b0_a0_p1_p4_em = 0 ;
parameter real a0_a0_p1_p4_em = 0 ;
parameter real b0_b0_p2_p4_em = 1.47 ;
parameter real a0_b0_p2_p4_em = -0.000691 ;
parameter real b0_a0_p2_p4_em = 0 ;
parameter real a0_a0_p2_p4_em = 0 ;
parameter real b0_b0_p3_p4_em = 6.09 ;
parameter real a0_b0_p3_p4_em = -0.0116 ;
parameter real b0_a0_p3_p4_em = 0 ;
parameter real a0_a0_p3_p4_em = 0 ;
parameter real b0_b0_p4_p4_em = 4 ;
parameter real a0_b0_p4_p4_em = 0 ;
parameter real b0_a0_p4_p4_em = 0 ;
parameter real a0_a0_p4_p4_em = 0 ;



parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_lamda0 = 8.06e-7;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_fstat1 = 0.00347;
parameter real        relimo_alpha1 = 1.35e-8;
parameter real        relimo_m1 = 1.77;
parameter real        relimo_Feb = 3.2;
parameter real        relimo_a1 = 0.773;
parameter real        relimo_a2 = 1.27;
parameter real        relimo_c1 = 3.71e5;
parameter real        relimo_fstat2 = 0.0133;
parameter real        relimo_alpha2 = 2.91E+11;
parameter real        relimo_beta2 = 3.44E-08;
parameter real        relimo_gama2 = 17.773;
parameter real        relimo_eps2 = 5.6824;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 1.4629;
parameter real        relimo_rth = 0.019243;
parameter real        relimo_n_hci3 = 0.389;
parameter real        relimo_a_hci3 = 283;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = 0;
			id = abs(id1+id2);

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, relimo_alpha2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*abs(V(sub)-V(s))), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
			
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b_he_legacy(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;

parameter real        vgs_cutoff_HCI = 0.7;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;

// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 44100 ;
parameter real a0_b0_b0_a1_em = -8.26 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -24200 ;
parameter real a0_b0_a1_a1_em = 12.7 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 44600 ;
parameter real a0_b0_a2_a1_em = -51.1 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = 15600 ;
parameter real a0_b0_a3_a1_em = -114 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = 1.83 ;
parameter real a0_b0_p1_a1_em = -0.00143 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 3.15 ;
parameter real a0_b0_p2_a1_em = -0.00119 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 3.41 ;
parameter real a0_b0_p3_a1_em = -0.000995 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.5 ;
parameter real a0_b0_p4_a1_em = -0.00265 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 12100 ;
parameter real a0_b0_b0_a2_em = 1.94 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 1300 ;
parameter real a0_b0_a1_a2_em = -1.82 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 1020 ;
parameter real a0_b0_a2_a2_em = 0.177 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = -5410 ;
parameter real a0_b0_a3_a2_em = 0.922 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = -0.715 ;
parameter real a0_b0_p1_a2_em = -0.000869 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = -0.512 ;
parameter real a0_b0_p2_a2_em = 0.00359 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 1.15 ;
parameter real a0_b0_p3_a2_em = -3.68E-05 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 3 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 6230 ;
parameter real a0_b0_b0_a3_em = 2.16 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 1640 ;
parameter real a0_b0_a1_a3_em = -13 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 1.21 ;
parameter real a0_b0_a2_a3_em = 0.996 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -1530 ;
parameter real a0_b0_a3_a3_em = 2.84 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 1.35 ;
parameter real a0_b0_p1_a3_em = 0.000208 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 2.56 ;
parameter real a0_b0_p2_a3_em = -0.000218 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = -0.81 ;
parameter real a0_b0_p3_a3_em = 0.00252 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 2.56 ;
parameter real a0_b0_p4_a3_em = 0.00359 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 2780 ;
parameter real a0_b0_b0_a4_em = 2.16 ;
parameter real b0_a0_b0_a4_em = 0.277 ;
parameter real a0_a0_b0_a4_em = 0.0148 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 25700 ;
parameter real a0_b0_a1_a4_em = -30 ;
parameter real b0_a0_a1_a4_em = -0.177 ;
parameter real a0_a0_a1_a4_em = -0.024 ;
parameter real b0_b0_a2_a4_em = -346 ;
parameter real a0_b0_a2_a4_em = -10.4 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = 0.0601 ;
parameter real b0_b0_a3_a4_em = -7.79 ;
parameter real a0_b0_a3_a4_em = -0.00113 ;
parameter real b0_a0_a3_a4_em = 0 ;
parameter real a0_a0_a3_a4_em = 0 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 2.48 ;
parameter real a0_b0_p1_a4_em = -0.000237 ;
parameter real b0_a0_p1_a4_em = 0.000614 ;
parameter real a0_a0_p1_a4_em = -2.39E-06 ;
parameter real b0_b0_p2_a4_em = 4.04 ;
parameter real a0_b0_p2_a4_em = 0.000126 ;
parameter real b0_a0_p2_a4_em = -0.00024 ;
parameter real a0_a0_p2_a4_em = 1.52E-06 ;
parameter real b0_b0_p3_a4_em = -39.8 ;
parameter real a0_b0_p3_a4_em = 0.197 ;
parameter real b0_a0_p3_a4_em = 0 ;
parameter real a0_a0_p3_a4_em = 0 ;
parameter real b0_b0_p4_a4_em = 5.65 ;
parameter real a0_b0_p4_a4_em = -0.000628 ;
parameter real b0_a0_p4_a4_em = 0 ;
parameter real a0_a0_p4_a4_em = 0 ;
parameter real b0_b0_b0_p1_em = -3.5 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 1.16 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = 0 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 12.2 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = -1 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.6 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.89 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 4 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 5.12 ;
parameter real a0_b0_b0_p2_em = 0.00286 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 0.798 ;
parameter real a0_b0_a1_p2_em = -0.000226 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 4.48 ;
parameter real a0_b0_a2_p2_em = 0.00529 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 37.1 ;
parameter real a0_b0_a3_p2_em = -0.0747 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.79 ;
parameter real a0_b0_p2_p2_em = -0.00123 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 2.51 ;
parameter real a0_b0_p3_p2_em = -0.000964 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2.38 ;
parameter real a0_b0_p4_p2_em = -0.000171 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 17.1 ;
parameter real a0_b0_b0_p3_em = -0.00513 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 0.443 ;
parameter real a0_b0_a1_p3_em = -0.000315 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = 14.3 ;
parameter real a0_b0_a2_p3_em = -0.0142 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -9.19 ;
parameter real a0_b0_a3_p3_em = 0.0304 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 4.05 ;
parameter real a0_b0_p1_p3_em = -0.0118 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 1.18 ;
parameter real a0_b0_p2_p3_em = 0.00021 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 1.59 ;
parameter real a0_b0_p3_p3_em = -9.01E-05 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 2 ;
parameter real a0_b0_p4_p3_em = 0 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 32 ;
parameter real a0_b0_b0_p4_em = -0.0084 ;
parameter real b0_a0_b0_p4_em = 0.0545 ;
parameter real a0_a0_b0_p4_em = -7.63E-06 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 1.66 ;
parameter real a0_b0_a1_p4_em = -0.00388 ;
parameter real b0_a0_a1_p4_em = -0.0109 ;
parameter real a0_a0_a1_p4_em = 2.14E-05 ;
parameter real b0_b0_a2_p4_em = -25.6 ;
parameter real a0_b0_a2_p4_em = 0.0363 ;
parameter real b0_a0_a2_p4_em = 0.0775 ;
parameter real a0_a0_a2_p4_em = -0.000109 ;
parameter real b0_b0_a3_p4_em = 3.55 ;
parameter real a0_b0_a3_p4_em = 0.111 ;
parameter real b0_a0_a3_p4_em = 0.224 ;
parameter real a0_a0_a3_p4_em = -0.000755 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = -0.069 ;
parameter real a0_b0_p1_p4_em = -0.00169 ;
parameter real b0_a0_p1_p4_em = -0.0915 ;
parameter real a0_a0_p1_p4_em = 8.09E-05 ;
parameter real b0_b0_p2_p4_em = 2.55 ;
parameter real a0_b0_p2_p4_em = -0.000145 ;
parameter real b0_a0_p2_p4_em = -0.0127 ;
parameter real a0_a0_p2_p4_em = 2.64E-05 ;
parameter real b0_b0_p3_p4_em = 2.74 ;
parameter real a0_b0_p3_p4_em = -0.000499 ;
parameter real b0_a0_p3_p4_em = -6.82E-06 ;
parameter real a0_a0_p3_p4_em = -1.23E-06 ;
parameter real b0_b0_p4_p4_em = 3.25 ;
parameter real a0_b0_p4_p4_em = -0.00084 ;
parameter real b0_a0_p4_p4_em = 0.000639 ;
parameter real a0_a0_p4_p4_em = -9.65E-07 ;
   

parameter real        relimo_d_hci1 = 1.0;

parameter real        relimo_Feb = 3.2;
parameter real        relimo_Ep = 0.063;

parameter real        relimo_a1 = 0.637;
parameter real        relimo_a2 = 1.16;
parameter real        relimo_c1 = 1.21e5;
parameter real        relimo_alpha1 = 7.01e-15;
parameter real        relimo_m1 = 1.43;
parameter real        relimo_lamda0 = 2.10e-7;
parameter real        relimo_fstat1 = 0.00443;

parameter real        relimo_a_hci3 = 330;
parameter real        relimo_n_hci3 = 0.501;
parameter real        relimo_alpha2 = 1.41E+24;
parameter real        relimo_beta2 = 2.76E-14;
parameter real        relimo_gama2 = 17.4;
parameter real        relimo_eps2 = 9.53;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.61;
parameter real        relimo_rth = 2.25E-14;
parameter real        relimo_fstat2 = 0.0223;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = 0;
			id = abs(id1+id2);

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter MULT in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
			
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_hci_nld45b_tlp_legacy(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";
parameter real        relimo_vth                   = 0.51;			
parameter real        relimo_intercept             = 0;			
parameter real        relimo_c                     = 0;			
parameter real        relimo_e                     = 0;
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_m                     = 0;
parameter real        relimo_n                     = 1;
parameter real        relimo_r                     = 0;
parameter real        relimo_a_idsat               = 0;
parameter real        relimo_a_idlin               = 0;
parameter real        relimo_a_gm                  = 0;
parameter real        relimo_a_vth                 = 0;
parameter integer     relimo_function              = 1;

parameter real        relimo_condvg                = 0;
parameter real        relimo_condvd                = 0;

parameter real        vgs_cutoff_HCI = 0.9;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;

// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0 ;
parameter real a0_b0_b0_b0_em = 0 ;
parameter real b0_a0_b0_b0_em = 0 ;
parameter real a0_a0_b0_b0_em = 0 ;
parameter real b0_b0_a0_b0_em = 0 ;
parameter real a0_b0_a0_b0_em = 0 ;
parameter real b0_a0_a0_b0_em = 0 ;
parameter real a0_a0_a0_b0_em = 0 ;
parameter real b0_b0_a1_b0_em = 0 ;
parameter real a0_b0_a1_b0_em = 0 ;
parameter real b0_a0_a1_b0_em = 0 ;
parameter real a0_a0_a1_b0_em = 0 ;
parameter real b0_b0_a2_b0_em = 0 ;
parameter real a0_b0_a2_b0_em = 0 ;
parameter real b0_a0_a2_b0_em = 0 ;
parameter real a0_a0_a2_b0_em = 0 ;
parameter real b0_b0_a3_b0_em = 0 ;
parameter real a0_b0_a3_b0_em = 0 ;
parameter real b0_a0_a3_b0_em = 0 ;
parameter real a0_a0_a3_b0_em = 0 ;
parameter real b0_b0_a4_b0_em = 0 ;
parameter real a0_b0_a4_b0_em = 0 ;
parameter real b0_a0_a4_b0_em = 0 ;
parameter real a0_a0_a4_b0_em = 0 ;
parameter real b0_b0_p1_b0_em = 0 ;
parameter real a0_b0_p1_b0_em = 0 ;
parameter real b0_a0_p1_b0_em = 0 ;
parameter real a0_a0_p1_b0_em = 0 ;
parameter real b0_b0_p2_b0_em = 0 ;
parameter real a0_b0_p2_b0_em = 0 ;
parameter real b0_a0_p2_b0_em = 0 ;
parameter real a0_a0_p2_b0_em = 0 ;
parameter real b0_b0_p3_b0_em = 0 ;
parameter real a0_b0_p3_b0_em = 0 ;
parameter real b0_a0_p3_b0_em = 0 ;
parameter real a0_a0_p3_b0_em = 0 ;
parameter real b0_b0_p4_b0_em = 0 ;
parameter real a0_b0_p4_b0_em = 0 ;
parameter real b0_a0_p4_b0_em = 0 ;
parameter real a0_a0_p4_b0_em = 0 ;
parameter real b0_b0_b0_a0_em = 0 ;
parameter real a0_b0_b0_a0_em = 0 ;
parameter real b0_a0_b0_a0_em = 0 ;
parameter real a0_a0_b0_a0_em = 0 ;
parameter real b0_b0_a0_a0_em = 0 ;
parameter real a0_b0_a0_a0_em = 0 ;
parameter real b0_a0_a0_a0_em = 0 ;
parameter real a0_a0_a0_a0_em = 0 ;
parameter real b0_b0_a1_a0_em = 0 ;
parameter real a0_b0_a1_a0_em = 0 ;
parameter real b0_a0_a1_a0_em = 0 ;
parameter real a0_a0_a1_a0_em = 0 ;
parameter real b0_b0_a2_a0_em = 0 ;
parameter real a0_b0_a2_a0_em = 0 ;
parameter real b0_a0_a2_a0_em = 0 ;
parameter real a0_a0_a2_a0_em = 0 ;
parameter real b0_b0_a3_a0_em = 0 ;
parameter real a0_b0_a3_a0_em = 0 ;
parameter real b0_a0_a3_a0_em = 0 ;
parameter real a0_a0_a3_a0_em = 0 ;
parameter real b0_b0_a4_a0_em = 0 ;
parameter real a0_b0_a4_a0_em = 0 ;
parameter real b0_a0_a4_a0_em = 0 ;
parameter real a0_a0_a4_a0_em = 0 ;
parameter real b0_b0_p1_a0_em = 0 ;
parameter real a0_b0_p1_a0_em = 0 ;
parameter real b0_a0_p1_a0_em = 0 ;
parameter real a0_a0_p1_a0_em = 0 ;
parameter real b0_b0_p2_a0_em = 0 ;
parameter real a0_b0_p2_a0_em = 0 ;
parameter real b0_a0_p2_a0_em = 0 ;
parameter real a0_a0_p2_a0_em = 0 ;
parameter real b0_b0_p3_a0_em = 0 ;
parameter real a0_b0_p3_a0_em = 0 ;
parameter real b0_a0_p3_a0_em = 0 ;
parameter real a0_a0_p3_a0_em = 0 ;
parameter real b0_b0_p4_a0_em = 0 ;
parameter real a0_b0_p4_a0_em = 0 ;
parameter real b0_a0_p4_a0_em = 0 ;
parameter real a0_a0_p4_a0_em = 0 ;
parameter real b0_b0_b0_a1_em = 17400 ;
parameter real a0_b0_b0_a1_em = -3.27 ;
parameter real b0_a0_b0_a1_em = 0 ;
parameter real a0_a0_b0_a1_em = 0 ;
parameter real b0_b0_a0_a1_em = 0 ;
parameter real a0_b0_a0_a1_em = 0 ;
parameter real b0_a0_a0_a1_em = 0 ;
parameter real a0_a0_a0_a1_em = 0 ;
parameter real b0_b0_a1_a1_em = -1400 ;
parameter real a0_b0_a1_a1_em = 0.27 ;
parameter real b0_a0_a1_a1_em = 0 ;
parameter real a0_a0_a1_a1_em = 0 ;
parameter real b0_b0_a2_a1_em = 12000 ;
parameter real a0_b0_a2_a1_em = 26.4 ;
parameter real b0_a0_a2_a1_em = 0 ;
parameter real a0_a0_a2_a1_em = 0 ;
parameter real b0_b0_a3_a1_em = -2320 ;
parameter real a0_b0_a3_a1_em = -7.53 ;
parameter real b0_a0_a3_a1_em = 0 ;
parameter real a0_a0_a3_a1_em = 0 ;
parameter real b0_b0_a4_a1_em = 0 ;
parameter real a0_b0_a4_a1_em = 0 ;
parameter real b0_a0_a4_a1_em = 0 ;
parameter real a0_a0_a4_a1_em = 0 ;
parameter real b0_b0_p1_a1_em = -2.71 ;
parameter real a0_b0_p1_a1_em = -7.37E-06 ;
parameter real b0_a0_p1_a1_em = 0 ;
parameter real a0_a0_p1_a1_em = 0 ;
parameter real b0_b0_p2_a1_em = 1.03 ;
parameter real a0_b0_p2_a1_em = 0.000163 ;
parameter real b0_a0_p2_a1_em = 0 ;
parameter real a0_a0_p2_a1_em = 0 ;
parameter real b0_b0_p3_a1_em = 1.36 ;
parameter real a0_b0_p3_a1_em = 0.000102 ;
parameter real b0_a0_p3_a1_em = 0 ;
parameter real a0_a0_p3_a1_em = 0 ;
parameter real b0_b0_p4_a1_em = 4.9 ;
parameter real a0_b0_p4_a1_em = -0.0017 ;
parameter real b0_a0_p4_a1_em = 0 ;
parameter real a0_a0_p4_a1_em = 0 ;
parameter real b0_b0_b0_a2_em = 5200 ;
parameter real a0_b0_b0_a2_em = 0 ;
parameter real b0_a0_b0_a2_em = 0 ;
parameter real a0_a0_b0_a2_em = 0 ;
parameter real b0_b0_a0_a2_em = 0 ;
parameter real a0_b0_a0_a2_em = 0 ;
parameter real b0_a0_a0_a2_em = 0 ;
parameter real a0_a0_a0_a2_em = 0 ;
parameter real b0_b0_a1_a2_em = 0 ;
parameter real a0_b0_a1_a2_em = 0 ;
parameter real b0_a0_a1_a2_em = 0 ;
parameter real a0_a0_a1_a2_em = 0 ;
parameter real b0_b0_a2_a2_em = 0 ;
parameter real a0_b0_a2_a2_em = 0 ;
parameter real b0_a0_a2_a2_em = 0 ;
parameter real a0_a0_a2_a2_em = 0 ;
parameter real b0_b0_a3_a2_em = 0 ;
parameter real a0_b0_a3_a2_em = 0 ;
parameter real b0_a0_a3_a2_em = 0 ;
parameter real a0_a0_a3_a2_em = 0 ;
parameter real b0_b0_a4_a2_em = 0 ;
parameter real a0_b0_a4_a2_em = 0 ;
parameter real b0_a0_a4_a2_em = 0 ;
parameter real a0_a0_a4_a2_em = 0 ;
parameter real b0_b0_p1_a2_em = 1 ;
parameter real a0_b0_p1_a2_em = 0 ;
parameter real b0_a0_p1_a2_em = 0 ;
parameter real a0_a0_p1_a2_em = 0 ;
parameter real b0_b0_p2_a2_em = 2 ;
parameter real a0_b0_p2_a2_em = 0 ;
parameter real b0_a0_p2_a2_em = 0 ;
parameter real a0_a0_p2_a2_em = 0 ;
parameter real b0_b0_p3_a2_em = 3 ;
parameter real a0_b0_p3_a2_em = 0 ;
parameter real b0_a0_p3_a2_em = 0 ;
parameter real a0_a0_p3_a2_em = 0 ;
parameter real b0_b0_p4_a2_em = 4 ;
parameter real a0_b0_p4_a2_em = 0 ;
parameter real b0_a0_p4_a2_em = 0 ;
parameter real a0_a0_p4_a2_em = 0 ;
parameter real b0_b0_b0_a3_em = 2480 ;
parameter real a0_b0_b0_a3_em = 0.502 ;
parameter real b0_a0_b0_a3_em = 0 ;
parameter real a0_a0_b0_a3_em = 0 ;
parameter real b0_b0_a0_a3_em = 0 ;
parameter real a0_b0_a0_a3_em = 0 ;
parameter real b0_a0_a0_a3_em = 0 ;
parameter real a0_a0_a0_a3_em = 0 ;
parameter real b0_b0_a1_a3_em = 634 ;
parameter real a0_b0_a1_a3_em = -17.6 ;
parameter real b0_a0_a1_a3_em = 0 ;
parameter real a0_a0_a1_a3_em = 0 ;
parameter real b0_b0_a2_a3_em = 25500 ;
parameter real a0_b0_a2_a3_em = -33.6 ;
parameter real b0_a0_a2_a3_em = 0 ;
parameter real a0_a0_a2_a3_em = 0 ;
parameter real b0_b0_a3_a3_em = -672 ;
parameter real a0_b0_a3_a3_em = -0.973 ;
parameter real b0_a0_a3_a3_em = 0 ;
parameter real a0_a0_a3_a3_em = 0 ;
parameter real b0_b0_a4_a3_em = 0 ;
parameter real a0_b0_a4_a3_em = 0 ;
parameter real b0_a0_a4_a3_em = 0 ;
parameter real a0_a0_a4_a3_em = 0 ;
parameter real b0_b0_p1_a3_em = 0.598 ;
parameter real a0_b0_p1_a3_em = 0.000857 ;
parameter real b0_a0_p1_a3_em = 0 ;
parameter real a0_a0_p1_a3_em = 0 ;
parameter real b0_b0_p2_a3_em = 1.28 ;
parameter real a0_b0_p2_a3_em = 8.13E-05 ;
parameter real b0_a0_p2_a3_em = 0 ;
parameter real a0_a0_p2_a3_em = 0 ;
parameter real b0_b0_p3_a3_em = 1.26 ;
parameter real a0_b0_p3_a3_em = 0.000714 ;
parameter real b0_a0_p3_a3_em = 0 ;
parameter real a0_a0_p3_a3_em = 0 ;
parameter real b0_b0_p4_a3_em = 5.83 ;
parameter real a0_b0_p4_a3_em = -0.00405 ;
parameter real b0_a0_p4_a3_em = 0 ;
parameter real a0_a0_p4_a3_em = 0 ;
parameter real b0_b0_b0_a4_em = 1040 ;
parameter real a0_b0_b0_a4_em = -0.0325 ;
parameter real b0_a0_b0_a4_em = 12.7 ;
parameter real a0_a0_b0_a4_em = -0.0121 ;
parameter real b0_b0_a0_a4_em = 0 ;
parameter real a0_b0_a0_a4_em = 0 ;
parameter real b0_a0_a0_a4_em = 0 ;
parameter real a0_a0_a0_a4_em = 0 ;
parameter real b0_b0_a1_a4_em = 5270 ;
parameter real a0_b0_a1_a4_em = -12.4 ;
parameter real b0_a0_a1_a4_em = 0.556 ;
parameter real a0_a0_a1_a4_em = 0.286 ;
parameter real b0_b0_a2_a4_em = -303 ;
parameter real a0_b0_a2_a4_em = 1.36 ;
parameter real b0_a0_a2_a4_em = 0 ;
parameter real a0_a0_a2_a4_em = -0.00683 ;
parameter real b0_b0_a3_a4_em = 6350 ;
parameter real a0_b0_a3_a4_em = -6.57 ;
parameter real b0_a0_a3_a4_em = 17.6 ;
parameter real a0_a0_a3_a4_em = -0.0552 ;
parameter real b0_b0_a4_a4_em = 0 ;
parameter real a0_b0_a4_a4_em = 0 ;
parameter real b0_a0_a4_a4_em = 0 ;
parameter real a0_a0_a4_a4_em = 0 ;
parameter real b0_b0_p1_a4_em = 0.545 ;
parameter real a0_b0_p1_a4_em = 1.09E-03 ;
parameter real b0_a0_p1_a4_em = 0.00483 ;
parameter real a0_a0_p1_a4_em = -2.32E-05 ;
parameter real b0_b0_p2_a4_em = 0.994 ;
parameter real a0_b0_p2_a4_em = 0.000526 ;
parameter real b0_a0_p2_a4_em = 6.02E-05 ;
parameter real a0_a0_p2_a4_em = -1.86E-05 ;
parameter real b0_b0_p3_a4_em = 3.16 ;
parameter real a0_b0_p3_a4_em = 1.19E-05 ;
parameter real b0_a0_p3_a4_em = 0.000843 ;
parameter real a0_a0_p3_a4_em = 3.55E-06 ;
parameter real b0_b0_p4_a4_em = 4.7 ;
parameter real a0_b0_p4_a4_em = -0.000241 ;
parameter real b0_a0_p4_a4_em = -0.00231 ;
parameter real a0_a0_p4_a4_em = 1.02E-05 ;
parameter real b0_b0_b0_p1_em = -4.68 ;
parameter real a0_b0_b0_p1_em = 0 ;
parameter real b0_a0_b0_p1_em = 0 ;
parameter real a0_a0_b0_p1_em = 0 ;
parameter real b0_b0_a0_p1_em = 0 ;
parameter real a0_b0_a0_p1_em = 0 ;
parameter real b0_a0_a0_p1_em = 0 ;
parameter real a0_a0_a0_p1_em = 0 ;
parameter real b0_b0_a1_p1_em = 17.2 ;
parameter real a0_b0_a1_p1_em = 0 ;
parameter real b0_a0_a1_p1_em = 0 ;
parameter real a0_a0_a1_p1_em = 0 ;
parameter real b0_b0_a2_p1_em = -0.159 ;
parameter real a0_b0_a2_p1_em = 0 ;
parameter real b0_a0_a2_p1_em = 0 ;
parameter real a0_a0_a2_p1_em = 0 ;
parameter real b0_b0_a3_p1_em = 1.41 ;
parameter real a0_b0_a3_p1_em = 0 ;
parameter real b0_a0_a3_p1_em = 0 ;
parameter real a0_a0_a3_p1_em = 0 ;
parameter real b0_b0_a4_p1_em = 0 ;
parameter real a0_b0_a4_p1_em = 0 ;
parameter real b0_a0_a4_p1_em = 0 ;
parameter real a0_a0_a4_p1_em = 0 ;
parameter real b0_b0_p1_p1_em = 1.08 ;
parameter real a0_b0_p1_p1_em = 0 ;
parameter real b0_a0_p1_p1_em = 0 ;
parameter real a0_a0_p1_p1_em = 0 ;
parameter real b0_b0_p2_p1_em = 1.43 ;
parameter real a0_b0_p2_p1_em = 0 ;
parameter real b0_a0_p2_p1_em = 0 ;
parameter real a0_a0_p2_p1_em = 0 ;
parameter real b0_b0_p3_p1_em = 2.01 ;
parameter real a0_b0_p3_p1_em = 0 ;
parameter real b0_a0_p3_p1_em = 0 ;
parameter real a0_a0_p3_p1_em = 0 ;
parameter real b0_b0_p4_p1_em = 2.3 ;
parameter real a0_b0_p4_p1_em = 0 ;
parameter real b0_a0_p4_p1_em = 0 ;
parameter real a0_a0_p4_p1_em = 0 ;
parameter real b0_b0_b0_p2_em = 6.78 ;
parameter real a0_b0_b0_p2_em = 0.00226 ;
parameter real b0_a0_b0_p2_em = 0 ;
parameter real a0_a0_b0_p2_em = 0 ;
parameter real b0_b0_a0_p2_em = 0 ;
parameter real a0_b0_a0_p2_em = 0 ;
parameter real b0_a0_a0_p2_em = 0 ;
parameter real a0_a0_a0_p2_em = 0 ;
parameter real b0_b0_a1_p2_em = 1.27 ;
parameter real a0_b0_a1_p2_em = -0.000307 ;
parameter real b0_a0_a1_p2_em = 0 ;
parameter real a0_a0_a1_p2_em = 0 ;
parameter real b0_b0_a2_p2_em = 0.285 ;
parameter real a0_b0_a2_p2_em = -0.13 ;
parameter real b0_a0_a2_p2_em = 0 ;
parameter real a0_a0_a2_p2_em = 0 ;
parameter real b0_b0_a3_p2_em = 6.22 ;
parameter real a0_b0_a3_p2_em = -0.0235 ;
parameter real b0_a0_a3_p2_em = 0 ;
parameter real a0_a0_a3_p2_em = 0 ;
parameter real b0_b0_a4_p2_em = 0 ;
parameter real a0_b0_a4_p2_em = 0 ;
parameter real b0_a0_a4_p2_em = 0 ;
parameter real a0_a0_a4_p2_em = 0 ;
parameter real b0_b0_p1_p2_em = -1 ;
parameter real a0_b0_p1_p2_em = 0 ;
parameter real b0_a0_p1_p2_em = 0 ;
parameter real a0_a0_p1_p2_em = 0 ;
parameter real b0_b0_p2_p2_em = 1.36 ;
parameter real a0_b0_p2_p2_em = 5.54E-05 ;
parameter real b0_a0_p2_p2_em = 0 ;
parameter real a0_a0_p2_p2_em = 0 ;
parameter real b0_b0_p3_p2_em = 1.4 ;
parameter real a0_b0_p3_p2_em = 0 ;
parameter real b0_a0_p3_p2_em = 0 ;
parameter real a0_a0_p3_p2_em = 0 ;
parameter real b0_b0_p4_p2_em = 2 ;
parameter real a0_b0_p4_p2_em = 0 ;
parameter real b0_a0_p4_p2_em = 0 ;
parameter real a0_a0_p4_p2_em = 0 ;
parameter real b0_b0_b0_p3_em = 15.9 ;
parameter real a0_b0_b0_p3_em = 0.00466 ;
parameter real b0_a0_b0_p3_em = 0 ;
parameter real a0_a0_b0_p3_em = 0 ;
parameter real b0_b0_a0_p3_em = 0 ;
parameter real a0_b0_a0_p3_em = 0 ;
parameter real b0_a0_a0_p3_em = 0 ;
parameter real a0_a0_a0_p3_em = 0 ;
parameter real b0_b0_a1_p3_em = 3.95 ;
parameter real a0_b0_a1_p3_em = 0.0218 ;
parameter real b0_a0_a1_p3_em = 0 ;
parameter real a0_a0_a1_p3_em = 0 ;
parameter real b0_b0_a2_p3_em = -9.77 ;
parameter real a0_b0_a2_p3_em = -0.0391 ;
parameter real b0_a0_a2_p3_em = 0 ;
parameter real a0_a0_a2_p3_em = 0 ;
parameter real b0_b0_a3_p3_em = -4.21 ;
parameter real a0_b0_a3_p3_em = -0.00335 ;
parameter real b0_a0_a3_p3_em = 0 ;
parameter real a0_a0_a3_p3_em = 0 ;
parameter real b0_b0_a4_p3_em = 0 ;
parameter real a0_b0_a4_p3_em = 0 ;
parameter real b0_a0_a4_p3_em = 0 ;
parameter real a0_a0_a4_p3_em = 0 ;
parameter real b0_b0_p1_p3_em = 0.761 ;
parameter real a0_b0_p1_p3_em = 0.00122 ;
parameter real b0_a0_p1_p3_em = 0 ;
parameter real a0_a0_p1_p3_em = 0 ;
parameter real b0_b0_p2_p3_em = 2.1 ;
parameter real a0_b0_p2_p3_em = 1.16E-05 ;
parameter real b0_a0_p2_p3_em = 0 ;
parameter real a0_a0_p2_p3_em = 0 ;
parameter real b0_b0_p3_p3_em = 2.82 ;
parameter real a0_b0_p3_p3_em = -0.000961 ;
parameter real b0_a0_p3_p3_em = 0 ;
parameter real a0_a0_p3_p3_em = 0 ;
parameter real b0_b0_p4_p3_em = 3.16 ;
parameter real a0_b0_p4_p3_em = 0.00349 ;
parameter real b0_a0_p4_p3_em = 0 ;
parameter real a0_a0_p4_p3_em = 0 ;
parameter real b0_b0_b0_p4_em = 28.4 ;
parameter real a0_b0_b0_p4_em = 0.0078 ;
parameter real b0_a0_b0_p4_em = 0.27 ;
parameter real a0_a0_b0_p4_em = -0.000461 ;
parameter real b0_b0_a0_p4_em = 0 ;
parameter real a0_b0_a0_p4_em = 0 ;
parameter real b0_a0_a0_p4_em = 0 ;
parameter real a0_a0_a0_p4_em = 0 ;
parameter real b0_b0_a1_p4_em = 4.74 ;
parameter real a0_b0_a1_p4_em = -0.0104 ;
parameter real b0_a0_a1_p4_em = -0.0955 ;
parameter real a0_a0_a1_p4_em = 0.000172 ;
parameter real b0_b0_a2_p4_em = -30.8 ;
parameter real a0_b0_a2_p4_em = 0.0767 ;
parameter real b0_a0_a2_p4_em = 0.452 ;
parameter real a0_a0_a2_p4_em = -0.00128 ;
parameter real b0_b0_a3_p4_em = 91.8 ;
parameter real a0_b0_a3_p4_em = 0.0253 ;
parameter real b0_a0_a3_p4_em = 1.83 ;
parameter real a0_a0_a3_p4_em = -0.00492 ;
parameter real b0_b0_a4_p4_em = 0 ;
parameter real a0_b0_a4_p4_em = 0 ;
parameter real b0_a0_a4_p4_em = 0 ;
parameter real a0_a0_a4_p4_em = 0 ;
parameter real b0_b0_p1_p4_em = 0.867 ;
parameter real a0_b0_p1_p4_em = -0.00466 ;
parameter real b0_a0_p1_p4_em = -0.196 ;
parameter real a0_a0_p1_p4_em = 0.000438 ;
parameter real b0_b0_p2_p4_em = 1.71 ;
parameter real a0_b0_p2_p4_em = -0.000729 ;
parameter real b0_a0_p2_p4_em = -0.0515 ;
parameter real a0_a0_p2_p4_em = 0.000102 ;
parameter real b0_b0_p3_p4_em = 2.95 ;
parameter real a0_b0_p3_p4_em = -9.66E-05 ;
parameter real b0_a0_p3_p4_em = 0.00906 ;
parameter real a0_a0_p3_p4_em = -2.63E-05 ;
parameter real b0_b0_p4_p4_em = 3.49 ;
parameter real a0_b0_p4_p4_em = -0.00113 ;
parameter real b0_a0_p4_p4_em = 0.00189 ;
parameter real a0_a0_p4_p4_em = -4.62E-06 ;
     
   


parameter real        relimo_d_hci1 = 10.0;

parameter real        relimo_a1 = 0.698;
parameter real        relimo_a2 = 1.38;
parameter real        relimo_c1 = 8.38e5;
parameter real        relimo_alpha1 = 5.27e-13;
parameter real        relimo_m1 = 1.07;
parameter real        relimo_lamda0 = 6.14e-7;
parameter real        relimo_fstat1 = 0.00254;
parameter real        relimo_Ep = 0.063;
parameter real        relimo_Feb = 3.2;

parameter real        relimo_a_hci3 = 351;
parameter real        relimo_n_hci3 = 0.419;
parameter real        relimo_alpha2 = 7.44E+19;
parameter real        relimo_beta2 = 4.68E-08;
parameter real        relimo_gama2 = 17.9;
parameter real        relimo_eps2 = 7.62;
parameter real        relimo_eta2 = 0;
parameter real        relimo_ea2 = 0.81;
parameter real        relimo_rth = 0.00571;
parameter real        relimo_fstat2 = 0.0146;

			
			
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vddtransistor, id, id1, id2, vdsmax, vgsmax;
real delta_damage1, delta_damage2, delta_damage3, last_delta_damage1, last_delta_damage2, last_delta_damage3, damage1, damage2, damage3;
real dt, last_abstime;  
real temp1;
real delta_idsat;
real lamda;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			//dummy lines for avoiding warnings.
			temp1 = relimo_condvg + relimo_condvd;
			temp1 = relimo_intercept + relimo_r;
			vddtransistor = temp1;
			//finish dummy lines for avoiding warnings.
			
			id1 = $simprobe(relimo_probe_name, "ide");
			id2 = 0;
			id = abs(id1+id2);

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			if(relimo_function == 1) begin
				vddtransistor = abs(vds);
			end else begin
				vddtransistor = abs(vgs);
			end
			
			delta_damage1 = 0;
			delta_damage2 = 0;
			delta_damage3 = 0;
			if(relimo_vth > 0) begin
				if(vds > 1e-5) begin	// off state HCI.
					delta_damage1 = 1/exp(relimo_intercept-relimo_c*vddtransistor)*1/(relimo_a_idsat*relimo_m)*exp(-1*relimo_e/(relimo_kb*$temperature));
				end
				
				`EM($temperature, vgs, vds, (V(sub)-V(s)))
				if (em == 0) begin
					lamda = 0;
					delta_damage2 = 0;
				end else begin
					lamda = relimo_lamda0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
					delta_damage2 = 1.0/(relimo_fstat1*relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb/(em*lamda)*exp(relimo_Feb/(em*lamda)));
				end
				
				if(vds > 0 && vgs > 0) begin	// High V HCI.
					delta_damage3 = 1.0/(relimo_fstat2*relimo_alpha2*pow(w*1e-6/id,relimo_beta2)*pow(vgs,-1*relimo_gama2)*pow(vds,-1*relimo_eps2)*exp(-1*relimo_eta2*abs(V(sub)-V(s)))*exp(relimo_ea2/relimo_kb/($temperature+relimo_rth*id*vds/(w*1e-6))));
				end
			
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				damage2 = damage2 + dt/2*(delta_damage2 + last_delta_damage2);
				damage3 = damage3 + dt/2*(delta_damage3 + last_delta_damage3);
				last_delta_damage1 = delta_damage1;
				last_delta_damage2 = delta_damage2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, delta_damage2, lamda, id);
        	//$display("Parameter %M in device %e, %e, %e, %e", $temperature, vgs, vds, (V(sub)-V(s)));
        	//$display("Parameter %M in device %e, %e, %e, %e", relimo_eps2, relimo_eta2, (V(sub)-V(s)), relimo_ea2);
        	//$display("Parameter %M in device %e, %e, %e, %e", ($temperature+relimo_rth*id*vds/(w*1e-6)), delta_damage3, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2 = damage2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
					damage2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
				damage2 = delta_damage2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
      			end
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, (V(sub)-V(s)), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", damage1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", damage2);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2 = damage2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
				damage2 = 0;
				damage3 = 0;
      			end
			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage1 == 0) begin
				damage1 = 1e-12;
			end
			if (damage2 == 0) begin
				damage2 = 1e-12;
			end
			if (damage3 == 0) begin
				damage3 = 1e-12;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, 0.0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", damage1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", damage2);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0/relimo_c1*damage2);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", relimo_d_hci1);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
			
		end	
	end
end
endmodule

module relimo_aging_bti_pmos_ana(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_nbti_aging_open_flag  = 0;
parameter real        relimo_pbti_aging_open_flag  = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "fet";
parameter string      relimo_probe_name            = "fet";

parameter real        relimo_n_nbti                = 0.201;
parameter real        relimo_alpha_nbti            = 2.43e-5;
parameter real        relimo_m_nbti                = 13.9;
parameter real        relimo_e_nbti                = 0.916;
parameter real        relimo_fstat_nbti            = 0.0159;

parameter real        relimo_n_pbti                = 0.51;
parameter real        relimo_alpha_pbti            = 2.45e-4;
parameter real        relimo_m_pbti                = 7.3;
parameter real        relimo_e_pbti                = 1.04;
parameter real        relimo_fstat_pbti            = 0.003;

parameter real        relimo_kb                    = 8.62e-5;


// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgsub, vgs, vds, vdsmax, vgsmax; 
real dt, last_abstime; 
real damage_nbti, delta_damage_nbti, last_delta_damage_nbti; 
real damage_pbti, delta_damage_pbti, last_delta_damage_pbti; 
   
// Start simulatoin
analog begin
	if($abstime>=relimo_aging_tstart) begin
		dt                = ($abstime - last_abstime);	
		last_abstime      = $abstime;			
	end else begin
		last_abstime   = $abstime;
	end
	if(relimo_nbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vgs = -max(-vgs, -(vgs-vds));
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			if(vgs < 0) begin 
				delta_damage_nbti = 1.0/(relimo_fstat_nbti*relimo_alpha_nbti)*pow(abs(vgs), relimo_m_nbti)*exp(-1*relimo_e_nbti/(relimo_kb*$temperature));
			end else begin
				delta_damage_nbti = 0;
			end
			//$display ("%M, %e, %e, %e, %e, %e, %e, %e, %e", relimo_fstat_nbti, relimo_alpha_nbti, vgs, relimo_m_nbti, delta_damage_nbti,relimo_e_nbti,relimo_kb,$temperature);
			if($abstime>=relimo_aging_tstart) begin
				damage_nbti       = damage_nbti+dt/2*(delta_damage_nbti+last_delta_damage_nbti);
				last_delta_damage_nbti = delta_damage_nbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	if(relimo_pbti_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgsub = V(g)-V(sub);
			if(vgsub < 0) begin 
				delta_damage_pbti = 0;
			end else begin
				delta_damage_pbti = 1.0/(relimo_fstat_pbti*relimo_alpha_pbti)*pow(abs(vgsub), relimo_m_pbti)*exp(-1*relimo_e_pbti/(relimo_kb*$temperature));
			end
			//$display ("%M, %e, %e, %e, %e, %e, %e, %e, %e", relimo_fstat_pbti, relimo_alpha_pbti, vgsub, relimo_m_pbti, delta_damage_pbti,relimo_e_pbti,relimo_kb,$temperature);
			if($abstime>=relimo_aging_tstart) begin
				damage_pbti       = damage_pbti+dt/2*(delta_damage_pbti+last_delta_damage_pbti);
				last_delta_damage_pbti = delta_damage_pbti;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end
		end
	end
	@(final_step) begin
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo+0.0*relimo_n_nbti, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
			//$display ("DDDDD %M, %e, %e, %e, %e, %e", V(g), (V(sub)-V(s)), vgsub, V(d), damage_pbti);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
				if ($abstime > relimo_aging_tstart) begin
					damage_nbti = (damage_nbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
					damage_pbti = (damage_pbti)*relimo_aging_time*3600/($abstime-relimo_aging_tstart);    
				end else begin
					damage_nbti = 0;
					damage_pbti = 0;
				end
			end else begin
				damage_nbti = delta_damage_nbti*relimo_aging_time*3600;      
				damage_pbti = delta_damage_pbti*relimo_aging_time*3600;      
      			end
			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s probe_name %s\n", relimo_device_name, relimo_probe_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			//$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", damage_nbti);
			//$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			if (damage_pbti==0) begin
				$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);
			end else begin
				$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 280.0, damage_pbti);
			end
			
			//$fwrite (results_aging_bi, "instance %M delta_u0_bi_nbti %e\n", 0.0);
			//$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_nbti %e\n", 0.0);
			//$fwrite (results_aging_bi, "instance %M delta_a0_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_u0_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_rdsw_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_a0_bi_pbti %e\n", 0.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
			if ($abstime > relimo_aging_tstart) begin
				damage_nbti = (damage_nbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
				damage_pbti = (damage_pbti)*(relimo_aging_time)*(3600*24*365.24)/($abstime-relimo_aging_tstart);     
			end else begin
				damage_nbti = 0;
				damage_pbti = 0;
      			end
			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			//$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", damage_nbti);
			//$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0/relimo_n_nbti);
			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0/relimo_n_pbti);
			if (damage_pbti==0) begin
				$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);
			end else begin
				$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 280.0, damage_pbti);
			end
			
			//$fwrite (results_aging_op, "instance %M delta_u0_op_nbti %e\n", 0.0);
			//$fwrite (results_aging_op, "instance %M delta_rdsw_op_nbti %e\n", 0.0);
			//$fwrite (results_aging_op, "instance %M delta_a0_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_u0_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_rdsw_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_a0_op_pbti %e\n", 0.0);
		end
	end	
end
endmodule


module relimo_aging_hci_pld90b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pld90b";
parameter string      relimo_probe_name            = "amost";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.199;
parameter real        relimo_fstat3 = 0.0538;
parameter real        relimo_alpha3 = 8.50E+15;
parameter real        relimo_beta3 = 7.42E-09;
parameter real        relimo_gama3 = 13.9;
parameter real        relimo_eps3 = 4.34;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 1.18;
parameter real        relimo_rth = 0.0135;

// parameter for off state
parameter real        relimo_a1_off = 0.82;
parameter real        relimo_a2_off = 3.46;
parameter real        relimo_n1_off = 1.34;
parameter real        relimo_n2_off = 0.396;
parameter real        relimo_alpha1_off = 0.00443;
parameter real        relimo_beta1 = 0.09;
parameter real        relimo_ea1 = 0.99;
parameter real        relimo_alpha2_off = 1.16e6;
parameter real        relimo_beta2 = 0.155;
parameter real        relimo_ea2 = 0.339;
parameter real        fstat_tau1_off = 0.00987;
parameter real        fstat_tau2_off = 0.0215;
parameter real        fstat_tau1tau2_off = 47.4;
parameter real        fstat_tau2tau1_off = 47.4;
parameter real        m_sigma_a_off = 1;
parameter real        delta_sigma_a_off = 0.5;
parameter real        m_sigma_b_off = 1;
parameter real        delta_sigma_b_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Ep = 0.063;
parameter real        relimo_lamda_h0 = 2.22E-06;
parameter real        relimo_alpha1 = 39.8;
parameter real        relimo_m1 = 0.99;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_lamda_el0 = 3.38E-07;
parameter real        relimo_alpha2 = 2.52E-42;
parameter real        relimo_m2 = 0.844;
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_a1 = 2.4272;
parameter real        relimo_a2 = 1.3464E-07;
parameter real        relimo_c1 = 2.4223E+09;
parameter real        relimo_b = 7.1575E-05;
parameter real        relimo_n_hci = 3;
parameter real        m_sigma_b = 1;
parameter real        delta_sigma_b = 0.4;
parameter real        m_sigma_a = 1;
parameter real        delta_sigma_a = 6;
parameter real        fstat_tau1 = 0.0119;
parameter real        fstat_tau2 = 0.00213;
parameter real        fstat_tau1tau2 = 115;
parameter real        fstat_tau2tau1 = 115;
parameter real        vgs_cutoff_HCI = -0.4;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1/1.0636;
parameter real        relimo_ratio21_b               = 0;

parameter real        relimo_ratio_vth               = 1/1.2052;

parameter real        relimo_ratio_vth2a0            = 16;

parameter real b0_b0_b0_b0_em = 0;
parameter real a0_b0_b0_b0_em = 0;
parameter real b0_a0_b0_b0_em = 0;
parameter real a0_a0_b0_b0_em = 0;
parameter real b0_b0_a0_b0_em = 0;
parameter real a0_b0_a0_b0_em = 0;
parameter real b0_a0_a0_b0_em = 0;
parameter real a0_a0_a0_b0_em = 0;
parameter real b0_b0_a1_b0_em = 0;
parameter real a0_b0_a1_b0_em = 0;
parameter real b0_a0_a1_b0_em = 0;
parameter real a0_a0_a1_b0_em = 0;
parameter real b0_b0_a2_b0_em = 0;
parameter real a0_b0_a2_b0_em = 0;
parameter real b0_a0_a2_b0_em = 0;
parameter real a0_a0_a2_b0_em = 0;
parameter real b0_b0_a3_b0_em = 0;
parameter real a0_b0_a3_b0_em = 0;
parameter real b0_a0_a3_b0_em = 0;
parameter real a0_a0_a3_b0_em = 0;
parameter real b0_b0_a4_b0_em = 0;
parameter real a0_b0_a4_b0_em = 0;
parameter real b0_a0_a4_b0_em = 0;
parameter real a0_a0_a4_b0_em = 0;
parameter real b0_b0_p1_b0_em = 0;
parameter real a0_b0_p1_b0_em = 0;
parameter real b0_a0_p1_b0_em = 0;
parameter real a0_a0_p1_b0_em = 0;
parameter real b0_b0_p2_b0_em = 0;
parameter real a0_b0_p2_b0_em = 0;
parameter real b0_a0_p2_b0_em = 0;
parameter real a0_a0_p2_b0_em = 0;
parameter real b0_b0_p3_b0_em = 0;
parameter real a0_b0_p3_b0_em = 0;
parameter real b0_a0_p3_b0_em = 0;
parameter real a0_a0_p3_b0_em = 0;
parameter real b0_b0_p4_b0_em = 0;
parameter real a0_b0_p4_b0_em = 0;
parameter real b0_a0_p4_b0_em = 0;
parameter real a0_a0_p4_b0_em = 0;
parameter real b0_b0_b0_a0_em = 0;
parameter real a0_b0_b0_a0_em = 0;
parameter real b0_a0_b0_a0_em = 0;
parameter real a0_a0_b0_a0_em = 0;
parameter real b0_b0_a0_a0_em = 0;
parameter real a0_b0_a0_a0_em = 0;
parameter real b0_a0_a0_a0_em = 0;
parameter real a0_a0_a0_a0_em = 0;
parameter real b0_b0_a1_a0_em = 0;
parameter real a0_b0_a1_a0_em = 0;
parameter real b0_a0_a1_a0_em = 0;
parameter real a0_a0_a1_a0_em = 0;
parameter real b0_b0_a2_a0_em = 0;
parameter real a0_b0_a2_a0_em = 0;
parameter real b0_a0_a2_a0_em = 0;
parameter real a0_a0_a2_a0_em = 0;
parameter real b0_b0_a3_a0_em = 0;
parameter real a0_b0_a3_a0_em = 0;
parameter real b0_a0_a3_a0_em = 0;
parameter real a0_a0_a3_a0_em = 0;
parameter real b0_b0_a4_a0_em = 0;
parameter real a0_b0_a4_a0_em = 0;
parameter real b0_a0_a4_a0_em = 0;
parameter real a0_a0_a4_a0_em = 0;
parameter real b0_b0_p1_a0_em = 0;
parameter real a0_b0_p1_a0_em = 0;
parameter real b0_a0_p1_a0_em = 0;
parameter real a0_a0_p1_a0_em = 0;
parameter real b0_b0_p2_a0_em = 0;
parameter real a0_b0_p2_a0_em = 0;
parameter real b0_a0_p2_a0_em = 0;
parameter real a0_a0_p2_a0_em = 0;
parameter real b0_b0_p3_a0_em = 0;
parameter real a0_b0_p3_a0_em = 0;
parameter real b0_a0_p3_a0_em = 0;
parameter real a0_a0_p3_a0_em = 0;
parameter real b0_b0_p4_a0_em = 0;
parameter real a0_b0_p4_a0_em = 0;
parameter real b0_a0_p4_a0_em = 0;
parameter real a0_a0_p4_a0_em = 0;
parameter real b0_b0_b0_a1_em = 7430;
parameter real a0_b0_b0_a1_em = -0.68;
parameter real b0_a0_b0_a1_em = 0;
parameter real a0_a0_b0_a1_em = 0;
parameter real b0_b0_a0_a1_em = 0;
parameter real a0_b0_a0_a1_em = 0;
parameter real b0_a0_a0_a1_em = 0;
parameter real a0_a0_a0_a1_em = 0;
parameter real b0_b0_a1_a1_em = 1300;
parameter real a0_b0_a1_a1_em = -1.19;
parameter real b0_a0_a1_a1_em = 0;
parameter real a0_a0_a1_a1_em = 0;
parameter real b0_b0_a2_a1_em = 38.2;
parameter real a0_b0_a2_a1_em = -0.161;
parameter real b0_a0_a2_a1_em = 0;
parameter real a0_a0_a2_a1_em = 0;
parameter real b0_b0_a3_a1_em = -127;
parameter real a0_b0_a3_a1_em = -0.577;
parameter real b0_a0_a3_a1_em = 0;
parameter real a0_a0_a3_a1_em = 0;
parameter real b0_b0_a4_a1_em = 0;
parameter real a0_b0_a4_a1_em = 0;
parameter real b0_a0_a4_a1_em = 0;
parameter real a0_a0_a4_a1_em = 0;
parameter real b0_b0_p1_a1_em = 2.49;
parameter real a0_b0_p1_a1_em = -0.000392;
parameter real b0_a0_p1_a1_em = 0;
parameter real a0_a0_p1_a1_em = 0;
parameter real b0_b0_p2_a1_em = 2.83;
parameter real a0_b0_p2_a1_em = 0.000997;
parameter real b0_a0_p2_a1_em = 0;
parameter real a0_a0_p2_a1_em = 0;
parameter real b0_b0_p3_a1_em = 3.54;
parameter real a0_b0_p3_a1_em = 0.00365;
parameter real b0_a0_p3_a1_em = 0;
parameter real a0_a0_p3_a1_em = 0;
parameter real b0_b0_p4_a1_em = 6;
parameter real a0_b0_p4_a1_em = 0;
parameter real b0_a0_p4_a1_em = 0;
parameter real a0_a0_p4_a1_em = 0;
parameter real b0_b0_b0_a2_em = 2310;
parameter real a0_b0_b0_a2_em = 0.251;
parameter real b0_a0_b0_a2_em = 0;
parameter real a0_a0_b0_a2_em = 0;
parameter real b0_b0_a0_a2_em = 0;
parameter real a0_b0_a0_a2_em = 0;
parameter real b0_a0_a0_a2_em = 0;
parameter real a0_a0_a0_a2_em = 0;
parameter real b0_b0_a1_a2_em = 2770;
parameter real a0_b0_a1_a2_em = -8.95;
parameter real b0_a0_a1_a2_em = 0;
parameter real a0_a0_a1_a2_em = 0;
parameter real b0_b0_a2_a2_em = 1770;
parameter real a0_b0_a2_a2_em = -2.52;
parameter real b0_a0_a2_a2_em = 0;
parameter real a0_a0_a2_a2_em = 0;
parameter real b0_b0_a3_a2_em = -854;
parameter real a0_b0_a3_a2_em = 1.39;
parameter real b0_a0_a3_a2_em = 0;
parameter real a0_a0_a3_a2_em = 0;
parameter real b0_b0_a4_a2_em = 0;
parameter real a0_b0_a4_a2_em = 0;
parameter real b0_a0_a4_a2_em = 0;
parameter real a0_a0_a4_a2_em = 0;
parameter real b0_b0_p1_a2_em = 2.15;
parameter real a0_b0_p1_a2_em = -0.00274;
parameter real b0_a0_p1_a2_em = 0;
parameter real a0_a0_p1_a2_em = 0;
parameter real b0_b0_p2_a2_em = 2.16;
parameter real a0_b0_p2_a2_em = -0.00262;
parameter real b0_a0_p2_a2_em = 0;
parameter real a0_a0_p2_a2_em = 0;
parameter real b0_b0_p3_a2_em = 1.96;
parameter real a0_b0_p3_a2_em = 0.000631;
parameter real b0_a0_p3_a2_em = 0;
parameter real a0_a0_p3_a2_em = 0;
parameter real b0_b0_p4_a2_em = 3;
parameter real a0_b0_p4_a2_em = 0;
parameter real b0_a0_p4_a2_em = 0;
parameter real a0_a0_p4_a2_em = 0;
parameter real b0_b0_b0_a3_em = 630;
parameter real a0_b0_b0_a3_em = 0.563;
parameter real b0_a0_b0_a3_em = -0.0182;
parameter real a0_a0_b0_a3_em = -0.0132;
parameter real b0_b0_a0_a3_em = 0;
parameter real a0_b0_a0_a3_em = 0;
parameter real b0_a0_a0_a3_em = 0;
parameter real a0_a0_a0_a3_em = 0;
parameter real b0_b0_a1_a3_em = 42.9;
parameter real a0_b0_a1_a3_em = 0.0964;
parameter real b0_a0_a1_a3_em = 0.37;
parameter real a0_a0_a1_a3_em = 0.000772;
parameter real b0_b0_a2_a3_em = -708;
parameter real a0_b0_a2_a3_em = 1.47;
parameter real b0_a0_a2_a3_em = -0.105;
parameter real a0_a0_a2_a3_em = 0.00183;
parameter real b0_b0_a3_a3_em = -126;
parameter real a0_b0_a3_a3_em = 1.42;
parameter real b0_a0_a3_a3_em = -0.000318;
parameter real a0_a0_a3_a3_em = -0.074;
parameter real b0_b0_a4_a3_em = 0;
parameter real a0_b0_a4_a3_em = 0;
parameter real b0_a0_a4_a3_em = 0;
parameter real a0_a0_a4_a3_em = 0;
parameter real b0_b0_p1_a3_em = -6.04;
parameter real a0_b0_p1_a3_em = 0.00519;
parameter real b0_a0_p1_a3_em = 0.745;
parameter real a0_a0_p1_a3_em = -0.00171;
parameter real b0_b0_p2_a3_em = 1.27;
parameter real a0_b0_p2_a3_em = -0.00255;
parameter real b0_a0_p2_a3_em = 0.017;
parameter real a0_a0_p2_a3_em = -0.0000571;
parameter real b0_b0_p3_a3_em = 1.33;
parameter real a0_b0_p3_a3_em = 0.00543;
parameter real b0_a0_p3_a3_em = -0.000000215;
parameter real a0_a0_p3_a3_em = -0.0000475;
parameter real b0_b0_p4_a3_em = 6;
parameter real a0_b0_p4_a3_em = 0;
parameter real b0_a0_p4_a3_em = 0;
parameter real a0_a0_p4_a3_em = 0;
parameter real b0_b0_b0_a4_em = 1410;
parameter real a0_b0_b0_a4_em = -0.0711;
parameter real b0_a0_b0_a4_em = -0.275;
parameter real a0_a0_b0_a4_em = -0.0234;
parameter real b0_b0_a0_a4_em = 0;
parameter real a0_b0_a0_a4_em = 0;
parameter real b0_a0_a0_a4_em = 0;
parameter real a0_a0_a0_a4_em = 0;
parameter real b0_b0_a1_a4_em = -1300;
parameter real a0_b0_a1_a4_em = 4.97;
parameter real b0_a0_a1_a4_em = 0.00286;
parameter real a0_a0_a1_a4_em = 0.0454;
parameter real b0_b0_a2_a4_em = 92.4;
parameter real a0_b0_a2_a4_em = -0.224;
parameter real b0_a0_a2_a4_em = 0;
parameter real a0_a0_a2_a4_em = -0.0576;
parameter real b0_b0_a3_a4_em = 528;
parameter real a0_b0_a3_a4_em = -1.58;
parameter real b0_a0_a3_a4_em = -0.0000649;
parameter real a0_a0_a3_a4_em = -0.0171;
parameter real b0_b0_a4_a4_em = 0;
parameter real a0_b0_a4_a4_em = 0;
parameter real b0_a0_a4_a4_em = 0;
parameter real a0_a0_a4_a4_em = 0;
parameter real b0_b0_p1_a4_em = 0.52;
parameter real a0_b0_p1_a4_em = 0.011;
parameter real b0_a0_p1_a4_em = -0.0401;
parameter real a0_a0_p1_a4_em = 0.0002;
parameter real b0_b0_p2_a4_em = 2.78;
parameter real a0_b0_p2_a4_em = 0.00136;
parameter real b0_a0_p2_a4_em = 0.000269;
parameter real a0_a0_p2_a4_em = 0.00000646;
parameter real b0_b0_p3_a4_em = -3.15;
parameter real a0_b0_p3_a4_em = 0.0104;
parameter real b0_a0_p3_a4_em = -0.000159;
parameter real a0_a0_p3_a4_em = -0.000844;
parameter real b0_b0_p4_a4_em = 6;
parameter real a0_b0_p4_a4_em = 0;
parameter real b0_a0_p4_a4_em = 0;
parameter real a0_a0_p4_a4_em = 0;
parameter real b0_b0_b0_p1_em = 0.0172;
parameter real a0_b0_b0_p1_em = 0;
parameter real b0_a0_b0_p1_em = 0;
parameter real a0_a0_b0_p1_em = 0;
parameter real b0_b0_a0_p1_em = 0;
parameter real a0_b0_a0_p1_em = 0;
parameter real b0_a0_a0_p1_em = 0;
parameter real a0_a0_a0_p1_em = 0;
parameter real b0_b0_a1_p1_em = 3.35;
parameter real a0_b0_a1_p1_em = 0;
parameter real b0_a0_a1_p1_em = 0;
parameter real a0_a0_a1_p1_em = 0;
parameter real b0_b0_a2_p1_em = 7.56;
parameter real a0_b0_a2_p1_em = 0;
parameter real b0_a0_a2_p1_em = 0;
parameter real a0_a0_a2_p1_em = 0;
parameter real b0_b0_a3_p1_em = 2.84;
parameter real a0_b0_a3_p1_em = 0;
parameter real b0_a0_a3_p1_em = 0;
parameter real a0_a0_a3_p1_em = 0;
parameter real b0_b0_a4_p1_em = 0;
parameter real a0_b0_a4_p1_em = 0;
parameter real b0_a0_a4_p1_em = 0;
parameter real a0_a0_a4_p1_em = 0;
parameter real b0_b0_p1_p1_em = 1.05;
parameter real a0_b0_p1_p1_em = 0;
parameter real b0_a0_p1_p1_em = 0;
parameter real a0_a0_p1_p1_em = 0;
parameter real b0_b0_p2_p1_em = 2.43;
parameter real a0_b0_p2_p1_em = 0;
parameter real b0_a0_p2_p1_em = 0;
parameter real a0_a0_p2_p1_em = 0;
parameter real b0_b0_p3_p1_em = 3.52;
parameter real a0_b0_p3_p1_em = 0;
parameter real b0_a0_p3_p1_em = 0;
parameter real a0_a0_p3_p1_em = 0;
parameter real b0_b0_p4_p1_em = 6.02;
parameter real a0_b0_p4_p1_em = 0;
parameter real b0_a0_p4_p1_em = 0;
parameter real a0_a0_p4_p1_em = 0;
parameter real b0_b0_b0_p2_em = 26.1;
parameter real a0_b0_b0_p2_em = 0.00513;
parameter real b0_a0_b0_p2_em = 0;
parameter real a0_a0_b0_p2_em = 0;
parameter real b0_b0_a0_p2_em = 0;
parameter real a0_b0_a0_p2_em = 0;
parameter real b0_a0_a0_p2_em = 0;
parameter real a0_a0_a0_p2_em = 0;
parameter real b0_b0_a1_p2_em = -0.292;
parameter real a0_b0_a1_p2_em = -0.00197;
parameter real b0_a0_a1_p2_em = 0;
parameter real a0_a0_a1_p2_em = 0;
parameter real b0_b0_a2_p2_em = -5.9;
parameter real a0_b0_a2_p2_em = 0.0021;
parameter real b0_a0_a2_p2_em = 0;
parameter real a0_a0_a2_p2_em = 0;
parameter real b0_b0_a3_p2_em = 0.67;
parameter real a0_b0_a3_p2_em = 0.00212;
parameter real b0_a0_a3_p2_em = 0;
parameter real a0_a0_a3_p2_em = 0;
parameter real b0_b0_a4_p2_em = 0;
parameter real a0_b0_a4_p2_em = 0;
parameter real b0_a0_a4_p2_em = 0;
parameter real a0_a0_a4_p2_em = 0;
parameter real b0_b0_p1_p2_em = -1;
parameter real a0_b0_p1_p2_em = 0;
parameter real b0_a0_p1_p2_em = 0;
parameter real a0_a0_p1_p2_em = 0;
parameter real b0_b0_p2_p2_em = 2.22;
parameter real a0_b0_p2_p2_em = -0.00193;
parameter real b0_a0_p2_p2_em = 0;
parameter real a0_a0_p2_p2_em = 0;
parameter real b0_b0_p3_p2_em = 2.54;
parameter real a0_b0_p3_p2_em = -0.000599;
parameter real b0_a0_p3_p2_em = 0;
parameter real a0_a0_p3_p2_em = 0;
parameter real b0_b0_p4_p2_em = 6.39;
parameter real a0_b0_p4_p2_em = -0.00437;
parameter real b0_a0_p4_p2_em = 0;
parameter real a0_a0_p4_p2_em = 0;
parameter real b0_b0_b0_p3_em = 40.2;
parameter real a0_b0_b0_p3_em = -0.0483;
parameter real b0_a0_b0_p3_em = -0.184;
parameter real a0_a0_b0_p3_em = 0.000818;
parameter real b0_b0_a0_p3_em = 0;
parameter real a0_b0_a0_p3_em = 0;
parameter real b0_a0_a0_p3_em = 0;
parameter real a0_a0_a0_p3_em = 0;
parameter real b0_b0_a1_p3_em = 1.67;
parameter real a0_b0_a1_p3_em = 0.0258;
parameter real b0_a0_a1_p3_em = 0.00679;
parameter real a0_a0_a1_p3_em = -0.000444;
parameter real b0_b0_a2_p3_em = 10.2;
parameter real a0_b0_a2_p3_em = -0.0141;
parameter real b0_a0_a2_p3_em = 0.0154;
parameter real a0_a0_a2_p3_em = -0.0000581;
parameter real b0_b0_a3_p3_em = 5.77;
parameter real a0_b0_a3_p3_em = 0.00601;
parameter real b0_a0_a3_p3_em = 0.00000839;
parameter real a0_a0_a3_p3_em = 0.00196;
parameter real b0_b0_a4_p3_em = 0;
parameter real a0_b0_a4_p3_em = 0;
parameter real b0_a0_a4_p3_em = 0;
parameter real a0_a0_a4_p3_em = 0;
parameter real b0_b0_p1_p3_em = 1.66;
parameter real a0_b0_p1_p3_em = -0.00156;
parameter real b0_a0_p1_p3_em = 0.0453;
parameter real a0_a0_p1_p3_em = -0.000109;
parameter real b0_b0_p2_p3_em = -0.0507;
parameter real a0_b0_p2_p3_em = 0.00423;
parameter real b0_a0_p2_p3_em = 0.0552;
parameter real a0_a0_p2_p3_em = -0.000127;
parameter real b0_b0_p3_p3_em = 1.35;
parameter real a0_b0_p3_p3_em = 0.00294;
parameter real b0_a0_p3_p3_em = -0.000000325;
parameter real a0_a0_p3_p3_em = -0.0000753;
parameter real b0_b0_p4_p3_em = 6;
parameter real a0_b0_p4_p3_em = 0;
parameter real b0_a0_p4_p3_em = 0;
parameter real a0_a0_p4_p3_em = 0;
parameter real b0_b0_b0_p4_em = 66.1;
parameter real a0_b0_b0_p4_em = -0.0778;
parameter real b0_a0_b0_p4_em = 1.22;
parameter real a0_a0_b0_p4_em = -0.0066;
parameter real b0_b0_a0_p4_em = 0;
parameter real a0_b0_a0_p4_em = 0;
parameter real b0_a0_a0_p4_em = 0;
parameter real a0_a0_a0_p4_em = 0;
parameter real b0_b0_a1_p4_em = 151;
parameter real a0_b0_a1_p4_em = 0.0117;
parameter real b0_a0_a1_p4_em = -0.0000495;
parameter real a0_a0_a1_p4_em = -0.0081;
parameter real b0_b0_a2_p4_em = -19.8;
parameter real a0_b0_a2_p4_em = 0.126;
parameter real b0_a0_a2_p4_em = -0.604;
parameter real a0_a0_a2_p4_em = 0.00275;
parameter real b0_b0_a3_p4_em = 34.1;
parameter real a0_b0_a3_p4_em = -0.0721;
parameter real b0_a0_a3_p4_em = -0.000035;
parameter real a0_a0_a3_p4_em = -0.00816;
parameter real b0_b0_a4_p4_em = 0;
parameter real a0_b0_a4_p4_em = 0;
parameter real b0_a0_a4_p4_em = 0;
parameter real a0_a0_a4_p4_em = 0;
parameter real b0_b0_p1_p4_em = 0.819;
parameter real a0_b0_p1_p4_em = -0.00126;
parameter real b0_a0_p1_p4_em = -0.00372;
parameter real a0_a0_p1_p4_em = 0.000061;
parameter real b0_b0_p2_p4_em = 1.09;
parameter real a0_b0_p2_p4_em = -0.00225;
parameter real b0_a0_p2_p4_em = 0.00253;
parameter real a0_a0_p2_p4_em = 0.0000383;
parameter real b0_b0_p3_p4_em = 2.97;
parameter real a0_b0_p3_p4_em = 0.0019;
parameter real b0_a0_p3_p4_em = -0.0000000692;
parameter real a0_a0_p3_p4_em = -0.0000165;
parameter real b0_b0_p4_p4_em = 3;
parameter real a0_b0_p4_p4_em = 0.00477;
parameter real b0_a0_p4_p4_em = 0;
parameter real a0_a0_p4_p4_em = 0;


parameter real b0_b0_b0_b0_em2 = 0;
parameter real a0_b0_b0_b0_em2 = 0;
parameter real b0_a0_b0_b0_em2 = 0;
parameter real a0_a0_b0_b0_em2 = 0;
parameter real b0_b0_a0_b0_em2 = 0;
parameter real a0_b0_a0_b0_em2 = 0;
parameter real b0_a0_a0_b0_em2 = 0;
parameter real a0_a0_a0_b0_em2 = 0;
parameter real b0_b0_a1_b0_em2 = 0;
parameter real a0_b0_a1_b0_em2 = 0;
parameter real b0_a0_a1_b0_em2 = 0;
parameter real a0_a0_a1_b0_em2 = 0;
parameter real b0_b0_a2_b0_em2 = 0;
parameter real a0_b0_a2_b0_em2 = 0;
parameter real b0_a0_a2_b0_em2 = 0;
parameter real a0_a0_a2_b0_em2 = 0;
parameter real b0_b0_a3_b0_em2 = 0;
parameter real a0_b0_a3_b0_em2 = 0;
parameter real b0_a0_a3_b0_em2 = 0;
parameter real a0_a0_a3_b0_em2 = 0;
parameter real b0_b0_a4_b0_em2 = 0;
parameter real a0_b0_a4_b0_em2 = 0;
parameter real b0_a0_a4_b0_em2 = 0;
parameter real a0_a0_a4_b0_em2 = 0;
parameter real b0_b0_p1_b0_em2 = 0;
parameter real a0_b0_p1_b0_em2 = 0;
parameter real b0_a0_p1_b0_em2 = 0;
parameter real a0_a0_p1_b0_em2 = 0;
parameter real b0_b0_p2_b0_em2 = 0;
parameter real a0_b0_p2_b0_em2 = 0;
parameter real b0_a0_p2_b0_em2 = 0;
parameter real a0_a0_p2_b0_em2 = 0;
parameter real b0_b0_p3_b0_em2 = 0;
parameter real a0_b0_p3_b0_em2 = 0;
parameter real b0_a0_p3_b0_em2 = 0;
parameter real a0_a0_p3_b0_em2 = 0;
parameter real b0_b0_p4_b0_em2 = 0;
parameter real a0_b0_p4_b0_em2 = 0;
parameter real b0_a0_p4_b0_em2 = 0;
parameter real a0_a0_p4_b0_em2 = 0;
parameter real b0_b0_b0_a0_em2 = 0;
parameter real a0_b0_b0_a0_em2 = 0;
parameter real b0_a0_b0_a0_em2 = 0;
parameter real a0_a0_b0_a0_em2 = 0;
parameter real b0_b0_a0_a0_em2 = 0;
parameter real a0_b0_a0_a0_em2 = 0;
parameter real b0_a0_a0_a0_em2 = 0;
parameter real a0_a0_a0_a0_em2 = 0;
parameter real b0_b0_a1_a0_em2 = 0;
parameter real a0_b0_a1_a0_em2 = 0;
parameter real b0_a0_a1_a0_em2 = 0;
parameter real a0_a0_a1_a0_em2 = 0;
parameter real b0_b0_a2_a0_em2 = 0;
parameter real a0_b0_a2_a0_em2 = 0;
parameter real b0_a0_a2_a0_em2 = 0;
parameter real a0_a0_a2_a0_em2 = 0;
parameter real b0_b0_a3_a0_em2 = 0;
parameter real a0_b0_a3_a0_em2 = 0;
parameter real b0_a0_a3_a0_em2 = 0;
parameter real a0_a0_a3_a0_em2 = 0;
parameter real b0_b0_a4_a0_em2 = 0;
parameter real a0_b0_a4_a0_em2 = 0;
parameter real b0_a0_a4_a0_em2 = 0;
parameter real a0_a0_a4_a0_em2 = 0;
parameter real b0_b0_p1_a0_em2 = 0;
parameter real a0_b0_p1_a0_em2 = 0;
parameter real b0_a0_p1_a0_em2 = 0;
parameter real a0_a0_p1_a0_em2 = 0;
parameter real b0_b0_p2_a0_em2 = 0;
parameter real a0_b0_p2_a0_em2 = 0;
parameter real b0_a0_p2_a0_em2 = 0;
parameter real a0_a0_p2_a0_em2 = 0;
parameter real b0_b0_p3_a0_em2 = 0;
parameter real a0_b0_p3_a0_em2 = 0;
parameter real b0_a0_p3_a0_em2 = 0;
parameter real a0_a0_p3_a0_em2 = 0;
parameter real b0_b0_p4_a0_em2 = 0;
parameter real a0_b0_p4_a0_em2 = 0;
parameter real b0_a0_p4_a0_em2 = 0;
parameter real a0_a0_p4_a0_em2 = 0;
parameter real b0_b0_b0_a1_em2 = 9000;
parameter real a0_b0_b0_a1_em2 = 0;
parameter real b0_a0_b0_a1_em2 = 0;
parameter real a0_a0_b0_a1_em2 = 0;
parameter real b0_b0_a0_a1_em2 = 0;
parameter real a0_b0_a0_a1_em2 = 0;
parameter real b0_a0_a0_a1_em2 = 0;
parameter real a0_a0_a0_a1_em2 = 0;
parameter real b0_b0_a1_a1_em2 = 0;
parameter real a0_b0_a1_a1_em2 = 0;
parameter real b0_a0_a1_a1_em2 = 0;
parameter real a0_a0_a1_a1_em2 = 0;
parameter real b0_b0_a2_a1_em2 = 0;
parameter real a0_b0_a2_a1_em2 = 0;
parameter real b0_a0_a2_a1_em2 = 0;
parameter real a0_a0_a2_a1_em2 = 0;
parameter real b0_b0_a3_a1_em2 = 0;
parameter real a0_b0_a3_a1_em2 = 0;
parameter real b0_a0_a3_a1_em2 = 0;
parameter real a0_a0_a3_a1_em2 = 0;
parameter real b0_b0_a4_a1_em2 = 0;
parameter real a0_b0_a4_a1_em2 = 0;
parameter real b0_a0_a4_a1_em2 = 0;
parameter real a0_a0_a4_a1_em2 = 0;
parameter real b0_b0_p1_a1_em2 = 0;
parameter real a0_b0_p1_a1_em2 = 0;
parameter real b0_a0_p1_a1_em2 = 0;
parameter real a0_a0_p1_a1_em2 = 0;
parameter real b0_b0_p2_a1_em2 = 1;
parameter real a0_b0_p2_a1_em2 = 0;
parameter real b0_a0_p2_a1_em2 = 0;
parameter real a0_a0_p2_a1_em2 = 0;
parameter real b0_b0_p3_a1_em2 = 2;
parameter real a0_b0_p3_a1_em2 = 0;
parameter real b0_a0_p3_a1_em2 = 0;
parameter real a0_a0_p3_a1_em2 = 0;
parameter real b0_b0_p4_a1_em2 = 3;
parameter real a0_b0_p4_a1_em2 = 0;
parameter real b0_a0_p4_a1_em2 = 0;
parameter real a0_a0_p4_a1_em2 = 0;
parameter real b0_b0_b0_a2_em2 = 1430;
parameter real a0_b0_b0_a2_em2 = 0.866;
parameter real b0_a0_b0_a2_em2 = 0;
parameter real a0_a0_b0_a2_em2 = 0;
parameter real b0_b0_a0_a2_em2 = 0;
parameter real a0_b0_a0_a2_em2 = 0;
parameter real b0_a0_a0_a2_em2 = 0;
parameter real a0_a0_a0_a2_em2 = 0;
parameter real b0_b0_a1_a2_em2 = -2120;
parameter real a0_b0_a1_a2_em2 = 9.54;
parameter real b0_a0_a1_a2_em2 = 0;
parameter real a0_a0_a1_a2_em2 = 0;
parameter real b0_b0_a2_a2_em2 = 70.3;
parameter real a0_b0_a2_a2_em2 = -0.4;
parameter real b0_a0_a2_a2_em2 = 0;
parameter real a0_a0_a2_a2_em2 = 0;
parameter real b0_b0_a3_a2_em2 = 504;
parameter real a0_b0_a3_a2_em2 = -1.79;
parameter real b0_a0_a3_a2_em2 = 0;
parameter real a0_a0_a3_a2_em2 = 0;
parameter real b0_b0_a4_a2_em2 = 0;
parameter real a0_b0_a4_a2_em2 = 0;
parameter real b0_a0_a4_a2_em2 = 0;
parameter real a0_a0_a4_a2_em2 = 0;
parameter real b0_b0_p1_a2_em2 = 1.19;
parameter real a0_b0_p1_a2_em2 = -0.00148;
parameter real b0_a0_p1_a2_em2 = 0;
parameter real a0_a0_p1_a2_em2 = 0;
parameter real b0_b0_p2_a2_em2 = 1.53;
parameter real a0_b0_p2_a2_em2 = -0.00202;
parameter real b0_a0_p2_a2_em2 = 0;
parameter real a0_a0_p2_a2_em2 = 0;
parameter real b0_b0_p3_a2_em2 = 0.305;
parameter real a0_b0_p3_a2_em2 = 0.00481;
parameter real b0_a0_p3_a2_em2 = 0;
parameter real a0_a0_p3_a2_em2 = 0;
parameter real b0_b0_p4_a2_em2 = 4;
parameter real a0_b0_p4_a2_em2 = 0;
parameter real b0_a0_p4_a2_em2 = 0;
parameter real a0_a0_p4_a2_em2 = 0;
parameter real b0_b0_b0_a3_em2 = 537;
parameter real a0_b0_b0_a3_em2 = -0.235;
parameter real b0_a0_b0_a3_em2 = 0.038;
parameter real a0_a0_b0_a3_em2 = -0.00214;
parameter real b0_b0_a0_a3_em2 = 0;
parameter real a0_b0_a0_a3_em2 = 0;
parameter real b0_a0_a0_a3_em2 = 0;
parameter real a0_a0_a0_a3_em2 = 0;
parameter real b0_b0_a1_a3_em2 = -88.3;
parameter real a0_b0_a1_a3_em2 = 0.724;
parameter real b0_a0_a1_a3_em2 = -0.103;
parameter real a0_a0_a1_a3_em2 = 0.00541;
parameter real b0_b0_a2_a3_em2 = -1160;
parameter real a0_b0_a2_a3_em2 = 2.05;
parameter real b0_a0_a2_a3_em2 = -0.00851;
parameter real a0_a0_a2_a3_em2 = -0.00145;
parameter real b0_b0_a3_a3_em2 = -33.3;
parameter real a0_b0_a3_a3_em2 = 0.271;
parameter real b0_a0_a3_a3_em2 = -0.0202;
parameter real a0_a0_a3_a3_em2 = 0.000247;
parameter real b0_b0_a4_a3_em2 = 0;
parameter real a0_b0_a4_a3_em2 = 0;
parameter real b0_a0_a4_a3_em2 = 0;
parameter real a0_a0_a4_a3_em2 = 0;
parameter real b0_b0_p1_a3_em2 = -0.915;
parameter real a0_b0_p1_a3_em2 = 0.00467;
parameter real b0_a0_p1_a3_em2 = 0.00878;
parameter real a0_a0_p1_a3_em2 = -0.00000394;
parameter real b0_b0_p2_a3_em2 = 1.18;
parameter real a0_b0_p2_a3_em2 = 0.000194;
parameter real b0_a0_p2_a3_em2 = -0.00279;
parameter real a0_a0_p2_a3_em2 = 0.0000103;
parameter real b0_b0_p3_a3_em2 = -0.0447;
parameter real a0_b0_p3_a3_em2 = 0.00703;
parameter real b0_a0_p3_a3_em2 = -0.0186;
parameter real a0_a0_p3_a3_em2 = 0.0000811;
parameter real b0_b0_p4_a3_em2 = 4.13;
parameter real a0_b0_p4_a3_em2 = -0.00258;
parameter real b0_a0_p4_a3_em2 = -0.22;
parameter real a0_a0_p4_a3_em2 = 0.000708;
parameter real b0_b0_b0_a4_em2 = 480;
parameter real a0_b0_b0_a4_em2 = -0.524;
parameter real b0_a0_b0_a4_em2 = -0.207;
parameter real a0_a0_b0_a4_em2 = -0.0309;
parameter real b0_b0_a0_a4_em2 = 0;
parameter real a0_b0_a0_a4_em2 = 0;
parameter real b0_a0_a0_a4_em2 = 0;
parameter real a0_a0_a0_a4_em2 = 0;
parameter real b0_b0_a1_a4_em2 = -637;
parameter real a0_b0_a1_a4_em2 = 3.04;
parameter real b0_a0_a1_a4_em2 = -0.0223;
parameter real a0_a0_a1_a4_em2 = 0.0337;
parameter real b0_b0_a2_a4_em2 = -2550;
parameter real a0_b0_a2_a4_em2 = 3.48;
parameter real b0_a0_a2_a4_em2 = 0;
parameter real a0_a0_a2_a4_em2 = -0.027;
parameter real b0_b0_a3_a4_em2 = 1160;
parameter real a0_b0_a3_a4_em2 = -1.78;
parameter real b0_a0_a3_a4_em2 = 0.00387;
parameter real a0_a0_a3_a4_em2 = 0.00674;
parameter real b0_b0_a4_a4_em2 = 0;
parameter real a0_b0_a4_a4_em2 = 0;
parameter real b0_a0_a4_a4_em2 = 0;
parameter real a0_a0_a4_a4_em2 = 0;
parameter real b0_b0_p1_a4_em2 = 1.74;
parameter real a0_b0_p1_a4_em2 = 0.00164;
parameter real b0_a0_p1_a4_em2 = -0.0374;
parameter real a0_a0_p1_a4_em2 = 0.000111;
parameter real b0_b0_p2_a4_em2 = 3.75;
parameter real a0_b0_p2_a4_em2 = -0.00306;
parameter real b0_a0_p2_a4_em2 = -0.00795;
parameter real a0_a0_p2_a4_em2 = -0.000000485;
parameter real b0_b0_p3_a4_em2 = 3.11;
parameter real a0_b0_p3_a4_em2 = -0.000749;
parameter real b0_a0_p3_a4_em2 = 0.0000461;
parameter real a0_a0_p3_a4_em2 = -0.0000185;
parameter real b0_b0_p4_a4_em2 = 0.759;
parameter real a0_b0_p4_a4_em2 = 0.0123;
parameter real b0_a0_p4_a4_em2 = 0.0000000329;
parameter real a0_a0_p4_a4_em2 = 0.00000864;
parameter real b0_b0_b0_p1_em2 = 1.73;
parameter real a0_b0_b0_p1_em2 = 0;
parameter real b0_a0_b0_p1_em2 = 0;
parameter real a0_a0_b0_p1_em2 = 0;
parameter real b0_b0_a0_p1_em2 = 0;
parameter real a0_b0_a0_p1_em2 = 0;
parameter real b0_a0_a0_p1_em2 = 0;
parameter real a0_a0_a0_p1_em2 = 0;
parameter real b0_b0_a1_p1_em2 = 1.77;
parameter real a0_b0_a1_p1_em2 = 0;
parameter real b0_a0_a1_p1_em2 = 0;
parameter real a0_a0_a1_p1_em2 = 0;
parameter real b0_b0_a2_p1_em2 = 0.348;
parameter real a0_b0_a2_p1_em2 = 0;
parameter real b0_a0_a2_p1_em2 = 0;
parameter real a0_a0_a2_p1_em2 = 0;
parameter real b0_b0_a3_p1_em2 = -2.42;
parameter real a0_b0_a3_p1_em2 = 0;
parameter real b0_a0_a3_p1_em2 = 0;
parameter real a0_a0_a3_p1_em2 = 0;
parameter real b0_b0_a4_p1_em2 = 0;
parameter real a0_b0_a4_p1_em2 = 0;
parameter real b0_a0_a4_p1_em2 = 0;
parameter real a0_a0_a4_p1_em2 = 0;
parameter real b0_b0_p1_p1_em2 = -0.19;
parameter real a0_b0_p1_p1_em2 = 0;
parameter real b0_a0_p1_p1_em2 = 0;
parameter real a0_a0_p1_p1_em2 = 0;
parameter real b0_b0_p2_p1_em2 = 2.57;
parameter real a0_b0_p2_p1_em2 = 0;
parameter real b0_a0_p2_p1_em2 = 0;
parameter real a0_a0_p2_p1_em2 = 0;
parameter real b0_b0_p3_p1_em2 = 3.7;
parameter real a0_b0_p3_p1_em2 = 0;
parameter real b0_a0_p3_p1_em2 = 0;
parameter real a0_a0_p3_p1_em2 = 0;
parameter real b0_b0_p4_p1_em2 = 4.01;
parameter real a0_b0_p4_p1_em2 = 0;
parameter real b0_a0_p4_p1_em2 = 0;
parameter real a0_a0_p4_p1_em2 = 0;
parameter real b0_b0_b0_p2_em2 = 25.6;
parameter real a0_b0_b0_p2_em2 = -0.0179;
parameter real b0_a0_b0_p2_em2 = 0;
parameter real a0_a0_b0_p2_em2 = 0;
parameter real b0_b0_a0_p2_em2 = 0;
parameter real a0_b0_a0_p2_em2 = 0;
parameter real b0_a0_a0_p2_em2 = 0;
parameter real a0_a0_a0_p2_em2 = 0;
parameter real b0_b0_a1_p2_em2 = 5.64;
parameter real a0_b0_a1_p2_em2 = -0.00965;
parameter real b0_a0_a1_p2_em2 = 0;
parameter real a0_a0_a1_p2_em2 = 0;
parameter real b0_b0_a2_p2_em2 = 0.123;
parameter real a0_b0_a2_p2_em2 = 0.00165;
parameter real b0_a0_a2_p2_em2 = 0;
parameter real a0_a0_a2_p2_em2 = 0;
parameter real b0_b0_a3_p2_em2 = -3.13;
parameter real a0_b0_a3_p2_em2 = 0.00506;
parameter real b0_a0_a3_p2_em2 = 0;
parameter real a0_a0_a3_p2_em2 = 0;
parameter real b0_b0_a4_p2_em2 = 0;
parameter real a0_b0_a4_p2_em2 = 0;
parameter real b0_a0_a4_p2_em2 = 0;
parameter real a0_a0_a4_p2_em2 = 0;
parameter real b0_b0_p1_p2_em2 = -1;
parameter real a0_b0_p1_p2_em2 = 0;
parameter real b0_a0_p1_p2_em2 = 0;
parameter real a0_a0_p1_p2_em2 = 0;
parameter real b0_b0_p2_p2_em2 = -2.26;
parameter real a0_b0_p2_p2_em2 = 0.00269;
parameter real b0_a0_p2_p2_em2 = 0;
parameter real a0_a0_p2_p2_em2 = 0;
parameter real b0_b0_p3_p2_em2 = 2.97;
parameter real a0_b0_p3_p2_em2 = -0.00342;
parameter real b0_a0_p3_p2_em2 = 0;
parameter real a0_a0_p3_p2_em2 = 0;
parameter real b0_b0_p4_p2_em2 = 3.32;
parameter real a0_b0_p4_p2_em2 = 0.00428;
parameter real b0_a0_p4_p2_em2 = 0;
parameter real a0_a0_p4_p2_em2 = 0;
parameter real b0_b0_b0_p3_em2 = 33.9;
parameter real a0_b0_b0_p3_em2 = 0.01;
parameter real b0_a0_b0_p3_em2 = 0.0328;
parameter real a0_a0_b0_p3_em2 = 0.0000813;
parameter real b0_b0_a0_p3_em2 = 0;
parameter real a0_b0_a0_p3_em2 = 0;
parameter real b0_a0_a0_p3_em2 = 0;
parameter real a0_a0_a0_p3_em2 = 0;
parameter real b0_b0_a1_p3_em2 = -25;
parameter real a0_b0_a1_p3_em2 = 0.0215;
parameter real b0_a0_a1_p3_em2 = -0.00738;
parameter real a0_a0_a1_p3_em2 = -0.000502;
parameter real b0_b0_a2_p3_em2 = -0.46;
parameter real a0_b0_a2_p3_em2 = 0.00244;
parameter real b0_a0_a2_p3_em2 = 0.0125;
parameter real a0_a0_a2_p3_em2 = -0.0000764;
parameter real b0_b0_a3_p3_em2 = 4.67;
parameter real a0_b0_a3_p3_em2 = 0.00495;
parameter real b0_a0_a3_p3_em2 = 0.192;
parameter real a0_a0_a3_p3_em2 = -0.000535;
parameter real b0_b0_a4_p3_em2 = 0;
parameter real a0_b0_a4_p3_em2 = 0;
parameter real b0_a0_a4_p3_em2 = 0;
parameter real a0_a0_a4_p3_em2 = 0;
parameter real b0_b0_p1_p3_em2 = -0.487;
parameter real a0_b0_p1_p3_em2 = -0.0178;
parameter real b0_a0_p1_p3_em2 = 0.00611;
parameter real a0_a0_p1_p3_em2 = -0.000196;
parameter real b0_b0_p2_p3_em2 = -0.521;
parameter real a0_b0_p2_p3_em2 = -0.017;
parameter real b0_a0_p2_p3_em2 = 0.0238;
parameter real a0_a0_p2_p3_em2 = -0.000258;
parameter real b0_b0_p3_p3_em2 = 2.77;
parameter real a0_b0_p3_p3_em2 = -0.00237;
parameter real b0_a0_p3_p3_em2 = -0.0168;
parameter real a0_a0_p3_p3_em2 = 0.0000351;
parameter real b0_b0_p4_p3_em2 = 2.17;
parameter real a0_b0_p4_p3_em2 = 0.00141;
parameter real b0_a0_p4_p3_em2 = -0.00412;
parameter real a0_a0_p4_p3_em2 = 0.0000129;
parameter real b0_b0_b0_p4_em2 = 65;
parameter real a0_b0_b0_p4_em2 = -0.0397;
parameter real b0_a0_b0_p4_em2 = -0.0786;
parameter real a0_a0_b0_p4_em2 = -0.00077;
parameter real b0_b0_a0_p4_em2 = 0;
parameter real a0_b0_a0_p4_em2 = 0;
parameter real b0_a0_a0_p4_em2 = 0;
parameter real a0_a0_a0_p4_em2 = 0;
parameter real b0_b0_a1_p4_em2 = 5.02;
parameter real a0_b0_a1_p4_em2 = 0.0115;
parameter real b0_a0_a1_p4_em2 = -0.169;
parameter real a0_a0_a1_p4_em2 = 0.000602;
parameter real b0_b0_a2_p4_em2 = 4.99;
parameter real a0_b0_a2_p4_em2 = 0.056;
parameter real b0_a0_a2_p4_em2 = 0.458;
parameter real a0_a0_a2_p4_em2 = -0.000233;
parameter real b0_b0_a3_p4_em2 = 4.98;
parameter real a0_b0_a3_p4_em2 = -0.028;
parameter real b0_a0_a3_p4_em2 = -0.0837;
parameter real a0_a0_a3_p4_em2 = 0.0000251;
parameter real b0_b0_a4_p4_em2 = 0;
parameter real a0_b0_a4_p4_em2 = 0;
parameter real b0_a0_a4_p4_em2 = 0;
parameter real a0_a0_a4_p4_em2 = 0;
parameter real b0_b0_p1_p4_em2 = 0.0848;
parameter real a0_b0_p1_p4_em2 = -0.000334;
parameter real b0_a0_p1_p4_em2 = -0.0295;
parameter real a0_a0_p1_p4_em2 = 0.0000458;
parameter real b0_b0_p2_p4_em2 = 2.47;
parameter real a0_b0_p2_p4_em2 = 0.000867;
parameter real b0_a0_p2_p4_em2 = -0.0184;
parameter real a0_a0_p2_p4_em2 = 0.0000544;
parameter real b0_b0_p3_p4_em2 = 3.4;
parameter real a0_b0_p3_p4_em2 = -0.000333;
parameter real b0_a0_p3_p4_em2 = -0.00504;
parameter real a0_a0_p3_p4_em2 = 0.00000277;
parameter real b0_b0_p4_p4_em2 = 4.56;
parameter real a0_b0_p4_p4_em2 = 0.0000987;
parameter real b0_a0_p4_p4_em2 = 0.0172;
parameter real a0_a0_p4_p4_em2 = -0.0000625;


					
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));
			
			//$display("Parameter %M in device %e, %e", id, vgs, vgs_cutoff_HCI, m_cutoff_HCI, delta_cutoff_HCI, (-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			
			delta_damage1_3_1 = 0;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
					//$display("Parameter %M in device %e, %e", delta_damage1_3_1, 1.0/delta_damage1_3_1);
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
					//$display("Parameter %M in device %e, %e", delta_damage1_3_2, 1.0/delta_damage1_3_2);
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			
			//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e",b0_a0_a3_a3_em, a0_a0_a3_a3_em, b0_a3_a3_em, vsub, vgs, vds, a3_a3_em, a3_em, em);
			
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			
			//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e",b0_a0_a3_a3_em2, a0_a0_a3_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2, vsub, vgs, vds, a3_a3_em2, a3_em2, em2);
			
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
					//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e", id, em, w, lamda_h,relimo_alpha1,relimo_m1, relimo_Feb_h/(em*lamda_h),exp(relimo_Feb_h/(em*lamda_h)), relimo_alpha1*pow(w*1e-6/id,relimo_m1), delta_damage2_3_1, 1.0/delta_damage2_3_1);	
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
					//$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e, %e", id, em2, w, lamda_el, relimo_alpha2, relimo_m2, relimo_Feb_el/(em2*lamda_el),relimo_alpha2*pow(w*1e-6/id,relimo_m2), exp(relimo_Feb_el/(em2*lamda_el)), delta_damage2_3_2, 1.0/delta_damage2_3_2);
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				        //$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e, %e",id, relimo_fstat3, relimo_alpha3, pow(w*1e-6/id,relimo_beta3), vgs, pow(abs(vgs),-1.0*relimo_gama3), pow(abs(vds),-1.0*relimo_eps3), exp(-1.0*relimo_eta3*abs(vsub)), exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))), delta_damage3, 1.0/delta_damage3);
				end
			end 
			
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a_off)+pow(delta_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b_off)+pow(delta_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2= 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-31;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", relimo_ratio_vth);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a_off)+pow(delta_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b_off)+pow(delta_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-31;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", relimo_ratio_vth);
		end	
	end
end
endmodule


module relimo_aging_hci_pmos90b(d,g,s,sub);
input d,g,s,sub;
electrical d,g,s,sub;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			
parameter real        delr_u0_relimo               = 0;			
parameter real        delr_rdsw_relimo             = 0;			
parameter real        delr_a0_relimo               = 0;			
parameter real        w               		   = 0;	
parameter real        l                            = 0;		

// User-defined Simulation relimo_control Inputs
parameter real        relimo_hci_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pmos90b";
parameter string      relimo_probe_name            = "mamost";
parameter real        relimo_kb                    = 8.62e-5;
parameter real        relimo_n                     = 1.0;
parameter real        relimo_a_idlin               = 0.0;
parameter real        relimo_a_gm                  = 0.0;
parameter real        relimo_a_vth                 = 0.0;
parameter integer     relimo_function              = 1;


parameter real        relimo_vth                   = -1;			

// parameter for HighVgs HCI
parameter real        relimo_a_hci3 = 1000;
parameter real        relimo_n_hci3 = 0.253;
parameter real        relimo_fstat3 = 0.0269;
parameter real        relimo_alpha3 = 2.69E+43;
parameter real        relimo_beta3 = 5.22;
parameter real        relimo_gama3 = 13.3;
parameter real        relimo_eps3 = 10.7;
parameter real        relimo_eta3 = 0;
parameter real        relimo_ea3 = 0.467;
parameter real        relimo_rth = 1.12E-11;

// parameter for off state
parameter real        relimo_a1_off = 48.3;
parameter real        relimo_a2_off = 3.18;
parameter real        relimo_n1_off = 0.22;
parameter real        relimo_n2_off = 0.586;
parameter real        relimo_alpha1_off = 4.83E6;
parameter real        relimo_beta1 = 0.05;
parameter real        relimo_ea1 = 0.548;
parameter real        relimo_alpha2_off = 0.0424;
parameter real        relimo_beta2 = 0.129;
parameter real        relimo_ea2 = 0.734;
parameter real        fstat_tau1_off = 0.0272;
parameter real        fstat_tau2_off = 0.0616;
parameter real        fstat_tau1tau2_off = 61.9;
parameter real        fstat_tau2tau1_off = 61.9;
parameter real        m_sigma_a_off = 1;
parameter real        delta_sigma_a_off = 0.5;
parameter real        m_sigma_b_off = 1;
parameter real        delta_sigma_b_off = 0.5;

// parameter for HCIHV
parameter real        relimo_Ep = 0.063;
parameter real        relimo_lamda_h0 = 1.34E-06;
parameter real        relimo_alpha1 = 0.00903;
parameter real        relimo_m1 = 0.99;
parameter real        relimo_Feb_h = 4.8;
parameter real        relimo_lamda_el0 = 4.81E-07;
parameter real        relimo_alpha2 = 8.67E-25;
parameter real        relimo_m2 = 1.07;
parameter real        relimo_Feb_el = 3.2;
parameter real        relimo_a1 = 0.78474;
parameter real        relimo_a2 = 5.2863;
parameter real        relimo_c1 = 86.407;
parameter real        relimo_b = 0.000253;
parameter real        relimo_n_hci = 3;
parameter real        m_sigma_b = 1;
parameter real        delta_sigma_b = 0.4;
parameter real        m_sigma_a = 1;
parameter real        delta_sigma_a = 6;
parameter real        fstat_tau1 = 0.0102;
parameter real        fstat_tau2 = 0.0038;
parameter real        fstat_tau1tau2 = 106;
parameter real        fstat_tau2tau1 = 106;
parameter real        vgs_cutoff_HCI = -0.4;
parameter real        m_cutoff_HCI = 1;
parameter real        delta_cutoff_HCI = 0.01;


// relimo_ratios
parameter real        relimo_ratio1_a                = 1;
parameter real        relimo_ratio2_a                = 1;
parameter real        relimo_ratio3_a                = 1;
parameter real        relimo_ratio4_a                = 1;
parameter real        relimo_ratio5_a                = 1;
parameter real        relimo_ratio6_a                = 1;
parameter real        relimo_ratio7_a                = 1;
parameter real        relimo_ratio8_a                = 1;
parameter real        relimo_ratio9_a                = 1;
parameter real        relimo_ratio10_a               = 1;
parameter real        relimo_ratio11_a               = 1;
parameter real        relimo_ratio12_a               = 1;
parameter real        relimo_ratio13_a               = 1;
parameter real        relimo_ratio14_a               = 1;
parameter real        relimo_ratio15_a               = 1;
parameter real        relimo_ratio16_a               = 1;

parameter real        relimo_ratio1_b                = 0;
parameter real        relimo_ratio2_b                = 0;
parameter real        relimo_ratio3_b                = 0;
parameter real        relimo_ratio4_b                = 0;
parameter real        relimo_ratio5_b                = 0;
parameter real        relimo_ratio6_b                = 0;
parameter real        relimo_ratio7_b                = 0;
parameter real        relimo_ratio8_b                = 0;
parameter real        relimo_ratio9_b                = 0;
parameter real        relimo_ratio10_b               = 0;
parameter real        relimo_ratio11_b               = 0;
parameter real        relimo_ratio12_b               = 0;
parameter real        relimo_ratio13_b               = 0;
parameter real        relimo_ratio14_b               = 0;
parameter real        relimo_ratio15_b               = 0;
parameter real        relimo_ratio16_b               = 0;

parameter real        relimo_ratio20_a               = 1;
parameter real        relimo_ratio20_b               = 0;
parameter real        relimo_ratio21_a               = 1/(0.1652*l+0.9967);

parameter real        relimo_ratio21_b               = 0;


parameter real        relimo_ratio_vth               = (-0.0091*pow(1/l,2)+0.0634*1/l+0.9953);


parameter real        relimo_ratio_vth2a0            = 16;

parameter  real  b0_b0_b0_b0_em  =  0;  
parameter  real  a0_b0_b0_b0_em  =  0;  
parameter  real  b0_a0_b0_b0_em  =  0;  
parameter  real  a0_a0_b0_b0_em  =  0;  
parameter  real  b0_b0_a0_b0_em  =  0;  
parameter  real  a0_b0_a0_b0_em  =  0;  
parameter  real  b0_a0_a0_b0_em  =  0;  
parameter  real  a0_a0_a0_b0_em  =  0;  
parameter  real  b0_b0_a1_b0_em  =  0;  
parameter  real  a0_b0_a1_b0_em  =  0;  
parameter  real  b0_a0_a1_b0_em  =  0;  
parameter  real  a0_a0_a1_b0_em  =  0;  
parameter  real  b0_b0_a2_b0_em  =  0;  
parameter  real  a0_b0_a2_b0_em  =  0;  
parameter  real  b0_a0_a2_b0_em  =  0;  
parameter  real  a0_a0_a2_b0_em  =  0;  
parameter  real  b0_b0_a3_b0_em  =  0;  
parameter  real  a0_b0_a3_b0_em  =  0;  
parameter  real  b0_a0_a3_b0_em  =  0;  
parameter  real  a0_a0_a3_b0_em  =  0;  
parameter  real  b0_b0_a4_b0_em  =  0;  
parameter  real  a0_b0_a4_b0_em  =  0;  
parameter  real  b0_a0_a4_b0_em  =  0;  
parameter  real  a0_a0_a4_b0_em  =  0;  
parameter  real  b0_b0_p1_b0_em  =  0;  
parameter  real  a0_b0_p1_b0_em  =  0;  
parameter  real  b0_a0_p1_b0_em  =  0;  
parameter  real  a0_a0_p1_b0_em  =  0;  
parameter  real  b0_b0_p2_b0_em  =  0;  
parameter  real  a0_b0_p2_b0_em  =  0;  
parameter  real  b0_a0_p2_b0_em  =  0;  
parameter  real  a0_a0_p2_b0_em  =  0;  
parameter  real  b0_b0_p3_b0_em  =  0;  
parameter  real  a0_b0_p3_b0_em  =  0;  
parameter  real  b0_a0_p3_b0_em  =  0;  
parameter  real  a0_a0_p3_b0_em  =  0;  
parameter  real  b0_b0_p4_b0_em  =  0;  
parameter  real  a0_b0_p4_b0_em  =  0;  
parameter  real  b0_a0_p4_b0_em  =  0;  
parameter  real  a0_a0_p4_b0_em  =  0;  
parameter  real  b0_b0_b0_a0_em  =  0;  
parameter  real  a0_b0_b0_a0_em  =  0;  
parameter  real  b0_a0_b0_a0_em  =  0;  
parameter  real  a0_a0_b0_a0_em  =  0;  
parameter  real  b0_b0_a0_a0_em  =  0;  
parameter  real  a0_b0_a0_a0_em  =  0;  
parameter  real  b0_a0_a0_a0_em  =  0;  
parameter  real  a0_a0_a0_a0_em  =  0;  
parameter  real  b0_b0_a1_a0_em  =  0;  
parameter  real  a0_b0_a1_a0_em  =  0;  
parameter  real  b0_a0_a1_a0_em  =  0;  
parameter  real  a0_a0_a1_a0_em  =  0;  
parameter  real  b0_b0_a2_a0_em  =  0;  
parameter  real  a0_b0_a2_a0_em  =  0;  
parameter  real  b0_a0_a2_a0_em  =  0;  
parameter  real  a0_a0_a2_a0_em  =  0;  
parameter  real  b0_b0_a3_a0_em  =  0;  
parameter  real  a0_b0_a3_a0_em  =  0;  
parameter  real  b0_a0_a3_a0_em  =  0;  
parameter  real  a0_a0_a3_a0_em  =  0;  
parameter  real  b0_b0_a4_a0_em  =  0;  
parameter  real  a0_b0_a4_a0_em  =  0;  
parameter  real  b0_a0_a4_a0_em  =  0;  
parameter  real  a0_a0_a4_a0_em  =  0;  
parameter  real  b0_b0_p1_a0_em  =  0;  
parameter  real  a0_b0_p1_a0_em  =  0;  
parameter  real  b0_a0_p1_a0_em  =  0;  
parameter  real  a0_a0_p1_a0_em  =  0;  
parameter  real  b0_b0_p2_a0_em  =  0;  
parameter  real  a0_b0_p2_a0_em  =  0;  
parameter  real  b0_a0_p2_a0_em  =  0;  
parameter  real  a0_a0_p2_a0_em  =  0;  
parameter  real  b0_b0_p3_a0_em  =  0;  
parameter  real  a0_b0_p3_a0_em  =  0;  
parameter  real  b0_a0_p3_a0_em  =  0;  
parameter  real  a0_a0_p3_a0_em  =  0;  
parameter  real  b0_b0_p4_a0_em  =  0;  
parameter  real  a0_b0_p4_a0_em  =  0;  
parameter  real  b0_a0_p4_a0_em  =  0;  
parameter  real  a0_a0_p4_a0_em  =  0;  
parameter  real  b0_b0_b0_a1_em  =  13400;  
parameter  real  a0_b0_b0_a1_em  =  -1.5;  
parameter  real  b0_a0_b0_a1_em  =  0;  
parameter  real  a0_a0_b0_a1_em  =  0;  
parameter  real  b0_b0_a0_a1_em  =  -400;  
parameter  real  a0_b0_a0_a1_em  =  0;  
parameter  real  b0_a0_a0_a1_em  =  0;  
parameter  real  a0_a0_a0_a1_em  =  0;  
parameter  real  b0_b0_a1_a1_em  =  -525;  
parameter  real  a0_b0_a1_a1_em  =  -0.534;  
parameter  real  b0_a0_a1_a1_em  =  0;  
parameter  real  a0_a0_a1_a1_em  =  0;  
parameter  real  b0_b0_a2_a1_em  =  -760;  
parameter  real  a0_b0_a2_a1_em  =  -1.96;  
parameter  real  b0_a0_a2_a1_em  =  0;  
parameter  real  a0_a0_a2_a1_em  =  0;  
parameter  real  b0_b0_a3_a1_em  =  -553;  
parameter  real  a0_b0_a3_a1_em  =  0.516;  
parameter  real  b0_a0_a3_a1_em  =  0;  
parameter  real  a0_a0_a3_a1_em  =  0;  
parameter  real  b0_b0_a4_a1_em  =  0;  
parameter  real  a0_b0_a4_a1_em  =  0;  
parameter  real  b0_a0_a4_a1_em  =  0;  
parameter  real  a0_a0_a4_a1_em  =  0;  
parameter  real  b0_b0_p1_a1_em  =  -1.04;  
parameter  real  a0_b0_p1_a1_em  =  0.00126;  
parameter  real  b0_a0_p1_a1_em  =  0;  
parameter  real  a0_a0_p1_a1_em  =  0;  
parameter  real  b0_b0_p2_a1_em  =  1.47;  
parameter  real  a0_b0_p2_a1_em  =  -0.00025;  
parameter  real  b0_a0_p2_a1_em  =  0;  
parameter  real  a0_a0_p2_a1_em  =  0;  
parameter  real  b0_b0_p3_a1_em  =  3.78;  
parameter  real  a0_b0_p3_a1_em  =  -0.00129;  
parameter  real  b0_a0_p3_a1_em  =  0;  
parameter  real  a0_a0_p3_a1_em  =  0;  
parameter  real  b0_b0_p4_a1_em  =  5;  
parameter  real  a0_b0_p4_a1_em  =  0;  
parameter  real  b0_a0_p4_a1_em  =  0;  
parameter  real  a0_a0_p4_a1_em  =  0;  
parameter  real  b0_b0_b0_a2_em  =  4150;  
parameter  real  a0_b0_b0_a2_em  =  -0.0609;  
parameter  real  b0_a0_b0_a2_em  =  0;  
parameter  real  a0_a0_b0_a2_em  =  0;  
parameter  real  b0_b0_a0_a2_em  =  1200;  
parameter  real  a0_b0_a0_a2_em  =  0;  
parameter  real  b0_a0_a0_a2_em  =  0;  
parameter  real  a0_a0_a0_a2_em  =  0;  
parameter  real  b0_b0_a1_a2_em  =  152;  
parameter  real  a0_b0_a1_a2_em  =  -1.72;  
parameter  real  b0_a0_a1_a2_em  =  0;  
parameter  real  a0_a0_a1_a2_em  =  0;  
parameter  real  b0_b0_a2_a2_em  =  -3390;  
parameter  real  a0_b0_a2_a2_em  =  6.27;  
parameter  real  b0_a0_a2_a2_em  =  0;  
parameter  real  a0_a0_a2_a2_em  =  0;  
parameter  real  b0_b0_a3_a2_em  =  142;  
parameter  real  a0_b0_a3_a2_em  =  -1.76;  
parameter  real  b0_a0_a3_a2_em  =  0;  
parameter  real  a0_a0_a3_a2_em  =  0;  
parameter  real  b0_b0_a4_a2_em  =  0;  
parameter  real  a0_b0_a4_a2_em  =  0;  
parameter  real  b0_a0_a4_a2_em  =  0;  
parameter  real  a0_a0_a4_a2_em  =  0;  
parameter  real  b0_b0_p1_a2_em  =  0.492;  
parameter  real  a0_b0_p1_a2_em  =  -0.000612;  
parameter  real  b0_a0_p1_a2_em  =  0;  
parameter  real  a0_a0_p1_a2_em  =  0;  
parameter  real  b0_b0_p2_a2_em  =  1.54;  
parameter  real  a0_b0_p2_a2_em  =  0.000457;  
parameter  real  b0_a0_p2_a2_em  =  0;  
parameter  real  a0_a0_p2_a2_em  =  0;  
parameter  real  b0_b0_p3_a2_em  =  2.76;  
parameter  real  a0_b0_p3_a2_em  =  0.000362;  
parameter  real  b0_a0_p3_a2_em  =  0;  
parameter  real  a0_a0_p3_a2_em  =  0;  
parameter  real  b0_b0_p4_a2_em  =  4.5;  
parameter  real  a0_b0_p4_a2_em  =  0;  
parameter  real  b0_a0_p4_a2_em  =  0;  
parameter  real  a0_a0_p4_a2_em  =  0;  
parameter  real  b0_b0_b0_a3_em  =  598;  
parameter  real  a0_b0_b0_a3_em  =  1.47;  
parameter  real  b0_a0_b0_a3_em  =  2.74;  
parameter  real  a0_a0_b0_a3_em  =  0.00976;  
parameter  real  b0_b0_a0_a3_em  =  0;  
parameter  real  a0_b0_a0_a3_em  =  0;  
parameter  real  b0_a0_a0_a3_em  =  0;  
parameter  real  a0_a0_a0_a3_em  =  0;  
parameter  real  b0_b0_a1_a3_em  =  0;  
parameter  real  a0_b0_a1_a3_em  =  0;  
parameter  real  b0_a0_a1_a3_em  =  0;  
parameter  real  a0_a0_a1_a3_em  =  0;  
parameter  real  b0_b0_a2_a3_em  =  0;  
parameter  real  a0_b0_a2_a3_em  =  0;  
parameter  real  b0_a0_a2_a3_em  =  0;  
parameter  real  a0_a0_a2_a3_em  =  0;  
parameter  real  b0_b0_a3_a3_em  =  0;  
parameter  real  a0_b0_a3_a3_em  =  0;  
parameter  real  b0_a0_a3_a3_em  =  0;  
parameter  real  a0_a0_a3_a3_em  =  0;  
parameter  real  b0_b0_a4_a3_em  =  0;  
parameter  real  a0_b0_a4_a3_em  =  0;  
parameter  real  b0_a0_a4_a3_em  =  0;  
parameter  real  a0_a0_a4_a3_em  =  0;  
parameter  real  b0_b0_p1_a3_em  =  0;  
parameter  real  a0_b0_p1_a3_em  =  0;  
parameter  real  b0_a0_p1_a3_em  =  0;  
parameter  real  a0_a0_p1_a3_em  =  0;  
parameter  real  b0_b0_p2_a3_em  =  0;  
parameter  real  a0_b0_p2_a3_em  =  0;  
parameter  real  b0_a0_p2_a3_em  =  0;  
parameter  real  a0_a0_p2_a3_em  =  0;  
parameter  real  b0_b0_p3_a3_em  =  0;  
parameter  real  a0_b0_p3_a3_em  =  0;  
parameter  real  b0_a0_p3_a3_em  =  0;  
parameter  real  a0_a0_p3_a3_em  =  0;  
parameter  real  b0_b0_p4_a3_em  =  0;  
parameter  real  a0_b0_p4_a3_em  =  0;  
parameter  real  b0_a0_p4_a3_em  =  0;  
parameter  real  a0_a0_p4_a3_em  =  0;  
parameter  real  b0_b0_b0_a4_em  =  1050;  
parameter  real  a0_b0_b0_a4_em  =  1.08;  
parameter  real  b0_a0_b0_a4_em  =  0.388;  
parameter  real  a0_a0_b0_a4_em  =  0.0699;  
parameter  real  b0_b0_a0_a4_em  =  0;  
parameter  real  a0_b0_a0_a4_em  =  0;  
parameter  real  b0_a0_a0_a4_em  =  0;  
parameter  real  a0_a0_a0_a4_em  =  0;  
parameter  real  b0_b0_a1_a4_em  =  291;  
parameter  real  a0_b0_a1_a4_em  =  -0.671;  
parameter  real  b0_a0_a1_a4_em  =  2.24;  
parameter  real  a0_a0_a1_a4_em  =  -0.00555;  
parameter  real  b0_b0_a2_a4_em  =  -269;  
parameter  real  a0_b0_a2_a4_em  =  0.597;  
parameter  real  b0_a0_a2_a4_em  =  0;  
parameter  real  a0_a0_a2_a4_em  =  0.00655;  
parameter  real  b0_b0_a3_a4_em  =  22.3;  
parameter  real  a0_b0_a3_a4_em  =  -0.135;  
parameter  real  b0_a0_a3_a4_em  =  -0.937;  
parameter  real  a0_a0_a3_a4_em  =  0.00231;  
parameter  real  b0_b0_a4_a4_em  =  0;  
parameter  real  a0_b0_a4_a4_em  =  0;  
parameter  real  b0_a0_a4_a4_em  =  0;  
parameter  real  a0_a0_a4_a4_em  =  0;  
parameter  real  b0_b0_p1_a4_em  =  1.28;  
parameter  real  a0_b0_p1_a4_em  =  0.066;  
parameter  real  b0_a0_p1_a4_em  =  -1.45;  
parameter  real  a0_a0_p1_a4_em  =  0.00866;  
parameter  real  b0_b0_p2_a4_em  =  0.676;  
parameter  real  a0_b0_p2_a4_em  =  0.00266;  
parameter  real  b0_a0_p2_a4_em  =  0.0129;  
parameter  real  a0_a0_p2_a4_em  =  -0.00002;  
parameter  real  b0_b0_p3_a4_em  =  3.54;  
parameter  real  a0_b0_p3_a4_em  =  0.00136;  
parameter  real  b0_a0_p3_a4_em  =  0.0000722;  
parameter  real  a0_a0_p3_a4_em  =  -0.00000493;  
parameter  real  b0_b0_p4_a4_em  =  11.3;  
parameter  real  a0_b0_p4_a4_em  =  -0.00422;  
parameter  real  b0_a0_p4_a4_em  =  0;  
parameter  real  a0_a0_p4_a4_em  =  0;  
parameter  real  b0_b0_b0_p1_em  =  -3.6;  
parameter  real  a0_b0_b0_p1_em  =  0;  
parameter  real  b0_a0_b0_p1_em  =  0;  
parameter  real  a0_a0_b0_p1_em  =  0;  
parameter  real  b0_b0_a0_p1_em  =  0;  
parameter  real  a0_b0_a0_p1_em  =  0;  
parameter  real  b0_a0_a0_p1_em  =  0;  
parameter  real  a0_a0_a0_p1_em  =  0;  
parameter  real  b0_b0_a1_p1_em  =  0.313;  
parameter  real  a0_b0_a1_p1_em  =  0;  
parameter  real  b0_a0_a1_p1_em  =  0;  
parameter  real  a0_a0_a1_p1_em  =  0;  
parameter  real  b0_b0_a2_p1_em  =  -0.971;  
parameter  real  a0_b0_a2_p1_em  =  0;  
parameter  real  b0_a0_a2_p1_em  =  0;  
parameter  real  a0_a0_a2_p1_em  =  0;  
parameter  real  b0_b0_a3_p1_em  =  -0.162;  
parameter  real  a0_b0_a3_p1_em  =  0;  
parameter  real  b0_a0_a3_p1_em  =  0;  
parameter  real  a0_a0_a3_p1_em  =  0;  
parameter  real  b0_b0_a4_p1_em  =  0;  
parameter  real  a0_b0_a4_p1_em  =  0;  
parameter  real  b0_a0_a4_p1_em  =  0;  
parameter  real  a0_a0_a4_p1_em  =  0;  
parameter  real  b0_b0_p1_p1_em  =  0.8;  
parameter  real  a0_b0_p1_p1_em  =  0;  
parameter  real  b0_a0_p1_p1_em  =  0;  
parameter  real  a0_a0_p1_p1_em  =  0;  
parameter  real  b0_b0_p2_p1_em  =  1.63;  
parameter  real  a0_b0_p2_p1_em  =  0;  
parameter  real  b0_a0_p2_p1_em  =  0;  
parameter  real  a0_a0_p2_p1_em  =  0;  
parameter  real  b0_b0_p3_p1_em  =  3.61;  
parameter  real  a0_b0_p3_p1_em  =  0;  
parameter  real  b0_a0_p3_p1_em  =  0;  
parameter  real  a0_a0_p3_p1_em  =  0;  
parameter  real  b0_b0_p4_p1_em  =  5.61;  
parameter  real  a0_b0_p4_p1_em  =  0;  
parameter  real  b0_a0_p4_p1_em  =  0;  
parameter  real  a0_a0_p4_p1_em  =  0;  
parameter  real  b0_b0_b0_p2_em  =  14.6;  
parameter  real  a0_b0_b0_p2_em  =  0.00383;  
parameter  real  b0_a0_b0_p2_em  =  0;  
parameter  real  a0_a0_b0_p2_em  =  0;  
parameter  real  b0_b0_a0_p2_em  =  0;  
parameter  real  a0_b0_a0_p2_em  =  0;  
parameter  real  b0_a0_a0_p2_em  =  0;  
parameter  real  a0_a0_a0_p2_em  =  0;  
parameter  real  b0_b0_a1_p2_em  =  0.189;  
parameter  real  a0_b0_a1_p2_em  =  0.00296;  
parameter  real  b0_a0_a1_p2_em  =  0;  
parameter  real  a0_a0_a1_p2_em  =  0;  
parameter  real  b0_b0_a2_p2_em  =  -3.4;  
parameter  real  a0_b0_a2_p2_em  =  0.015;  
parameter  real  b0_a0_a2_p2_em  =  0;  
parameter  real  a0_a0_a2_p2_em  =  0;  
parameter  real  b0_b0_a3_p2_em  =  1.24;  
parameter  real  a0_b0_a3_p2_em  =  -0.00228;  
parameter  real  b0_a0_a3_p2_em  =  0;  
parameter  real  a0_a0_a3_p2_em  =  0;  
parameter  real  b0_b0_a4_p2_em  =  0;  
parameter  real  a0_b0_a4_p2_em  =  0;  
parameter  real  b0_a0_a4_p2_em  =  0;  
parameter  real  a0_a0_a4_p2_em  =  0;  
parameter  real  b0_b0_p1_p2_em  =  0.2;  
parameter  real  a0_b0_p1_p2_em  =  0;  
parameter  real  b0_a0_p1_p2_em  =  0;  
parameter  real  a0_a0_p1_p2_em  =  0;  
parameter  real  b0_b0_p2_p2_em  =  3.62;  
parameter  real  a0_b0_p2_p2_em  =  -0.000606;  
parameter  real  b0_a0_p2_p2_em  =  0;  
parameter  real  a0_a0_p2_p2_em  =  0;  
parameter  real  b0_b0_p3_p2_em  =  3.86;  
parameter  real  a0_b0_p3_p2_em  =  -0.00116;  
parameter  real  b0_a0_p3_p2_em  =  0;  
parameter  real  a0_a0_p3_p2_em  =  0;  
parameter  real  b0_b0_p4_p2_em  =  5.51;  
parameter  real  a0_b0_p4_p2_em  =  -0.00235;  
parameter  real  b0_a0_p4_p2_em  =  0;  
parameter  real  a0_a0_p4_p2_em  =  0;  
parameter  real  b0_b0_b0_p3_em  =  26.5;  
parameter  real  a0_b0_b0_p3_em  =  -0.00874;  
parameter  real  b0_a0_b0_p3_em  =  -0.0217;  
parameter  real  a0_a0_b0_p3_em  =  -0.00004;  
parameter  real  b0_b0_a0_p3_em  =  -2;  
parameter  real  a0_b0_a0_p3_em  =  0;  
parameter  real  b0_a0_a0_p3_em  =  0;  
parameter  real  a0_a0_a0_p3_em  =  0;  
parameter  real  b0_b0_a1_p3_em  =  2.49;  
parameter  real  a0_b0_a1_p3_em  =  -0.000866;  
parameter  real  b0_a0_a1_p3_em  =  -0.0119;  
parameter  real  a0_a0_a1_p3_em  =  0.0000336;  
parameter  real  b0_b0_a2_p3_em  =  -3.69;  
parameter  real  a0_b0_a2_p3_em  =  -0.00232;  
parameter  real  b0_a0_a2_p3_em  =  -0.0222;  
parameter  real  a0_a0_a2_p3_em  =  0.0000265;  
parameter  real  b0_b0_a3_p3_em  =  -2.14;  
parameter  real  a0_b0_a3_p3_em  =  0.00168;  
parameter  real  b0_a0_a3_p3_em  =  0;  
parameter  real  a0_a0_a3_p3_em  =  0;  
parameter  real  b0_b0_a4_p3_em  =  0;  
parameter  real  a0_b0_a4_p3_em  =  0;  
parameter  real  b0_a0_a4_p3_em  =  0;  
parameter  real  a0_a0_a4_p3_em  =  0;  
parameter  real  b0_b0_p1_p3_em  =  0.896;  
parameter  real  a0_b0_p1_p3_em  =  -0.0028;  
parameter  real  b0_a0_p1_p3_em  =  0.00212;  
parameter  real  a0_a0_p1_p3_em  =  -0.00000896;  
parameter  real  b0_b0_p2_p3_em  =  1.05;  
parameter  real  a0_b0_p2_p3_em  =  0.00998;  
parameter  real  b0_a0_p2_p3_em  =  0.00225;  
parameter  real  a0_a0_p2_p3_em  =  0.00000246;  
parameter  real  b0_b0_p3_p3_em  =  1.43;  
parameter  real  a0_b0_p3_p3_em  =  0.0219;  
parameter  real  b0_a0_p3_p3_em  =  0;  
parameter  real  a0_a0_p3_p3_em  =  0;  
parameter  real  b0_b0_p4_p3_em  =  7.75;  
parameter  real  a0_b0_p4_p3_em  =  -0.00726;  
parameter  real  b0_a0_p4_p3_em  =  0;  
parameter  real  a0_a0_p4_p3_em  =  0;  
parameter  real  b0_b0_b0_p4_em  =  51.9;  
parameter  real  a0_b0_b0_p4_em  =  -0.0622;  
parameter  real  b0_a0_b0_p4_em  =  -0.158;  
parameter  real  a0_a0_b0_p4_em  =  -0.000773;  
parameter  real  b0_b0_a0_p4_em  =  0;  
parameter  real  a0_b0_a0_p4_em  =  0;  
parameter  real  b0_a0_a0_p4_em  =  0;  
parameter  real  a0_a0_a0_p4_em  =  0;  
parameter  real  b0_b0_a1_p4_em  =  0;  
parameter  real  a0_b0_a1_p4_em  =  0;  
parameter  real  b0_a0_a1_p4_em  =  0;  
parameter  real  a0_a0_a1_p4_em  =  0;  
parameter  real  b0_b0_a2_p4_em  =  0;  
parameter  real  a0_b0_a2_p4_em  =  0;  
parameter  real  b0_a0_a2_p4_em  =  0;  
parameter  real  a0_a0_a2_p4_em  =  0;  
parameter  real  b0_b0_a3_p4_em  =  0;  
parameter  real  a0_b0_a3_p4_em  =  0;  
parameter  real  b0_a0_a3_p4_em  =  0;  
parameter  real  a0_a0_a3_p4_em  =  0;  
parameter  real  b0_b0_a4_p4_em  =  0;  
parameter  real  a0_b0_a4_p4_em  =  0;  
parameter  real  b0_a0_a4_p4_em  =  0;  
parameter  real  a0_a0_a4_p4_em  =  0;  
parameter  real  b0_b0_p1_p4_em  =  0;  
parameter  real  a0_b0_p1_p4_em  =  0;  
parameter  real  b0_a0_p1_p4_em  =  0;  
parameter  real  a0_a0_p1_p4_em  =  0;  
parameter  real  b0_b0_p2_p4_em  =  0;  
parameter  real  a0_b0_p2_p4_em  =  0;  
parameter  real  b0_a0_p2_p4_em  =  0;  
parameter  real  a0_a0_p2_p4_em  =  0;  
parameter  real  b0_b0_p3_p4_em  =  0;  
parameter  real  a0_b0_p3_p4_em  =  0;  
parameter  real  b0_a0_p3_p4_em  =  0;  
parameter  real  a0_a0_p3_p4_em  =  0;  
parameter  real  b0_b0_p4_p4_em  =  0;  
parameter  real  a0_b0_p4_p4_em  =  0;  
parameter  real  b0_a0_p4_p4_em  =  0;  
parameter  real  a0_a0_p4_p4_em  =  0;  

parameter  real  b0_b0_b0_b0_em2  =  0;  
parameter  real  a0_b0_b0_b0_em2  =  0;  
parameter  real  b0_a0_b0_b0_em2  =  0;  
parameter  real  a0_a0_b0_b0_em2  =  0;  
parameter  real  b0_b0_a0_b0_em2  =  0;  
parameter  real  a0_b0_a0_b0_em2  =  0;  
parameter  real  b0_a0_a0_b0_em2  =  0;  
parameter  real  a0_a0_a0_b0_em2  =  0;  
parameter  real  b0_b0_a1_b0_em2  =  0;  
parameter  real  a0_b0_a1_b0_em2  =  0;  
parameter  real  b0_a0_a1_b0_em2  =  0;  
parameter  real  a0_a0_a1_b0_em2  =  0;  
parameter  real  b0_b0_a2_b0_em2  =  0;  
parameter  real  a0_b0_a2_b0_em2  =  0;  
parameter  real  b0_a0_a2_b0_em2  =  0;  
parameter  real  a0_a0_a2_b0_em2  =  0;  
parameter  real  b0_b0_a3_b0_em2  =  0;  
parameter  real  a0_b0_a3_b0_em2  =  0;  
parameter  real  b0_a0_a3_b0_em2  =  0;  
parameter  real  a0_a0_a3_b0_em2  =  0;  
parameter  real  b0_b0_a4_b0_em2  =  0;  
parameter  real  a0_b0_a4_b0_em2  =  0;  
parameter  real  b0_a0_a4_b0_em2  =  0;  
parameter  real  a0_a0_a4_b0_em2  =  0;  
parameter  real  b0_b0_p1_b0_em2  =  0;  
parameter  real  a0_b0_p1_b0_em2  =  0;  
parameter  real  b0_a0_p1_b0_em2  =  0;  
parameter  real  a0_a0_p1_b0_em2  =  0;  
parameter  real  b0_b0_p2_b0_em2  =  0;  
parameter  real  a0_b0_p2_b0_em2  =  0;  
parameter  real  b0_a0_p2_b0_em2  =  0;  
parameter  real  a0_a0_p2_b0_em2  =  0;  
parameter  real  b0_b0_p3_b0_em2  =  0;  
parameter  real  a0_b0_p3_b0_em2  =  0;  
parameter  real  b0_a0_p3_b0_em2  =  0;  
parameter  real  a0_a0_p3_b0_em2  =  0;  
parameter  real  b0_b0_p4_b0_em2  =  0;  
parameter  real  a0_b0_p4_b0_em2  =  0;  
parameter  real  b0_a0_p4_b0_em2  =  0;  
parameter  real  a0_a0_p4_b0_em2  =  0;  
parameter  real  b0_b0_b0_a0_em2  =  0;  
parameter  real  a0_b0_b0_a0_em2  =  0;  
parameter  real  b0_a0_b0_a0_em2  =  0;  
parameter  real  a0_a0_b0_a0_em2  =  0;  
parameter  real  b0_b0_a0_a0_em2  =  0;  
parameter  real  a0_b0_a0_a0_em2  =  0;  
parameter  real  b0_a0_a0_a0_em2  =  0;  
parameter  real  a0_a0_a0_a0_em2  =  0;  
parameter  real  b0_b0_a1_a0_em2  =  0;  
parameter  real  a0_b0_a1_a0_em2  =  0;  
parameter  real  b0_a0_a1_a0_em2  =  0;  
parameter  real  a0_a0_a1_a0_em2  =  0;  
parameter  real  b0_b0_a2_a0_em2  =  0;  
parameter  real  a0_b0_a2_a0_em2  =  0;  
parameter  real  b0_a0_a2_a0_em2  =  0;  
parameter  real  a0_a0_a2_a0_em2  =  0;  
parameter  real  b0_b0_a3_a0_em2  =  0;  
parameter  real  a0_b0_a3_a0_em2  =  0;  
parameter  real  b0_a0_a3_a0_em2  =  0;  
parameter  real  a0_a0_a3_a0_em2  =  0;  
parameter  real  b0_b0_a4_a0_em2  =  0;  
parameter  real  a0_b0_a4_a0_em2  =  0;  
parameter  real  b0_a0_a4_a0_em2  =  0;  
parameter  real  a0_a0_a4_a0_em2  =  0;  
parameter  real  b0_b0_p1_a0_em2  =  0;  
parameter  real  a0_b0_p1_a0_em2  =  0;  
parameter  real  b0_a0_p1_a0_em2  =  0;  
parameter  real  a0_a0_p1_a0_em2  =  0;  
parameter  real  b0_b0_p2_a0_em2  =  0;  
parameter  real  a0_b0_p2_a0_em2  =  0;  
parameter  real  b0_a0_p2_a0_em2  =  0;  
parameter  real  a0_a0_p2_a0_em2  =  0;  
parameter  real  b0_b0_p3_a0_em2  =  0;  
parameter  real  a0_b0_p3_a0_em2  =  0;  
parameter  real  b0_a0_p3_a0_em2  =  0;  
parameter  real  a0_a0_p3_a0_em2  =  0;  
parameter  real  b0_b0_p4_a0_em2  =  0;  
parameter  real  a0_b0_p4_a0_em2  =  0;  
parameter  real  b0_a0_p4_a0_em2  =  0;  
parameter  real  a0_a0_p4_a0_em2  =  0;  
parameter  real  b0_b0_b0_a1_em2  =  23700;  
parameter  real  a0_b0_b0_a1_em2  =  -10.4;  
parameter  real  b0_a0_b0_a1_em2  =  0;  
parameter  real  a0_a0_b0_a1_em2  =  0;  
parameter  real  b0_b0_a0_a1_em2  =  200;  
parameter  real  a0_b0_a0_a1_em2  =  0;  
parameter  real  b0_a0_a0_a1_em2  =  0;  
parameter  real  a0_a0_a0_a1_em2  =  0;  
parameter  real  b0_b0_a1_a1_em2  =  -3860;  
parameter  real  a0_b0_a1_a1_em2  =  -1.64;  
parameter  real  b0_a0_a1_a1_em2  =  0;  
parameter  real  a0_a0_a1_a1_em2  =  0;  
parameter  real  b0_b0_a2_a1_em2  =  998;  
parameter  real  a0_b0_a2_a1_em2  =  -5.27;  
parameter  real  b0_a0_a2_a1_em2  =  0;  
parameter  real  a0_a0_a2_a1_em2  =  0;  
parameter  real  b0_b0_a3_a1_em2  =  -657;  
parameter  real  a0_b0_a3_a1_em2  =  0.141;  
parameter  real  b0_a0_a3_a1_em2  =  0;  
parameter  real  a0_a0_a3_a1_em2  =  0;  
parameter  real  b0_b0_a4_a1_em2  =  0;  
parameter  real  a0_b0_a4_a1_em2  =  0;  
parameter  real  b0_a0_a4_a1_em2  =  0;  
parameter  real  a0_a0_a4_a1_em2  =  0;  
parameter  real  b0_b0_p1_a1_em2  =  0.631;  
parameter  real  a0_b0_p1_a1_em2  =  0.000618;  
parameter  real  b0_a0_p1_a1_em2  =  0;  
parameter  real  a0_a0_p1_a1_em2  =  0;  
parameter  real  b0_b0_p2_a1_em2  =  2.37;  
parameter  real  a0_b0_p2_a1_em2  =  -0.000604;  
parameter  real  b0_a0_p2_a1_em2  =  0;  
parameter  real  a0_a0_p2_a1_em2  =  0;  
parameter  real  b0_b0_p3_a1_em2  =  3.58;  
parameter  real  a0_b0_p3_a1_em2  =  -0.00168;  
parameter  real  b0_a0_p3_a1_em2  =  0;  
parameter  real  a0_a0_p3_a1_em2  =  0;  
parameter  real  b0_b0_p4_a1_em2  =  5.2;  
parameter  real  a0_b0_p4_a1_em2  =  0;  
parameter  real  b0_a0_p4_a1_em2  =  0;  
parameter  real  a0_a0_p4_a1_em2  =  0;  
parameter  real  b0_b0_b0_a2_em2  =  7430;  
parameter  real  a0_b0_b0_a2_em2  =  -1.43;  
parameter  real  b0_a0_b0_a2_em2  =  0;  
parameter  real  a0_a0_b0_a2_em2  =  0;  
parameter  real  b0_b0_a0_a2_em2  =  0;  
parameter  real  a0_b0_a0_a2_em2  =  0;  
parameter  real  b0_a0_a0_a2_em2  =  0;  
parameter  real  a0_a0_a0_a2_em2  =  0;  
parameter  real  b0_b0_a1_a2_em2  =  -602;  
parameter  real  a0_b0_a1_a2_em2  =  -0.872;  
parameter  real  b0_a0_a1_a2_em2  =  0;  
parameter  real  a0_a0_a1_a2_em2  =  0;  
parameter  real  b0_b0_a2_a2_em2  =  -112;  
parameter  real  a0_b0_a2_a2_em2  =  -0.0495;  
parameter  real  b0_a0_a2_a2_em2  =  0;  
parameter  real  a0_a0_a2_a2_em2  =  0;  
parameter  real  b0_b0_a3_a2_em2  =  -38.9;  
parameter  real  a0_b0_a3_a2_em2  =  0.0361;  
parameter  real  b0_a0_a3_a2_em2  =  0;  
parameter  real  a0_a0_a3_a2_em2  =  0;  
parameter  real  b0_b0_a4_a2_em2  =  0;  
parameter  real  a0_b0_a4_a2_em2  =  0;  
parameter  real  b0_a0_a4_a2_em2  =  0;  
parameter  real  a0_a0_a4_a2_em2  =  0;  
parameter  real  b0_b0_p1_a2_em2  =  0.911;  
parameter  real  a0_b0_p1_a2_em2  =  0.00201;  
parameter  real  b0_a0_p1_a2_em2  =  0;  
parameter  real  a0_a0_p1_a2_em2  =  0;  
parameter  real  b0_b0_p2_a2_em2  =  4.52;  
parameter  real  a0_b0_p2_a2_em2  =  -0.00107;  
parameter  real  b0_a0_p2_a2_em2  =  0;  
parameter  real  a0_a0_p2_a2_em2  =  0;  
parameter  real  b0_b0_p3_a2_em2  =  18.2;  
parameter  real  a0_b0_p3_a2_em2  =  -0.00874;  
parameter  real  b0_a0_p3_a2_em2  =  0;  
parameter  real  a0_a0_p3_a2_em2  =  0;  
parameter  real  b0_b0_p4_a2_em2  =  5.5;  
parameter  real  a0_b0_p4_a2_em2  =  0;  
parameter  real  b0_a0_p4_a2_em2  =  0;  
parameter  real  a0_a0_p4_a2_em2  =  0;  
parameter  real  b0_b0_b0_a3_em2  =  799;  
parameter  real  a0_b0_b0_a3_em2  =  6.91;  
parameter  real  b0_a0_b0_a3_em2  =  13.4;  
parameter  real  a0_a0_b0_a3_em2  =  -0.0439;  
parameter  real  b0_b0_a0_a3_em2  =  0;  
parameter  real  a0_b0_a0_a3_em2  =  0;  
parameter  real  b0_a0_a0_a3_em2  =  0;  
parameter  real  a0_a0_a0_a3_em2  =  0;  
parameter  real  b0_b0_a1_a3_em2  =  0;  
parameter  real  a0_b0_a1_a3_em2  =  0;  
parameter  real  b0_a0_a1_a3_em2  =  0;  
parameter  real  a0_a0_a1_a3_em2  =  0;  
parameter  real  b0_b0_a2_a3_em2  =  0;  
parameter  real  a0_b0_a2_a3_em2  =  0;  
parameter  real  b0_a0_a2_a3_em2  =  0;  
parameter  real  a0_a0_a2_a3_em2  =  0;  
parameter  real  b0_b0_a3_a3_em2  =  0;  
parameter  real  a0_b0_a3_a3_em2  =  0;  
parameter  real  b0_a0_a3_a3_em2  =  0;  
parameter  real  a0_a0_a3_a3_em2  =  0;  
parameter  real  b0_b0_a4_a3_em2  =  0;  
parameter  real  a0_b0_a4_a3_em2  =  0;  
parameter  real  b0_a0_a4_a3_em2  =  0;  
parameter  real  a0_a0_a4_a3_em2  =  0;  
parameter  real  b0_b0_p1_a3_em2  =  0;  
parameter  real  a0_b0_p1_a3_em2  =  0;  
parameter  real  b0_a0_p1_a3_em2  =  0;  
parameter  real  a0_a0_p1_a3_em2  =  0;  
parameter  real  b0_b0_p2_a3_em2  =  0;  
parameter  real  a0_b0_p2_a3_em2  =  0;  
parameter  real  b0_a0_p2_a3_em2  =  0;  
parameter  real  a0_a0_p2_a3_em2  =  0;  
parameter  real  b0_b0_p3_a3_em2  =  0;  
parameter  real  a0_b0_p3_a3_em2  =  0;  
parameter  real  b0_a0_p3_a3_em2  =  0;  
parameter  real  a0_a0_p3_a3_em2  =  0;  
parameter  real  b0_b0_p4_a3_em2  =  0;  
parameter  real  a0_b0_p4_a3_em2  =  0;  
parameter  real  b0_a0_p4_a3_em2  =  0;  
parameter  real  a0_a0_p4_a3_em2  =  0;  
parameter  real  b0_b0_b0_a4_em2  =  554;  
parameter  real  a0_b0_b0_a4_em2  =  -0.503;  
parameter  real  b0_a0_b0_a4_em2  =  -0.985;  
parameter  real  a0_a0_b0_a4_em2  =  -0.0173;  
parameter  real  b0_b0_a0_a4_em2  =  100;  
parameter  real  a0_b0_a0_a4_em2  =  0;  
parameter  real  b0_a0_a0_a4_em2  =  0;  
parameter  real  a0_a0_a0_a4_em2  =  0;  
parameter  real  b0_b0_a1_a4_em2  =  502;  
parameter  real  a0_b0_a1_a4_em2  =  -1.66;  
parameter  real  b0_a0_a1_a4_em2  =  0.061;  
parameter  real  a0_a0_a1_a4_em2  =  -0.0078;  
parameter  real  b0_b0_a2_a4_em2  =  -606;  
parameter  real  a0_b0_a2_a4_em2  =  2.1;  
parameter  real  b0_a0_a2_a4_em2  =  0;  
parameter  real  a0_a0_a2_a4_em2  =  0.00263;  
parameter  real  b0_b0_a3_a4_em2  =  -323;  
parameter  real  a0_b0_a3_a4_em2  =  0.511;  
parameter  real  b0_a0_a3_a4_em2  =  -5.73;  
parameter  real  a0_a0_a3_a4_em2  =  0.0143;  
parameter  real  b0_b0_a4_a4_em2  =  0;  
parameter  real  a0_b0_a4_a4_em2  =  0;  
parameter  real  b0_a0_a4_a4_em2  =  0;  
parameter  real  a0_a0_a4_a4_em2  =  0;  
parameter  real  b0_b0_p1_a4_em2  =  -12.1;  
parameter  real  a0_b0_p1_a4_em2  =  0.0359;  
parameter  real  b0_a0_p1_a4_em2  =  -0.239;  
parameter  real  a0_a0_p1_a4_em2  =  0.000769;  
parameter  real  b0_b0_p2_a4_em2  =  -0.756;  
parameter  real  a0_b0_p2_a4_em2  =  0.00761;  
parameter  real  b0_a0_p2_a4_em2  =  -0.0632;  
parameter  real  a0_a0_p2_a4_em2  =  0.000261;  
parameter  real  b0_b0_p3_a4_em2  =  5.78;  
parameter  real  a0_b0_p3_a4_em2  =  -0.00883;  
parameter  real  b0_a0_p3_a4_em2  =  0.0211;  
parameter  real  a0_a0_p3_a4_em2  =  -0.0000494;  
parameter  real  b0_b0_p4_a4_em2  =  2.41;  
parameter  real  a0_b0_p4_a4_em2  =  0.00486;  
parameter  real  b0_a0_p4_a4_em2  =  -0.0315;  
parameter  real  a0_a0_p4_a4_em2  =  0.0000687;  
parameter  real  b0_b0_b0_p1_em2  =  0.0893;  
parameter  real  a0_b0_b0_p1_em2  =  0;  
parameter  real  b0_a0_b0_p1_em2  =  0;  
parameter  real  a0_a0_b0_p1_em2  =  0;  
parameter  real  b0_b0_a0_p1_em2  =  0;  
parameter  real  a0_b0_a0_p1_em2  =  0;  
parameter  real  b0_a0_a0_p1_em2  =  0;  
parameter  real  a0_a0_a0_p1_em2  =  0;  
parameter  real  b0_b0_a1_p1_em2  =  0.613;  
parameter  real  a0_b0_a1_p1_em2  =  0;  
parameter  real  b0_a0_a1_p1_em2  =  0;  
parameter  real  a0_a0_a1_p1_em2  =  0;  
parameter  real  b0_b0_a2_p1_em2  =  -0.623;  
parameter  real  a0_b0_a2_p1_em2  =  0;  
parameter  real  b0_a0_a2_p1_em2  =  0;  
parameter  real  a0_a0_a2_p1_em2  =  0;  
parameter  real  b0_b0_a3_p1_em2  =  -0.0919;  
parameter  real  a0_b0_a3_p1_em2  =  0;  
parameter  real  b0_a0_a3_p1_em2  =  0;  
parameter  real  a0_a0_a3_p1_em2  =  0;  
parameter  real  b0_b0_a4_p1_em2  =  0;  
parameter  real  a0_b0_a4_p1_em2  =  0;  
parameter  real  b0_a0_a4_p1_em2  =  0;  
parameter  real  a0_a0_a4_p1_em2  =  0;  
parameter  real  b0_b0_p1_p1_em2  =  -0.96;  
parameter  real  a0_b0_p1_p1_em2  =  0;  
parameter  real  b0_a0_p1_p1_em2  =  0;  
parameter  real  a0_a0_p1_p1_em2  =  0;  
parameter  real  b0_b0_p2_p1_em2  =  1.03;  
parameter  real  a0_b0_p2_p1_em2  =  0;  
parameter  real  b0_a0_p2_p1_em2  =  0;  
parameter  real  a0_a0_p2_p1_em2  =  0;  
parameter  real  b0_b0_p3_p1_em2  =  2.32;  
parameter  real  a0_b0_p3_p1_em2  =  0;  
parameter  real  b0_a0_p3_p1_em2  =  0;  
parameter  real  a0_a0_p3_p1_em2  =  0;  
parameter  real  b0_b0_p4_p1_em2  =  5.5;  
parameter  real  a0_b0_p4_p1_em2  =  0;  
parameter  real  b0_a0_p4_p1_em2  =  0;  
parameter  real  a0_a0_p4_p1_em2  =  0;  
parameter  real  b0_b0_b0_p2_em2  =  6.48;  
parameter  real  a0_b0_b0_p2_em2  =  0.00828;  
parameter  real  b0_a0_b0_p2_em2  =  0;  
parameter  real  a0_a0_b0_p2_em2  =  0;  
parameter  real  b0_b0_a0_p2_em2  =  0.3;  
parameter  real  a0_b0_a0_p2_em2  =  0;  
parameter  real  b0_a0_a0_p2_em2  =  0;  
parameter  real  a0_a0_a0_p2_em2  =  0;  
parameter  real  b0_b0_a1_p2_em2  =  2;  
parameter  real  a0_b0_a1_p2_em2  =  0.000539;  
parameter  real  b0_a0_a1_p2_em2  =  0;  
parameter  real  a0_a0_a1_p2_em2  =  0;  
parameter  real  b0_b0_a2_p2_em2  =  0.153;  
parameter  real  a0_b0_a2_p2_em2  =  -0.00243;  
parameter  real  b0_a0_a2_p2_em2  =  0;  
parameter  real  a0_a0_a2_p2_em2  =  0;  
parameter  real  b0_b0_a3_p2_em2  =  2.38;  
parameter  real  a0_b0_a3_p2_em2  =  -0.00359;  
parameter  real  b0_a0_a3_p2_em2  =  0;  
parameter  real  a0_a0_a3_p2_em2  =  0;  
parameter  real  b0_b0_a4_p2_em2  =  0;  
parameter  real  a0_b0_a4_p2_em2  =  0;  
parameter  real  b0_a0_a4_p2_em2  =  0;  
parameter  real  a0_a0_a4_p2_em2  =  0;  
parameter  real  b0_b0_p1_p2_em2  =  0.7;  
parameter  real  a0_b0_p1_p2_em2  =  0.0005;  
parameter  real  b0_a0_p1_p2_em2  =  0;  
parameter  real  a0_a0_p1_p2_em2  =  0;  
parameter  real  b0_b0_p2_p2_em2  =  2.04;  
parameter  real  a0_b0_p2_p2_em2  =  0.000444;  
parameter  real  b0_a0_p2_p2_em2  =  0;  
parameter  real  a0_a0_p2_p2_em2  =  0;  
parameter  real  b0_b0_p3_p2_em2  =  4.7;  
parameter  real  a0_b0_p3_p2_em2  =  -0.00315;  
parameter  real  b0_a0_p3_p2_em2  =  0;  
parameter  real  a0_a0_p3_p2_em2  =  0;  
parameter  real  b0_b0_p4_p2_em2  =  3.9;  
parameter  real  a0_b0_p4_p2_em2  =  0.00151;  
parameter  real  b0_a0_p4_p2_em2  =  0;  
parameter  real  a0_a0_p4_p2_em2  =  0;  
parameter  real  b0_b0_b0_p3_em2  =  23.9;  
parameter  real  a0_b0_b0_p3_em2  =  -0.00894;  
parameter  real  b0_a0_b0_p3_em2  =  -0.0159;  
parameter  real  a0_a0_b0_p3_em2  =  0.0000784;  
parameter  real  b0_b0_a0_p3_em2  =  0;  
parameter  real  a0_b0_a0_p3_em2  =  0;  
parameter  real  b0_a0_a0_p3_em2  =  0;  
parameter  real  a0_a0_a0_p3_em2  =  0;  
parameter  real  b0_b0_a1_p3_em2  =  0;  
parameter  real  a0_b0_a1_p3_em2  =  0;  
parameter  real  b0_a0_a1_p3_em2  =  0;  
parameter  real  a0_a0_a1_p3_em2  =  0;  
parameter  real  b0_b0_a2_p3_em2  =  0;  
parameter  real  a0_b0_a2_p3_em2  =  0;  
parameter  real  b0_a0_a2_p3_em2  =  0;  
parameter  real  a0_a0_a2_p3_em2  =  0;  
parameter  real  b0_b0_a3_p3_em2  =  0;  
parameter  real  a0_b0_a3_p3_em2  =  0;  
parameter  real  b0_a0_a3_p3_em2  =  0;  
parameter  real  a0_a0_a3_p3_em2  =  0;  
parameter  real  b0_b0_a4_p3_em2  =  0;  
parameter  real  a0_b0_a4_p3_em2  =  0;  
parameter  real  b0_a0_a4_p3_em2  =  0;  
parameter  real  a0_a0_a4_p3_em2  =  0;  
parameter  real  b0_b0_p1_p3_em2  =  0;  
parameter  real  a0_b0_p1_p3_em2  =  0;  
parameter  real  b0_a0_p1_p3_em2  =  0;  
parameter  real  a0_a0_p1_p3_em2  =  0;  
parameter  real  b0_b0_p2_p3_em2  =  0;  
parameter  real  a0_b0_p2_p3_em2  =  0;  
parameter  real  b0_a0_p2_p3_em2  =  0;  
parameter  real  a0_a0_p2_p3_em2  =  0;  
parameter  real  b0_b0_p3_p3_em2  =  0;  
parameter  real  a0_b0_p3_p3_em2  =  0;  
parameter  real  b0_a0_p3_p3_em2  =  0;  
parameter  real  a0_a0_p3_p3_em2  =  0;  
parameter  real  b0_b0_p4_p3_em2  =  0;  
parameter  real  a0_b0_p4_p3_em2  =  0;  
parameter  real  b0_a0_p4_p3_em2  =  0;  
parameter  real  a0_a0_p4_p3_em2  =  0;  
parameter  real  b0_b0_b0_p4_em2  =  31.8;  
parameter  real  a0_b0_b0_p4_em2  =  -0.00268;  
parameter  real  b0_a0_b0_p4_em2  =  -0.0274;  
parameter  real  a0_a0_b0_p4_em2  =  0.000119;  
parameter  real  b0_b0_a0_p4_em2  =  0;  
parameter  real  a0_b0_a0_p4_em2  =  0;  
parameter  real  b0_a0_a0_p4_em2  =  0;  
parameter  real  a0_a0_a0_p4_em2  =  0;  
parameter  real  b0_b0_a1_p4_em2  =  0;  
parameter  real  a0_b0_a1_p4_em2  =  0;  
parameter  real  b0_a0_a1_p4_em2  =  0;  
parameter  real  a0_a0_a1_p4_em2  =  0;  
parameter  real  b0_b0_a2_p4_em2  =  0;  
parameter  real  a0_b0_a2_p4_em2  =  0;  
parameter  real  b0_a0_a2_p4_em2  =  0;  
parameter  real  a0_a0_a2_p4_em2  =  0;  
parameter  real  b0_b0_a3_p4_em2  =  0;  
parameter  real  a0_b0_a3_p4_em2  =  0;  
parameter  real  b0_a0_a3_p4_em2  =  0;  
parameter  real  a0_a0_a3_p4_em2  =  0;  
parameter  real  b0_b0_a4_p4_em2  =  0;  
parameter  real  a0_b0_a4_p4_em2  =  0;  
parameter  real  b0_a0_a4_p4_em2  =  0;  
parameter  real  a0_a0_a4_p4_em2  =  0;  
parameter  real  b0_b0_p1_p4_em2  =  0;  
parameter  real  a0_b0_p1_p4_em2  =  0;  
parameter  real  b0_a0_p1_p4_em2  =  0;  
parameter  real  a0_a0_p1_p4_em2  =  0;  
parameter  real  b0_b0_p2_p4_em2  =  0;  
parameter  real  a0_b0_p2_p4_em2  =  0;  
parameter  real  b0_a0_p2_p4_em2  =  0;  
parameter  real  a0_a0_p2_p4_em2  =  0;  
parameter  real  b0_b0_p3_p4_em2  =  0;  
parameter  real  a0_b0_p3_p4_em2  =  0;  
parameter  real  b0_a0_p3_p4_em2  =  0;  
parameter  real  a0_a0_p3_p4_em2  =  0;  
parameter  real  b0_b0_p4_p4_em2  =  0;  
parameter  real  a0_b0_p4_p4_em2  =  0;  
parameter  real  b0_a0_p4_p4_em2  =  0;  
parameter  real  a0_a0_p4_p4_em2  =  0;  







// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real vgs, vds, vsub, id, vdsmax, vgsmax;
real delta_damage3, last_delta_damage3, damage3;
real dt, last_abstime;  
real delta_idsat;
real delta_damage2_1_1,delta_damage2_1_2,damage2_1_1,damage2_1_2;
real delta_damage2_2_1,delta_damage2_2_2,damage2_2_1,damage2_2_2;
real delta_damage2_3_1,delta_damage2_3_2,damage2_3_1,damage2_3_2,last_delta_damage2_3_1,last_delta_damage2_3_2;
real delta_damage1_1_1,delta_damage1_1_2,damage1_1_1,damage1_1_2;
real delta_damage1_2_1,delta_damage1_2_2,damage1_2_1,damage1_2_2;
real delta_damage1_3_1,delta_damage1_3_2,damage1_3_1,damage1_3_2,last_delta_damage1_3_1,last_delta_damage1_3_2;
real lamda_h,lamda_el,ron_50p,s_50p,fa,ron_fa,s_fa,fstat1,fstat2;

real b0_b0_b0_em, a0_b0_b0_em, b0_a0_b0_em, a0_a0_b0_em, b0_a1_b0_em;
real a0_a1_b0_em, b0_a2_b0_em, a0_a2_b0_em, b0_a3_b0_em, a0_a3_b0_em;
real b0_a4_b0_em, a0_a4_b0_em, b0_p1_b0_em, a0_p1_b0_em, b0_p2_b0_em;
real a0_p2_b0_em, b0_p3_b0_em, a0_p3_b0_em, b0_p4_b0_em, a0_p4_b0_em;
real b0_b0_a0_em, a0_b0_a0_em, b0_a0_a0_em, a0_a0_a0_em, b0_a1_a0_em;
real a0_a1_a0_em, b0_a2_a0_em, a0_a2_a0_em, b0_a3_a0_em, a0_a3_a0_em;
real b0_a4_a0_em, a0_a4_a0_em, b0_p1_a0_em, a0_p1_a0_em, b0_p2_a0_em;
real a0_p2_a0_em, b0_p3_a0_em, a0_p3_a0_em, b0_p4_a0_em, a0_p4_a0_em;
real b0_b0_a1_em, a0_b0_a1_em, b0_a0_a1_em, a0_a0_a1_em, b0_a1_a1_em;
real a0_a1_a1_em, b0_a2_a1_em, a0_a2_a1_em, b0_a3_a1_em, a0_a3_a1_em;
real b0_a4_a1_em, a0_a4_a1_em, b0_p1_a1_em, a0_p1_a1_em, b0_p2_a1_em;
real a0_p2_a1_em, b0_p3_a1_em, a0_p3_a1_em, b0_p4_a1_em, a0_p4_a1_em;
real b0_b0_a2_em, a0_b0_a2_em, b0_a0_a2_em, a0_a0_a2_em, b0_a1_a2_em;
real a0_a1_a2_em, b0_a2_a2_em, a0_a2_a2_em, b0_a3_a2_em, a0_a3_a2_em;
real b0_a4_a2_em, a0_a4_a2_em, b0_p1_a2_em, a0_p1_a2_em, b0_p2_a2_em;
real a0_p2_a2_em, b0_p3_a2_em, a0_p3_a2_em, b0_p4_a2_em, a0_p4_a2_em;
real b0_b0_a3_em, a0_b0_a3_em, b0_a0_a3_em, a0_a0_a3_em, b0_a1_a3_em;
real a0_a1_a3_em, b0_a2_a3_em, a0_a2_a3_em, b0_a3_a3_em, a0_a3_a3_em;
real b0_a4_a3_em, a0_a4_a3_em, b0_p1_a3_em, a0_p1_a3_em, b0_p2_a3_em;
real a0_p2_a3_em, b0_p3_a3_em, a0_p3_a3_em, b0_p4_a3_em, a0_p4_a3_em;
real b0_b0_a4_em, a0_b0_a4_em, b0_a0_a4_em, a0_a0_a4_em, b0_a1_a4_em;
real a0_a1_a4_em, b0_a2_a4_em, a0_a2_a4_em, b0_a3_a4_em, a0_a3_a4_em;
real b0_a4_a4_em, a0_a4_a4_em, b0_p1_a4_em, a0_p1_a4_em, b0_p2_a4_em;
real a0_p2_a4_em, b0_p3_a4_em, a0_p3_a4_em, b0_p4_a4_em, a0_p4_a4_em;
real b0_b0_p1_em, a0_b0_p1_em, b0_a0_p1_em, a0_a0_p1_em, b0_a1_p1_em;
real a0_a1_p1_em, b0_a2_p1_em, a0_a2_p1_em, b0_a3_p1_em, a0_a3_p1_em;
real b0_a4_p1_em, a0_a4_p1_em, b0_p1_p1_em, a0_p1_p1_em, b0_p2_p1_em;
real a0_p2_p1_em, b0_p3_p1_em, a0_p3_p1_em, b0_p4_p1_em, a0_p4_p1_em;
real b0_b0_p2_em, a0_b0_p2_em, b0_a0_p2_em, a0_a0_p2_em, b0_a1_p2_em;
real a0_a1_p2_em, b0_a2_p2_em, a0_a2_p2_em, b0_a3_p2_em, a0_a3_p2_em;
real b0_a4_p2_em, a0_a4_p2_em, b0_p1_p2_em, a0_p1_p2_em, b0_p2_p2_em;
real a0_p2_p2_em, b0_p3_p2_em, a0_p3_p2_em, b0_p4_p2_em, a0_p4_p2_em;
real b0_b0_p3_em, a0_b0_p3_em, b0_a0_p3_em, a0_a0_p3_em, b0_a1_p3_em;
real a0_a1_p3_em, b0_a2_p3_em, a0_a2_p3_em, b0_a3_p3_em, a0_a3_p3_em;
real b0_a4_p3_em, a0_a4_p3_em, b0_p1_p3_em, a0_p1_p3_em, b0_p2_p3_em;
real a0_p2_p3_em, b0_p3_p3_em, a0_p3_p3_em, b0_p4_p3_em, a0_p4_p3_em;
real b0_b0_p4_em, a0_b0_p4_em, b0_a0_p4_em, a0_a0_p4_em, b0_a1_p4_em;
real a0_a1_p4_em, b0_a2_p4_em, a0_a2_p4_em, b0_a3_p4_em, a0_a3_p4_em;
real b0_a4_p4_em, a0_a4_p4_em, b0_p1_p4_em, a0_p1_p4_em, b0_p2_p4_em;
real a0_p2_p4_em, b0_p3_p4_em, a0_p3_p4_em, b0_p4_p4_em, a0_p4_p4_em;
real b0_b0_em, a0_b0_em, a1_b0_em, a2_b0_em, a3_b0_em, a4_b0_em, p1_b0_em;
real p2_b0_em, p3_b0_em, p4_b0_em, b0_a0_em, a0_a0_em, a1_a0_em, a2_a0_em;
real a3_a0_em, a4_a0_em, p1_a0_em, p2_a0_em, p3_a0_em, p4_a0_em, b0_a1_em;
real a0_a1_em, a1_a1_em, a2_a1_em, a3_a1_em, a4_a1_em, p1_a1_em, p2_a1_em;
real p3_a1_em, p4_a1_em, b0_a2_em, a0_a2_em, a1_a2_em, a2_a2_em, a3_a2_em;
real a4_a2_em, p1_a2_em, p2_a2_em, p3_a2_em, p4_a2_em, b0_a3_em, a0_a3_em;
real a1_a3_em, a2_a3_em, a3_a3_em, a4_a3_em, p1_a3_em, p2_a3_em, p3_a3_em;
real p4_a3_em, b0_a4_em, a0_a4_em, a1_a4_em, a2_a4_em, a3_a4_em, a4_a4_em;
real p1_a4_em, p2_a4_em, p3_a4_em, p4_a4_em, b0_p1_em, a0_p1_em, a1_p1_em;
real a2_p1_em, a3_p1_em, a4_p1_em, p1_p1_em, p2_p1_em, p3_p1_em, p4_p1_em;
real b0_p2_em, a0_p2_em, a1_p2_em, a2_p2_em, a3_p2_em, a4_p2_em, p1_p2_em;
real p2_p2_em, p3_p2_em, p4_p2_em, b0_p3_em, a0_p3_em, a1_p3_em, a2_p3_em;
real a3_p3_em, a4_p3_em, p1_p3_em, p2_p3_em, p3_p3_em, p4_p3_em, b0_p4_em;
real a0_p4_em, a1_p4_em, a2_p4_em, a3_p4_em, a4_p4_em, p1_p4_em, p2_p4_em;
real p3_p4_em, p4_p4_em;
real b0_em, a0_em, a1_em, a2_em, a3_em, a4_em, p1_em, p2_em, p3_em, p4_em, em;

real b0_b0_b0_em2, a0_b0_b0_em2, b0_a0_b0_em2, a0_a0_b0_em2, b0_a1_b0_em2;
real a0_a1_b0_em2, b0_a2_b0_em2, a0_a2_b0_em2, b0_a3_b0_em2, a0_a3_b0_em2;
real b0_a4_b0_em2, a0_a4_b0_em2, b0_p1_b0_em2, a0_p1_b0_em2, b0_p2_b0_em2;
real a0_p2_b0_em2, b0_p3_b0_em2, a0_p3_b0_em2, b0_p4_b0_em2, a0_p4_b0_em2;
real b0_b0_a0_em2, a0_b0_a0_em2, b0_a0_a0_em2, a0_a0_a0_em2, b0_a1_a0_em2;
real a0_a1_a0_em2, b0_a2_a0_em2, a0_a2_a0_em2, b0_a3_a0_em2, a0_a3_a0_em2;
real b0_a4_a0_em2, a0_a4_a0_em2, b0_p1_a0_em2, a0_p1_a0_em2, b0_p2_a0_em2;
real a0_p2_a0_em2, b0_p3_a0_em2, a0_p3_a0_em2, b0_p4_a0_em2, a0_p4_a0_em2;
real b0_b0_a1_em2, a0_b0_a1_em2, b0_a0_a1_em2, a0_a0_a1_em2, b0_a1_a1_em2;
real a0_a1_a1_em2, b0_a2_a1_em2, a0_a2_a1_em2, b0_a3_a1_em2, a0_a3_a1_em2;
real b0_a4_a1_em2, a0_a4_a1_em2, b0_p1_a1_em2, a0_p1_a1_em2, b0_p2_a1_em2;
real a0_p2_a1_em2, b0_p3_a1_em2, a0_p3_a1_em2, b0_p4_a1_em2, a0_p4_a1_em2;
real b0_b0_a2_em2, a0_b0_a2_em2, b0_a0_a2_em2, a0_a0_a2_em2, b0_a1_a2_em2;
real a0_a1_a2_em2, b0_a2_a2_em2, a0_a2_a2_em2, b0_a3_a2_em2, a0_a3_a2_em2;
real b0_a4_a2_em2, a0_a4_a2_em2, b0_p1_a2_em2, a0_p1_a2_em2, b0_p2_a2_em2;
real a0_p2_a2_em2, b0_p3_a2_em2, a0_p3_a2_em2, b0_p4_a2_em2, a0_p4_a2_em2;
real b0_b0_a3_em2, a0_b0_a3_em2, b0_a0_a3_em2, a0_a0_a3_em2, b0_a1_a3_em2;
real a0_a1_a3_em2, b0_a2_a3_em2, a0_a2_a3_em2, b0_a3_a3_em2, a0_a3_a3_em2;
real b0_a4_a3_em2, a0_a4_a3_em2, b0_p1_a3_em2, a0_p1_a3_em2, b0_p2_a3_em2;
real a0_p2_a3_em2, b0_p3_a3_em2, a0_p3_a3_em2, b0_p4_a3_em2, a0_p4_a3_em2;
real b0_b0_a4_em2, a0_b0_a4_em2, b0_a0_a4_em2, a0_a0_a4_em2, b0_a1_a4_em2;
real a0_a1_a4_em2, b0_a2_a4_em2, a0_a2_a4_em2, b0_a3_a4_em2, a0_a3_a4_em2;
real b0_a4_a4_em2, a0_a4_a4_em2, b0_p1_a4_em2, a0_p1_a4_em2, b0_p2_a4_em2;
real a0_p2_a4_em2, b0_p3_a4_em2, a0_p3_a4_em2, b0_p4_a4_em2, a0_p4_a4_em2;
real b0_b0_p1_em2, a0_b0_p1_em2, b0_a0_p1_em2, a0_a0_p1_em2, b0_a1_p1_em2;
real a0_a1_p1_em2, b0_a2_p1_em2, a0_a2_p1_em2, b0_a3_p1_em2, a0_a3_p1_em2;
real b0_a4_p1_em2, a0_a4_p1_em2, b0_p1_p1_em2, a0_p1_p1_em2, b0_p2_p1_em2;
real a0_p2_p1_em2, b0_p3_p1_em2, a0_p3_p1_em2, b0_p4_p1_em2, a0_p4_p1_em2;
real b0_b0_p2_em2, a0_b0_p2_em2, b0_a0_p2_em2, a0_a0_p2_em2, b0_a1_p2_em2;
real a0_a1_p2_em2, b0_a2_p2_em2, a0_a2_p2_em2, b0_a3_p2_em2, a0_a3_p2_em2;
real b0_a4_p2_em2, a0_a4_p2_em2, b0_p1_p2_em2, a0_p1_p2_em2, b0_p2_p2_em2;
real a0_p2_p2_em2, b0_p3_p2_em2, a0_p3_p2_em2, b0_p4_p2_em2, a0_p4_p2_em2;
real b0_b0_p3_em2, a0_b0_p3_em2, b0_a0_p3_em2, a0_a0_p3_em2, b0_a1_p3_em2;
real a0_a1_p3_em2, b0_a2_p3_em2, a0_a2_p3_em2, b0_a3_p3_em2, a0_a3_p3_em2;
real b0_a4_p3_em2, a0_a4_p3_em2, b0_p1_p3_em2, a0_p1_p3_em2, b0_p2_p3_em2;
real a0_p2_p3_em2, b0_p3_p3_em2, a0_p3_p3_em2, b0_p4_p3_em2, a0_p4_p3_em2;
real b0_b0_p4_em2, a0_b0_p4_em2, b0_a0_p4_em2, a0_a0_p4_em2, b0_a1_p4_em2;
real a0_a1_p4_em2, b0_a2_p4_em2, a0_a2_p4_em2, b0_a3_p4_em2, a0_a3_p4_em2;
real b0_a4_p4_em2, a0_a4_p4_em2, b0_p1_p4_em2, a0_p1_p4_em2, b0_p2_p4_em2;
real a0_p2_p4_em2, b0_p3_p4_em2, a0_p3_p4_em2, b0_p4_p4_em2, a0_p4_p4_em2;
real b0_b0_em2, a0_b0_em2, a1_b0_em2, a2_b0_em2, a3_b0_em2, a4_b0_em2, p1_b0_em2;
real p2_b0_em2, p3_b0_em2, p4_b0_em2, b0_a0_em2, a0_a0_em2, a1_a0_em2, a2_a0_em2;
real a3_a0_em2, a4_a0_em2, p1_a0_em2, p2_a0_em2, p3_a0_em2, p4_a0_em2, b0_a1_em2;
real a0_a1_em2, a1_a1_em2, a2_a1_em2, a3_a1_em2, a4_a1_em2, p1_a1_em2, p2_a1_em2;
real p3_a1_em2, p4_a1_em2, b0_a2_em2, a0_a2_em2, a1_a2_em2, a2_a2_em2, a3_a2_em2;
real a4_a2_em2, p1_a2_em2, p2_a2_em2, p3_a2_em2, p4_a2_em2, b0_a3_em2, a0_a3_em2;
real a1_a3_em2, a2_a3_em2, a3_a3_em2, a4_a3_em2, p1_a3_em2, p2_a3_em2, p3_a3_em2;
real p4_a3_em2, b0_a4_em2, a0_a4_em2, a1_a4_em2, a2_a4_em2, a3_a4_em2, a4_a4_em2;
real p1_a4_em2, p2_a4_em2, p3_a4_em2, p4_a4_em2, b0_p1_em2, a0_p1_em2, a1_p1_em2;
real a2_p1_em2, a3_p1_em2, a4_p1_em2, p1_p1_em2, p2_p1_em2, p3_p1_em2, p4_p1_em2;
real b0_p2_em2, a0_p2_em2, a1_p2_em2, a2_p2_em2, a3_p2_em2, a4_p2_em2, p1_p2_em2;
real p2_p2_em2, p3_p2_em2, p4_p2_em2, b0_p3_em2, a0_p3_em2, a1_p3_em2, a2_p3_em2;
real a3_p3_em2, a4_p3_em2, p1_p3_em2, p2_p3_em2, p3_p3_em2, p4_p3_em2, b0_p4_em2;
real a0_p4_em2, a1_p4_em2, a2_p4_em2, a3_p4_em2, a4_p4_em2, p1_p4_em2, p2_p4_em2;
real p3_p4_em2, p4_p4_em2;
real b0_em2, a0_em2, a1_em2, a2_em2, a3_em2, a4_em2, p1_em2, p2_em2, p3_em2, p4_em2, em2;


  analog function real linear;
    input b, a, x;
    real  b, a, x;
    begin
      linear = a * x + b;
    end
  endfunction // linear

  analog function real linear_5reg;
    input b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b0, a0, a1, a2, a3, a4, p1, p2, p3, p4, x;
    real  b1, b2, b3, b4;
    begin
      b1 = (a0 - a1) * p1 + b0;
      b2 = (a1 - a2) * p2 + b1;
      b3 = (a2 - a3) * p3 + b2;
      b4 = (a3 - a4) * p4 + b3;

      if      (x < p1) linear_5reg = a0 * x + b0;
      else if (x < p2) linear_5reg = a1 * x + b1;
      else if (x < p3) linear_5reg = a2 * x + b2;
      else if (x < p4) linear_5reg = a3 * x + b3;
      else             linear_5reg = a4 * x + b4;
    end
  endfunction // linear_5reg

   
// Start simulatoin
analog begin
	if(relimo_hci_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			vgs = V(g)-V(s);
			vds = V(d)-V(s);
			vsub = V(sub)-V(s);
			
			if(relimo_vth > 0) begin
				vgs = max(vgs, vgs-vds);			
			end else begin
				vgs = -max(-vgs, -(vgs-vds));
			end
			
			if(vgs > 0 && vgs < 1e-6) begin
				vgs = 1e-6;
			end
			if(vgs < 0 && vgs > -1e-6) begin
				vgs = -1e-6;
			end
			if(vds > 0 && vds < 1e-6) begin
				vds = 1e-6;
			end
			if(vds < 0 && vds > -1e-6) begin
				vds = -1e-6;
			end
			
			id = abs($simprobe(relimo_probe_name, "ide"));

			id = id*0.5*(1.0+(-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));
			
			//$display("Parameter %M in device %e, %e", id, vgs, vgs_cutoff_HCI, m_cutoff_HCI, delta_cutoff_HCI, (-1.0*vgs+vgs_cutoff_HCI)*pow(pow(-1.0*vgs+vgs_cutoff_HCI,2.0*m_cutoff_HCI)+pow(delta_cutoff_HCI,2.0*m_cutoff_HCI),-1.0/2.0/m_cutoff_HCI));

			if (id == 0) begin
				id = id+1e-15;
			end
			
			delta_damage1_3_1 = 0;
			delta_damage1_3_2 = 0;
			delta_damage1_2_1 = 0;
			delta_damage1_2_2 = 0;
			delta_damage1_1_1 = 0;
			delta_damage1_1_2 = 0;
			delta_damage2_3_1 = 0;
			delta_damage2_3_2 = 0;
			delta_damage2_2_1 = 0;
			delta_damage2_2_2 = 0;
			delta_damage2_1_1 = 0;
			delta_damage2_1_2 = 0;
			delta_damage3 = 0;
			
			// off state HCI.
			if(vds < 0) begin	
				if(relimo_beta1*abs(vds) > 490) begin
					delta_damage1_3_1 = 0.0;
				end else begin				
					delta_damage1_3_1 = 1.0/relimo_alpha1_off*(exp(relimo_beta1*abs(vds))-1.0)*exp(-1.0*relimo_ea1/(relimo_kb*$temperature));
					$display("Parameter %M in device %e, %e", delta_damage1_3_1, 1.0/delta_damage1_3_1);
				end
				if(relimo_beta2*abs(vds) > 490) begin
					delta_damage1_3_2 = 0.0;
				end else begin				
					delta_damage1_3_2 = 1.0/relimo_alpha2_off*(exp(relimo_beta2*abs(vds))-1.0)*exp(-1.0*relimo_ea2/(relimo_kb*$temperature));
					$display("Parameter %M in device %e, %e", delta_damage1_3_2, 1.0/delta_damage1_3_2);
				end				
			end
			
			// HCIHV
			`EM($temperature, -1.0*vgs, -1.0*vds, vsub)
			
			`EM2($temperature, -1.0*vgs, -1.0*vds, vsub)
			
			//$display("Parameter %M in device %e, %e, %e, %e, ", b0_p1_a1_em, p1_a1_em, a1_em, em);
			//$display("Parameter %M in device %e, %e, %e, %e, ", b0_p1_a1_em2, p1_a1_em2, a1_em2, em2);
			
			if (em != 0) begin
				lamda_h = relimo_lamda_h0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if(relimo_Feb_h/(em*lamda_h) > 490) begin
					delta_damage2_3_1 = 0.0;
				end else begin
					delta_damage2_3_1 = 1.0/(relimo_alpha1*pow(w*1e-6/id,relimo_m1)*relimo_Feb_h/(em*lamda_h)*exp(relimo_Feb_h/(em*lamda_h)));
					$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e", id, em, w, lamda_h,relimo_alpha1,relimo_m1, relimo_Feb_h/(em*lamda_h),exp(relimo_Feb_h/(em*lamda_h)), relimo_alpha1*pow(w*1e-6/id,relimo_m1), delta_damage2_3_1, 1.0/delta_damage2_3_1);	
				end
			end
			if (em2 != 0) begin
				lamda_el = relimo_lamda_el0*tanh(relimo_Ep/(2.0*relimo_kb*$temperature));
				if (relimo_Feb_el/(em2*lamda_el) > 490) begin
					delta_damage2_3_2 = 0.0;
				end else begin
					delta_damage2_3_2 = 1.0/(relimo_alpha2*pow(w*1e-6/id,relimo_m2)*relimo_Feb_el/(em2*lamda_el)*exp(relimo_Feb_el/(em2*lamda_el)));
					$display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e, %e", id, em2, w, lamda_el, relimo_alpha2, relimo_m2, relimo_Feb_el/(em2*lamda_el),relimo_alpha2*pow(w*1e-6/id,relimo_m2), exp(relimo_Feb_el/(em2*lamda_el)),delta_damage2_3_2, 1.0/delta_damage2_3_2);
				end
			end
			 
			// High Vgs HCI.
			if(vds < 0 && vgs < 0) begin
				if((relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))) > 490) begin
					delta_damage3 = 0.0;
				end else begin	
					delta_damage3 = 1.0/(relimo_fstat3*relimo_alpha3*pow(w*1e-6/id,relimo_beta3)*pow(abs(vgs),-1.0*relimo_gama3)*pow(abs(vds),-1.0*relimo_eps3)*exp(-1.0*relimo_eta3*abs(vsub))*exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))));
				        $display("Parameter %M in device %e, %e, %e, %e, %e, %e, %e, %e, %e, %e",relimo_fstat3, relimo_alpha3, pow(w*1e-6/id,relimo_beta3), vgs, pow(abs(vgs),-1.0*relimo_gama3), pow(abs(vds),-1.0*relimo_eps3), exp(-1.0*relimo_eta3*abs(vsub)), exp(relimo_ea3/relimo_kb/($temperature+relimo_rth*id*abs(vds)/(w*1e-6))), delta_damage3, 1.0/delta_damage3);
				end
			end
			
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				
				// off stat damages
				damage1_3_1 = damage1_3_1 + dt/2.0*(delta_damage1_3_1 + last_delta_damage1_3_1);
				damage1_3_2 = damage1_3_2 + dt/2.0*(delta_damage1_3_2 + last_delta_damage1_3_2);


				// HCIHV damages

				damage2_3_1 = damage2_3_1 + dt/2.0*(delta_damage2_3_1 + last_delta_damage2_3_1);
				damage2_3_2 = damage2_3_2 + dt/2.0*(delta_damage2_3_2 + last_delta_damage2_3_2);
	
				
				// High Vgs HCI.
				damage3 = damage3 + dt/2.0*(delta_damage3 + last_delta_damage3);
				
				last_delta_damage1_3_1 = delta_damage1_3_1;
				last_delta_damage1_3_2 = delta_damage1_3_2;
				last_delta_damage2_3_1 = delta_damage2_3_1;
				last_delta_damage2_3_2 = delta_damage2_3_2;
				last_delta_damage3 = delta_damage3;
				if (abs(vgs) > vgsmax) begin
					vgsmax = abs(vgs);
				end
				if (abs(vds) > vdsmax) begin
					vdsmax = abs(vds);
				end
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
        	//$display("Parameter %M in device %e, %e, %e, %e", em, em2, w, id);
        	//$display("Parameter MULT in device %e, %e, %e, %e", $temperature, relimo_rth, id, vds);
        	//$display("Parameter MULT in device %e, %e, %e, %e", w, relimo_rth*id*vds, relimo_rth*id, relimo_eta2);
        	//$display("Parameter MULT in device %e, %e, %e, %e", exp(-1*relimo_eta2*V(sub)), delta_damage3, ($temperature+relimo_rth*id*vds/(w*1e-6)), relimo_ea2);
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e delr_u0_relimo=%e delr_rdsw_relimo=%e delr_a0_relimo=%e\n", dela_vth_relimo, delr_u0_relimo, delr_rdsw_relimo, delr_a0_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1_3_1 = damage1_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage1_3_2 = damage1_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_1 = damage2_3_1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage2_3_2 = damage2_3_2*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
					damage3 = damage3*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1_3_1 = 0;
					damage1_3_2 = 0;
					damage2_3_1 = 0;
					damage2_3_2 = 0;
					damage3 = 0;
				end
			end else begin
				damage1_3_1 = delta_damage1_3_1*relimo_aging_time*3600;
				damage1_3_2 = delta_damage1_3_2*relimo_aging_time*3600;
				damage2_3_1 = delta_damage2_3_1*relimo_aging_time*3600;
				damage2_3_2 = delta_damage2_3_2*relimo_aging_time*3600;
				damage3 = delta_damage3*relimo_aging_time*3600;
			end				

			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a_off)+pow(delta_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b_off)+pow(delta_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

      			
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-31;
			end
        		
			//$display("Parameter %M in device %e, %e, %e, %e", lamda_h, lamda_el, delta_damage2_3_1, delta_damage2_3_2);
			//$display("Parameter %M in device %e, %e, %e, %e", ron_50p, s_50p, fa, ron_fa);
			//$display("Parameter %M in device %e, %e, %e, %e, %e", s_fa, fstat1, fstat2, damage2_1_1, damage2_1_2);
			//delta_idlin = relimo_a_idlin * delta_idsat;
 			//delta_gm = relimo_a_gm * delta_idsat;
 			//delta_vth = relimo_a_vth * delta_idsat;
        		//$display("Parameter MULT in device %e, %e, %e, %e", vds, vgs, V(sub), relimo_a1*ln(1+damage2)+relimo_a2*ln(1+1/relimo_c1*damage2));
     			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_bi, "instance %M relimo_aging_time_bi %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", damage3);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", relimo_ratio_vth);
				
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1_3_1 = damage1_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage1_3_2 = damage1_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_1 = damage2_3_1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage2_3_2 = damage2_3_2*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
				damage3 = damage3*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1_3_1 = 0;
				damage1_3_2 = 0;
				damage2_3_1 = 0;
				damage2_3_2 = 0;
				damage3 = 0;
      			end


			// off stat damages 
			ron_50p = relimo_a1_off*pow(ln(1.0+damage1_3_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_3_2),relimo_n2_off);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a_off)+pow(delta_sigma_a_off,2.0*m_sigma_a_off)),1.0/(2.0*m_sigma_a_off));
			fa = 1.0/2.0*(s_50p*(fstat_tau1_off-fstat_tau2_off)+fstat_tau1_off+fstat_tau2_off);
			
			if (fa == 0) begin
				damage1_2_1 = 0;
				damage1_2_2 = 0;
			end else begin
				damage1_2_1 = damage1_3_1/fa;
				damage1_2_2 = damage1_3_2/fa;
			end
			ron_fa = relimo_a1_off*pow(ln(1.0+damage1_2_1),relimo_n1_off)-relimo_a2_off*pow(ln(1.0+damage1_2_2),relimo_n2_off);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b_off)+pow(delta_sigma_b_off,2.0*m_sigma_b_off)),1.0/(2.0*m_sigma_b_off));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2_off)+fa*(1+fstat_tau1tau2_off));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1_off-fa)+fa*(1+fstat_tau2tau1_off));
			if (fstat1 == 0) begin
				damage1_1_1 = 0;
			end else begin				
				damage1_1_1 = damage1_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage1_1_2 = 0;
			end else begin
				damage1_1_2 = damage1_3_2/fstat2;
			end
       			

			// HCIHV damages 

			ron_50p = relimo_a1*ln(1.0+damage2_3_1)+relimo_a2*ln(1.0+damage2_3_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_3_2),relimo_n_hci);
			s_50p = ron_50p/pow((pow(ron_50p,2.0*m_sigma_a)+pow(delta_sigma_a,2.0*m_sigma_a)),1.0/(2.0*m_sigma_a));
			fa = 1.0/2.0*(s_50p*(fstat_tau1-fstat_tau2)+fstat_tau1+fstat_tau2);
			
			if (fa == 0) begin
				damage2_2_1 = 0;
				damage2_2_2 = 0;
			end else begin
				damage2_2_1 = damage2_3_1/fa;
				damage2_2_2 = damage2_3_2/fa;
			end
			ron_fa = relimo_a1*ln(1.0+damage2_2_1)+relimo_a2*ln(1.0+damage2_2_1/relimo_c1)-relimo_b*pow(ln(1.0+damage2_2_2),relimo_n_hci);
			s_fa = ron_fa/pow((pow(ron_fa,2.0*m_sigma_b)+pow(delta_sigma_b,2.0*m_sigma_b)),1.0/(2.0*m_sigma_b));
			
			fstat1 = 1.0/2.0*(s_fa*(fa-fa*fstat_tau1tau2)+fa*(1+fstat_tau1tau2));
			fstat2 = 1.0/2.0*(s_fa*(fa*fstat_tau2tau1-fa)+fa*(1+fstat_tau2tau1));
			if (fstat1 == 0) begin
				damage2_1_1 = 0;
			end else begin				
				damage2_1_1 = damage2_3_1/fstat1;
			end
			if (fstat2 == 0) begin
				damage2_1_2 = 0;
			end else begin
				damage2_1_2 = damage2_3_2/fstat2;
			end

			//delta_idsat = relimo_a_idsat * pow(damage, relimo_n);
			delta_idsat = 0;
			if (damage3 == 0) begin
				damage3 = 1e-31;
			end
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);
			$fwrite (results_aging_op, "instance %M relimo_aging_time_op %e vds_max %e vgs_max %e\n", relimo_aging_time, vdsmax, vgsmax);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e relimo_ratio2_a %e relimo_ratio3_a %e\n", relimo_ratio1_a, relimo_ratio2_a, relimo_ratio3_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_a %e relimo_ratio5_a %e relimo_ratio6_a %e\n", relimo_ratio4_a, relimo_ratio5_a, relimo_ratio6_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_a %e relimo_ratio8_a %e relimo_ratio9_a %e relimo_ratio10_a %e\n", relimo_ratio7_a, relimo_ratio8_a, relimo_ratio9_a, relimo_ratio10_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_a %e relimo_ratio12_a %e relimo_ratio13_a %e\n", relimo_ratio11_a, relimo_ratio12_a, relimo_ratio13_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_a %e relimo_ratio15_a %e relimo_ratio16_a %e\n", relimo_ratio14_a, relimo_ratio15_a, relimo_ratio16_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e relimo_ratio2_b %e relimo_ratio3_b %e\n", relimo_ratio1_b, relimo_ratio2_b, relimo_ratio3_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio4_b %e relimo_ratio5_b %e relimo_ratio6_b %e\n", relimo_ratio4_b, relimo_ratio5_b, relimo_ratio6_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio7_b %e relimo_ratio8_b %e relimo_ratio9_b %e relimo_ratio10_b %e\n", relimo_ratio7_b, relimo_ratio8_b, relimo_ratio9_b, relimo_ratio10_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio11_b %e relimo_ratio12_b %e relimo_ratio13_b %e\n", relimo_ratio11_b, relimo_ratio12_b, relimo_ratio13_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio14_b %e relimo_ratio15_b %e relimo_ratio16_b %e\n", relimo_ratio14_b, relimo_ratio15_b, relimo_ratio16_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", relimo_ratio_vth2a0, 0.0, -0.130*0, 0.0);
			
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", relimo_function, delta_idsat, relimo_function, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_%d %e\n", relimo_function, relimo_a_idlin);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_%d %e\n", relimo_function, relimo_a_gm);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_%d %e\n", relimo_function, relimo_a_vth);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_2 %e relimo_n_hci_2 %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_idlin_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_gm_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_vth_hci_2 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", relimo_ratio20_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", relimo_ratio20_b);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", relimo_ratio21_a);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", relimo_ratio21_b);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 1.0*relimo_hci_aging_open_flag);			
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0);			
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", damage3);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", relimo_a_hci3);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", relimo_n_hci3);
			
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", damage1_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", damage1_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", relimo_a1_off);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", relimo_a2_off);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", relimo_n1_off);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", relimo_n2_off);
			
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0/relimo_c1*damage2_1_1);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", damage2_1_2);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", relimo_a1);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", relimo_a2);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", relimo_b);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", relimo_n_hci);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", relimo_ratio_vth);
		end	
	end
end
endmodule


module relimo_aging_pnp(b,e);
input b,e;
electrical b,e;

// relimo_aged parameters in model file
parameter real        dela_vth_relimo              = 0;			

// User-defined Simulation relimo_control Inputs
parameter real        relimo_pnp_aging_open_flag   = 0;
parameter real        relimo_bi_aging_flag         = 0;
parameter real        relimo_op_aging_flag         = 0;
   							
// User-defined relimo_aging Inputs 
parameter real        relimo_aging_tstart          = 0;
parameter real        relimo_aging_time            = 10;		
   
// relimo_nechnology-specified parameters
parameter string      relimo_device_name           = "pnp";
parameter real        w               		   = 0;			
parameter real        l               		   = 0;			
parameter real        dl               		   = 0;			
parameter real        relimo_n                     = 0.2;
parameter real        relimo_c                     = 0;			
parameter real        relimo_kb                    = 8.617e-5;
parameter real        relimo_Ea                    = 0;
parameter real        relimo_gamma                 = 0.0000166;
parameter real        relimo_a                     = 4.01e-38;
parameter real        relimo_b                     = 33.2;
parameter real        relimo_fstat                 = 0.00966;
		
			
   
// General parameters
integer results_aging_bi, results_aging_op, results_aged;				
real veb, delta_damage1, last_delta_damage1, damage1, dt, last_abstime;  
   
// Start simulatoin
analog begin
	if(relimo_pnp_aging_open_flag == 1) begin
		if((relimo_bi_aging_flag == 1) || (relimo_op_aging_flag == 1)) begin
			veb = V(e)-V(b);
			
			if(veb >= 0) begin
				delta_damage1 = 0;
			end else begin
				delta_damage1 = relimo_a/relimo_fstat*exp(-1*relimo_b/abs(veb))*pow((1-relimo_c)+relimo_c*exp(-1*relimo_Ea/(relimo_kb*$temperature)),1.0/relimo_n);
				//$display("Parameter MULT in device %e, %e, %e, %e,  %e, %e, %e, %e", exp(relimo_intercept-relimo_c*vddtransistor), relimo_a_idsat*relimo_m, exp(-1*relimo_e/(relimo_kb*$temperature)), delta_damage1,relimo_c,relimo_intercept-relimo_c*vddtransistor,relimo_intercept,vddtransistor);
			end
			if($abstime>=relimo_aging_tstart) begin
				dt = ($abstime - last_abstime);	
				last_abstime = $abstime;			
				damage1 = damage1 + dt/2*(delta_damage1 + last_delta_damage1);
				last_delta_damage1 = delta_damage1;
			end else begin
				last_abstime = $abstime;
			end
		end
	end
	@(final_step) begin
	
		results_aged = $fopen ("./aged.output");
  		$fwrite (results_aged, "instance=%M dela_vth_relimo=%e\n", dela_vth_relimo);
  		$fclose (results_aged);
		if (relimo_bi_aging_flag==1) begin
      			if (analysis("tran")&&($abstime > 0)) begin
      				if ($abstime > relimo_aging_tstart) begin
					damage1 = damage1*relimo_aging_time*3600/($abstime-relimo_aging_tstart);
				end else begin
					damage1 = 0;
				end
			end else begin
				damage1 = delta_damage1*relimo_aging_time*3600;
      			end

			results_aging_bi = $fopen ("bi_aging.dat");
			$fwrite (results_aging_bi, "instance %M device_name %s\n", relimo_device_name);			
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", 0.0, 0.0, 0.0, 0.0);
			$fwrite (results_aging_bi, "instance %M delta_idsat_bi_hci_%d %e relimo_n_hci_%d %e\n", 1, damage1, 1, relimo_n);
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_a %e\n", 0.0);
			// use relimo_ratio1_b as P_eff*Gamma
			$fwrite (results_aging_bi, "instance %M relimo_ratio1_b %e\n", -100*2.0*(w+dl+l+dl)*relimo_gamma*1e-6);			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_nbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_nbti %e\n", 1.0);
			
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_pbti %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_pbti %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_pbti %e delta_vth_bi_pbti_spl %e\n", 0.0, 1.0);
			$fwrite (results_aging_bi, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_a_hci3 %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_vth_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_a %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio20_b %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_d_hci1 %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hci %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hci %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hci %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron1_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron2_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n2_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron3_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron4_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M delta_ron5_bi_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_a %e\n", 1.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio21_b %e\n", 0.0);
			$fwrite (results_aging_bi, "instance %M relimo_ratio_vth %e\n", 1.0);
		end
		if ((relimo_op_aging_flag==1)&&(analysis("tran"))&&($abstime > 0)) begin
      			if ($abstime > relimo_aging_tstart) begin
				//damage = (damage_s+damage_d)*(relimo_aging_time)/($abstime-relimo_aging_tstart)*exp(-1*relimo_e/(relimo_kb*$temperature));
				damage1 = damage1*(relimo_aging_time)*(24*365.24*3600)/($abstime-relimo_aging_tstart);
			end else begin
				damage1 = 0;
      			end
		
     			results_aging_op = $fopen ("op_aging.dat");
			$fwrite (results_aging_op, "instance %M device_name %s\n", relimo_device_name);			
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth2a0 %e relimo_ratio_rdsw2vth_a %e relimo_ratio_rdsw2vth_b %e relimo_ratio_rdsw2vth_c %e\n", 0.0, 0.0, 0.0, 0.0);
			$fwrite (results_aging_op, "instance %M delta_idsat_op_hci_%d %e relimo_n_hci_%d %e\n", 1, damage1, 1, relimo_n);
			$fwrite (results_aging_op, "instance %M relimo_ratio1_a %e\n", 0.0);
			// use relimo_ratio1_b as P_eff*Gamma
			$fwrite (results_aging_op, "instance %M relimo_ratio1_b %e\n", -100*2.0*(w+dl+l+dl)*relimo_gamma*1e-6);		
			$fwrite (results_aging_op, "instance %M delta_vth_op_nbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_nbti %e\n", 1.0);
			
			$fwrite (results_aging_op, "instance %M delta_vth_op_pbti %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_n_pbti %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a_pbti %e delta_vth_op_pbti_spl %e\n", 0.0, 1.0);
			$fwrite (results_aging_op, "instance %M delta_ron_flag %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_a_hci3 %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_vth_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hci3 %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_a %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio20_b %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_d_hci1 %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hci %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hci %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hci %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a1_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron1_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n1_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a2_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron2_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n2_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a3_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron3_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_a4_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron4_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_b_hciphv %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M delta_ron5_op_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_n_hciphv %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_a %e\n", 1.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio21_b %e\n", 0.0);
			$fwrite (results_aging_op, "instance %M relimo_ratio_vth %e\n", 1.0);
		end	
	end
end
endmodule
