# Monitor-Aware SOA Specification
# Direct mapping to Verilog-A monitors
# Can be generated from universal spec or written manually
version: "1.0"
process: "SMOS10HV"
date: "2024-12-16"

# ============================================================================
# Global Configuration
# ============================================================================
global:
  timing:
    tmin: 0
    tdelay: 0
    vballmsg: 1.0
    stop: 0
  tmaxfrac:
    level0: 0
    level1: 0.01
    level2: 0.10
    level3: -1

# ============================================================================
# Parameters (Spectre parameters)
# ============================================================================
parameters:
  global_tmin: 0
  global_tdelay: 0
  global_vballmsg: 1.0
  global_stop: 0
  tmaxfrac0: 0
  tmaxfrac1: 0.01
  tmaxfrac2: 0.10
  tmaxfrac3: -1
  dtmax_rm: 5
  theat: 1e-7
  atype: 1

# ============================================================================
# Monitor Definitions
# Note: section names are generated by the generator, not specified here
# ============================================================================
monitors:
  # ==========================================================================
  # Example 1: Simple Voltage Check (ovcheck)
  # ==========================================================================
  - name: "Cap Low Oxide Risk"
    monitor_type: ovcheck
    model_name: ovcheck_cap_low_oxrisk
    applies_to:
      subcircuits: [cap_low_model]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      tmaxfrac: tmaxfrac3
      vlow: -1.32
      vhigh: 1.32
      branch1: "V(t,nw)"
      message1: "Vtnw_OXrisk"

  # ==========================================================================
  # Example 2: Multi-Branch Voltage Check (ovcheck6)
  # ==========================================================================
  - name: "NMOS Core Oxide Risk"
    monitor_type: ovcheck6
    model_name: ovcheck_mos_core_oxrisk
    applies_to:
      subcircuits: [nch_mac, nch_lvt_mac, nch_hvt_mac]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      tmaxfrac: tmaxfrac3
      vlow1: -1.32
      vhigh1: 1.32
      branch1: "V(g,b)"
      message1: "Vgb_OXrisk"
      vlow2: -1.32
      vhigh2: 1.32
      branch2: "V(g,s)"
      message2: "Vgs_OXrisk"
      vlow3: -1.32
      vhigh3: 1.32
      branch3: "V(g,d)"
      message3: "Vgd_OXrisk"

  # ==========================================================================
  # Example 3: State-Dependent Check (ovcheckva_mos2)
  # ==========================================================================
  - name: "NMOS Core State Dependent"
    monitor_type: ovcheckva_mos2
    model_name: ovcheck_nmos_core_state
    applies_to:
      subcircuits: [nch_mac, nch_lvt_mac, nch_hvt_mac]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      tmaxfrac: tmaxfrac0
      vhigh_on: 1.84
      vhigh_off: 3.0
      vhigh_gc: 2.07
      vlow_gc: -2.07
      param: "vth"
      vgt: 0.0

  # ==========================================================================
  # Example 4: Self-Heating Check (ovcheck with thermal parameters)
  # ==========================================================================
  - name: "Metal-1 Resistor Self-Heating"
    monitor_type: ovcheck
    model_name: ish_rm1
    applies_to:
      subcircuits: [res_metal1]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      dtmax: dtmax_rm
      theat: theat
      monitor: temperature
      idc_high: "$w * 4.05e-3"
      ipeak_high: "$w * 4.05e-1"
      irms_high: "1.0e-3 * sqrt(367.8 * $w * ($w + 0.53))"

  # ==========================================================================
  # Example 5: HCI/TDDB Aging Check (ovcheckva_ldmos_hci_tddb)
  # ==========================================================================
  - name: "PMOS 90V HCI/TDDB"
    monitor_type: ovcheckva_ldmos_hci_tddb
    model_name: hcitddb_pmos90_10hv
    applies_to:
      subcircuits: [pch_90v_mac]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      atype: atype
      soa_hcitddb_a: 24
      soa_hcitddb_b: 0.38
      soa_hcitddb_c: 0.0
      soa_hcitddb_d: 0.0
      soa_hcitddb_e: 0.0
      soa_hcitddb_f: 0.0
      soa_hcitddb_g: 0.0
      soa_hcitddb_h: 0.0
      soa_hcitddb_i: 0.0
      soa_hcitddb_j: 0.0
      soa_hcitddb_k: 0.0
      soa_hcitddb_l: 0.0
      soa_hcitddb_m: 0.0
      soa_hcitddb_n: 0.0

  # ==========================================================================
  # Example 6: Parameter Check (parcheckva3)
  # ==========================================================================
  - name: "NMOS Core VTH Check"
    monitor_type: parcheckva3
    model_name: parcheck_nmos_core_vth
    applies_to:
      subcircuits: [nch_mac, nch_lvt_mac, nch_hvt_mac]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      tmaxfrac: tmaxfrac0
      param: "vth"
      vgt: 0.0
      vlow: 0.3
      vhigh: 0.7

  # ==========================================================================
  # Example 7: Temperature-Dependent Check (ovcheckva_pwl)
  # ==========================================================================
  - name: "Diode Temperature Dependent"
    monitor_type: ovcheckva_pwl
    model_name: ovcheck_dz5_temp
    applies_to:
      subcircuits: [dz5, diode_zener_5v]
    parameters:
      tmin: global_tmin
      tdelay: global_tdelay
      vballmsg: global_vballmsg
      stop: global_stop
      tmaxfrac: tmaxfrac0
      vlow: "-0.9943 - 0.0006 * (T - 25)"
      vhigh: "0.9943 - 0.0006 * (T - 25)"
      branch1: "V(p,n)"
      message1: "Vpn_temp"
